[0m03:51:39.881693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0963FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B01D1B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B1117050>]}


============================== 03:51:39.881693 | f5066e6a-1481-45f5-8949-bc37a78b497d ==============================
[0m03:51:39.881693 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:51:39.881693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m03:51:39.942998 [info ] [MainThread]: dbt version: 1.8.6
[0m03:51:39.942998 [info ] [MainThread]: python version: 3.12.10
[0m03:51:39.952755 [info ] [MainThread]: python path: C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Scripts\python.exe
[0m03:51:39.952755 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m03:51:40.101501 [info ] [MainThread]: Using profiles dir at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project
[0m03:51:40.101501 [info ] [MainThread]: Using profiles.yml file at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\profiles.yml
[0m03:51:40.119501 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\dbt_project.yml
[0m03:51:40.119501 [info ] [MainThread]: adapter type: duckdb
[0m03:51:40.119501 [info ] [MainThread]: adapter version: 1.8.2
[0m03:51:40.240968 [info ] [MainThread]: Configuration:
[0m03:51:40.242985 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:51:40.252684 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:51:40.252684 [info ] [MainThread]: Required dependencies:
[0m03:51:40.252684 [debug] [MainThread]: Executing "git --help"
[0m03:51:40.328971 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:51:40.328971 [debug] [MainThread]: STDERR: "b''"
[0m03:51:40.328971 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:51:40.328971 [info ] [MainThread]: Connection:
[0m03:51:40.338839 [info ] [MainThread]:   database: warehouse
[0m03:51:40.338839 [info ] [MainThread]:   schema: main
[0m03:51:40.338839 [info ] [MainThread]:   path: ./infra/warehouse.duckdb
[0m03:51:40.338839 [info ] [MainThread]:   config_options: None
[0m03:51:40.338839 [info ] [MainThread]:   extensions: None
[0m03:51:40.348174 [info ] [MainThread]:   settings: {}
[0m03:51:40.348174 [info ] [MainThread]:   external_root: .
[0m03:51:40.348174 [info ] [MainThread]:   use_credential_provider: None
[0m03:51:40.348174 [info ] [MainThread]:   attach: None
[0m03:51:40.348174 [info ] [MainThread]:   filesystems: None
[0m03:51:40.348174 [info ] [MainThread]:   remote: None
[0m03:51:40.348174 [info ] [MainThread]:   plugins: None
[0m03:51:40.354490 [info ] [MainThread]:   disable_transactions: False
[0m03:51:40.354490 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m03:51:40.767185 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:51:47.184753 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:51:47.184753 [debug] [MainThread]: On debug: select 1 as id
[0m03:51:47.184753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:51:47.222241 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m03:51:47.227544 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m03:51:47.227544 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m03:51:47.227544 [info ] [MainThread]: [31m1 check failed:[0m
[0m03:51:47.238166 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Cannot open file "c:\users\khema\downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\.\infra\warehouse.duckdb": The system cannot find the path specified.
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m03:51:47.240918 [debug] [MainThread]: Command `dbt debug` failed at 03:51:47.240918 after 7.54 seconds
[0m03:51:47.240918 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:51:47.240918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0E0C830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0EDCDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B257C2F0>]}
[0m03:51:47.240918 [debug] [MainThread]: Flushing usage events
[0m03:51:54.240658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292BCB035C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292BF037EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292BF6A6B70>]}


============================== 03:51:54.247127 | 8344d76a-af37-4fc1-b72b-d5edb22c9700 ==============================
[0m03:51:54.247127 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:51:54.247127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:51:54.535735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8344d76a-af37-4fc1-b72b-d5edb22c9700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292BFBAE810>]}
[0m03:51:54.596898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8344d76a-af37-4fc1-b72b-d5edb22c9700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292BFBF88F0>]}
[0m03:51:54.596898 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m03:51:54.975886 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m03:51:54.975886 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:51:54.983892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8344d76a-af37-4fc1-b72b-d5edb22c9700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292C0CD3E00>]}
[0m03:51:58.244203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8344d76a-af37-4fc1-b72b-d5edb22c9700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292C1186900>]}
[0m03:51:58.426481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8344d76a-af37-4fc1-b72b-d5edb22c9700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292C1115820>]}
[0m03:51:58.428509 [info ] [MainThread]: Found 7 models, 421 macros
[0m03:51:58.435613 [info ] [MainThread]: 
[0m03:51:58.438031 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:51:58.446315 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m03:51:58.640718 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m03:51:58.656691 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m03:51:58.656691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:51:58.672378 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m03:51:58.672378 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m03:51:58.672378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:51:58.672378 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m03:51:58.672378 [info ] [MainThread]: 
[0m03:51:58.672378 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m03:51:58.681838 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\users\khema\downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\.\infra\warehouse.duckdb": The system cannot find the path specified.
  
[0m03:51:58.684685 [debug] [MainThread]: Command `dbt build` failed at 03:51:58.684685 after 4.64 seconds
[0m03:51:58.684685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292BF5F43E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292C114D400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292C0F641D0>]}
[0m03:51:58.686541 [debug] [MainThread]: Flushing usage events
[0m03:55:48.934922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE0BDC7DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE0BDC69C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE0BDC6870>]}


============================== 03:55:48.944932 | b7c28386-4969-4beb-99cf-d775e05392ae ==============================
[0m03:55:48.944932 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:55:48.944932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:55:48.987991 [info ] [MainThread]: dbt version: 1.8.6
[0m03:55:48.987991 [info ] [MainThread]: python version: 3.12.10
[0m03:55:48.995563 [info ] [MainThread]: python path: C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Scripts\python.exe
[0m03:55:48.995563 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m03:55:49.135003 [info ] [MainThread]: Using profiles dir at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project
[0m03:55:49.135003 [info ] [MainThread]: Using profiles.yml file at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\profiles.yml
[0m03:55:49.156129 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\dbt_project.yml
[0m03:55:49.156129 [info ] [MainThread]: adapter type: duckdb
[0m03:55:49.156129 [info ] [MainThread]: adapter version: 1.8.2
[0m03:55:49.280692 [info ] [MainThread]: Configuration:
[0m03:55:49.280692 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:55:49.290993 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:55:49.290993 [info ] [MainThread]: Required dependencies:
[0m03:55:49.290993 [debug] [MainThread]: Executing "git --help"
[0m03:55:49.352119 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:55:49.352119 [debug] [MainThread]: STDERR: "b''"
[0m03:55:49.352119 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:55:49.352119 [info ] [MainThread]: Connection:
[0m03:55:49.368210 [info ] [MainThread]:   database: warehouse
[0m03:55:49.368210 [info ] [MainThread]:   schema: main
[0m03:55:49.368210 [info ] [MainThread]:   path: ./infra/warehouse.duckdb
[0m03:55:49.368210 [info ] [MainThread]:   config_options: None
[0m03:55:49.368210 [info ] [MainThread]:   extensions: None
[0m03:55:49.368210 [info ] [MainThread]:   settings: {}
[0m03:55:49.368210 [info ] [MainThread]:   external_root: .
[0m03:55:49.368210 [info ] [MainThread]:   use_credential_provider: None
[0m03:55:49.368210 [info ] [MainThread]:   attach: None
[0m03:55:49.368210 [info ] [MainThread]:   filesystems: None
[0m03:55:49.380735 [info ] [MainThread]:   remote: None
[0m03:55:49.380735 [info ] [MainThread]:   plugins: None
[0m03:55:49.380735 [info ] [MainThread]:   disable_transactions: False
[0m03:55:49.386601 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m03:55:49.718527 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:55:49.815226 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:55:49.815226 [debug] [MainThread]: On debug: select 1 as id
[0m03:55:49.815226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:55:49.834377 [debug] [MainThread]: SQL status: OK in 0.026 seconds
[0m03:55:49.834377 [debug] [MainThread]: On debug: Close
[0m03:55:49.845395 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:55:49.847407 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:55:49.848177 [debug] [MainThread]: Command `dbt debug` succeeded at 03:55:49.848177 after 1.10 seconds
[0m03:55:49.848177 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:55:49.850188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE094E1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE091B20F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE0DE57590>]}
[0m03:55:49.850188 [debug] [MainThread]: Flushing usage events
[0m03:55:56.878395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BACA4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BF88ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BF29A930>]}


============================== 03:55:56.887544 | b8109ec5-485d-4348-98ff-b6451127e74b ==============================
[0m03:55:56.887544 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:55:56.887544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m03:55:57.165807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8109ec5-485d-4348-98ff-b6451127e74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BFC53950>]}
[0m03:55:57.237809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8109ec5-485d-4348-98ff-b6451127e74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BD300D10>]}
[0m03:55:57.239546 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m03:55:57.568365 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m03:55:57.736564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:55:57.736564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:55:57.766210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8109ec5-485d-4348-98ff-b6451127e74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C0F301D0>]}
[0m03:55:57.893702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8109ec5-485d-4348-98ff-b6451127e74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1222210>]}
[0m03:55:57.893702 [info ] [MainThread]: Found 7 models, 421 macros
[0m03:55:57.904746 [info ] [MainThread]: 
[0m03:55:57.906768 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:55:57.919785 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m03:55:58.024643 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m03:55:58.024643 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m03:55:58.024643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:58.046406 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m03:55:58.055810 [debug] [ThreadPool]: On list_warehouse: Close
[0m03:55:58.055810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m03:55:58.055810 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m03:55:58.068490 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:55:58.068490 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m03:55:58.070501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:55:58.080316 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m03:55:58.080316 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:55:58.080316 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m03:55:58.080316 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:55:58.080316 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:55:58.080316 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m03:55:58.080316 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:55:58.080316 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m03:55:58.080316 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:55:58.080316 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m03:55:58.080316 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:55:58.080316 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m03:55:58.080316 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m03:55:58.093978 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m03:55:58.093978 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m03:55:58.093978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:58.093978 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m03:55:58.093978 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m03:55:58.093978 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m03:55:58.141810 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m03:55:58.141810 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m03:55:58.141810 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m03:55:58.141810 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m03:55:58.141810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8109ec5-485d-4348-98ff-b6451127e74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BD36CE30>]}
[0m03:55:58.141810 [debug] [MainThread]: Using duckdb connection "master"
[0m03:55:58.141810 [debug] [MainThread]: On master: BEGIN
[0m03:55:58.141810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:55:58.160957 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m03:55:58.164085 [debug] [MainThread]: On master: COMMIT
[0m03:55:58.164085 [debug] [MainThread]: Using duckdb connection "master"
[0m03:55:58.164085 [debug] [MainThread]: On master: COMMIT
[0m03:55:58.166088 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:55:58.166088 [debug] [MainThread]: On master: Close
[0m03:55:58.166088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:55:58.166088 [info ] [MainThread]: 
[0m03:55:58.217195 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m03:55:58.217195 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m03:55:58.221275 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m03:55:58.221275 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m03:55:58.223300 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m03:55:58.223300 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m03:55:58.234675 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m03:55:58.221275 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m03:55:58.223300 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m03:55:58.236969 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m03:55:58.238981 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m03:55:58.240995 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m03:55:58.241882 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m03:55:58.268510 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m03:55:58.270523 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m03:55:58.284429 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m03:55:58.284429 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m03:55:58.288659 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m03:55:58.290390 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m03:55:58.294226 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m03:55:58.294226 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m03:55:58.301136 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m03:55:58.301136 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m03:55:58.294226 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m03:55:58.301136 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:55:58.301136 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m03:55:58.301136 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m03:55:58.301136 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:55:58.301136 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m03:55:58.306329 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:55:58.310375 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m03:55:58.310375 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m03:55:58.316227 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m03:55:58.316227 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m03:55:58.316227 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m03:55:58.316227 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m03:55:58.316227 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m03:55:58.316227 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m03:55:58.316227 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m03:55:58.333286 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m03:55:58.333286 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m03:55:58.333286 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m03:55:58.333286 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:55:58.333286 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m03:55:58.333286 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m03:55:58.333286 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: ROLLBACK
[0m03:55:58.333286 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: ROLLBACK
[0m03:55:58.333286 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: ROLLBACK
[0m03:55:58.348029 [debug] [Thread-2 (]: Failed to rollback 'model.meta_product_analytics.stg_events'
[0m03:55:58.348029 [debug] [Thread-3 (]: Failed to rollback 'model.meta_product_analytics.stg_users'
[0m03:55:58.361229 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m03:55:58.361229 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.stg_content'
[0m03:55:58.364135 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m03:55:58.364135 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m03:55:58.370651 [debug] [Thread-2 (]: Runtime Error in model stg_events (models\staging\stg_events.sql)
  IO Error: No files found that match the pattern "data/raw/events_app.csv"
[0m03:55:58.370651 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8109ec5-485d-4348-98ff-b6451127e74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BF1598B0>]}
[0m03:55:58.370651 [debug] [Thread-3 (]: Runtime Error in model stg_users (models\staging\stg_users.sql)
  IO Error: No files found that match the pattern "data/raw/users.csv"
[0m03:55:58.370651 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.14s]
[0m03:55:58.381074 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8109ec5-485d-4348-98ff-b6451127e74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C179FB30>]}
[0m03:55:58.381074 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m03:55:58.385116 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.14s]
[0m03:55:58.383096 [debug] [Thread-1 (]: Runtime Error in model stg_content (models\staging\stg_content.sql)
  IO Error: No files found that match the pattern "data/raw/content.csv"
[0m03:55:58.387697 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m03:55:58.387697 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.fct_product_events
[0m03:55:58.387697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8109ec5-485d-4348-98ff-b6451127e74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C155F260>]}
[0m03:55:58.387697 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.dim_users
[0m03:55:58.387697 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.fct_product_events ................................... [[33mSKIP[0m]
[0m03:55:58.398131 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m03:55:58.394297 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_content .......................... [[31mERROR[0m in 0.16s]
[0m03:55:58.402185 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m03:55:58.396108 [info ] [Thread-2 (]: 5 of 7 SKIP relation main.dim_users ............................................ [[33mSKIP[0m]
[0m03:55:58.402185 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.dim_users
[0m03:55:58.402185 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.dim_content
[0m03:55:58.402185 [info ] [Thread-2 (]: 6 of 7 SKIP relation main.dim_content .......................................... [[33mSKIP[0m]
[0m03:55:58.402185 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.dim_content
[0m03:55:58.411793 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m03:55:58.411793 [info ] [Thread-4 (]: 7 of 7 SKIP relation main.agg_product_kpis ..................................... [[33mSKIP[0m]
[0m03:55:58.411793 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m03:55:58.417692 [debug] [MainThread]: Using duckdb connection "master"
[0m03:55:58.419718 [debug] [MainThread]: On master: BEGIN
[0m03:55:58.419718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:55:58.432419 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m03:55:58.432419 [debug] [MainThread]: On master: COMMIT
[0m03:55:58.432419 [debug] [MainThread]: Using duckdb connection "master"
[0m03:55:58.434429 [debug] [MainThread]: On master: COMMIT
[0m03:55:58.434429 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:55:58.436448 [debug] [MainThread]: On master: Close
[0m03:55:58.436448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:55:58.441009 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m03:55:58.441009 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m03:55:58.441009 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_content' was properly closed.
[0m03:55:58.441009 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_events' was properly closed.
[0m03:55:58.441009 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_users' was properly closed.
[0m03:55:58.443025 [info ] [MainThread]: 
[0m03:55:58.443025 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m03:55:58.447808 [debug] [MainThread]: Command end result
[0m03:55:58.492581 [info ] [MainThread]: 
[0m03:55:58.494605 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:55:58.501301 [info ] [MainThread]: 
[0m03:55:58.501301 [error] [MainThread]:   Runtime Error in model stg_events (models\staging\stg_events.sql)
  IO Error: No files found that match the pattern "data/raw/events_app.csv"
[0m03:55:58.501301 [info ] [MainThread]: 
[0m03:55:58.506621 [error] [MainThread]:   Runtime Error in model stg_users (models\staging\stg_users.sql)
  IO Error: No files found that match the pattern "data/raw/users.csv"
[0m03:55:58.506621 [info ] [MainThread]: 
[0m03:55:58.506621 [error] [MainThread]:   Runtime Error in model stg_content (models\staging\stg_content.sql)
  IO Error: No files found that match the pattern "data/raw/content.csv"
[0m03:55:58.506621 [info ] [MainThread]: 
[0m03:55:58.506621 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m03:55:58.506621 [debug] [MainThread]: Command `dbt build` failed at 03:55:58.506621 after 1.80 seconds
[0m03:55:58.506621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BF7C4A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BF18B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BF5FCE00>]}
[0m03:55:58.506621 [debug] [MainThread]: Flushing usage events
[0m03:56:15.335742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BCA19FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BC934E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BC947C0E0>]}


============================== 03:56:15.352771 | 5c12ed6c-c576-4fb7-92c1-ba8fe77c2d34 ==============================
[0m03:56:15.352771 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:56:15.358831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:56:15.398415 [info ] [MainThread]: dbt version: 1.8.6
[0m03:56:15.398415 [info ] [MainThread]: python version: 3.12.10
[0m03:56:15.398415 [info ] [MainThread]: python path: C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Scripts\python.exe
[0m03:56:15.398415 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m03:56:15.544776 [info ] [MainThread]: Using profiles dir at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project
[0m03:56:15.546352 [info ] [MainThread]: Using profiles.yml file at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\profiles.yml
[0m03:56:15.553984 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\dbt_project.yml
[0m03:56:15.553984 [info ] [MainThread]: adapter type: duckdb
[0m03:56:15.556796 [info ] [MainThread]: adapter version: 1.8.2
[0m03:56:15.671544 [info ] [MainThread]: Configuration:
[0m03:56:15.671544 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:56:15.671544 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:56:15.671544 [info ] [MainThread]: Required dependencies:
[0m03:56:15.680379 [debug] [MainThread]: Executing "git --help"
[0m03:56:15.729762 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:56:15.729762 [debug] [MainThread]: STDERR: "b''"
[0m03:56:15.729762 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:56:15.729762 [info ] [MainThread]: Connection:
[0m03:56:15.745880 [info ] [MainThread]:   database: warehouse
[0m03:56:15.745880 [info ] [MainThread]:   schema: main
[0m03:56:15.745880 [info ] [MainThread]:   path: ./infra/warehouse.duckdb
[0m03:56:15.745880 [info ] [MainThread]:   config_options: None
[0m03:56:15.745880 [info ] [MainThread]:   extensions: None
[0m03:56:15.745880 [info ] [MainThread]:   settings: {}
[0m03:56:15.745880 [info ] [MainThread]:   external_root: .
[0m03:56:15.745880 [info ] [MainThread]:   use_credential_provider: None
[0m03:56:15.745880 [info ] [MainThread]:   attach: None
[0m03:56:15.745880 [info ] [MainThread]:   filesystems: None
[0m03:56:15.745880 [info ] [MainThread]:   remote: None
[0m03:56:15.745880 [info ] [MainThread]:   plugins: None
[0m03:56:15.745880 [info ] [MainThread]:   disable_transactions: False
[0m03:56:15.765794 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m03:56:16.180164 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:56:16.273151 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:56:16.274237 [debug] [MainThread]: On debug: select 1 as id
[0m03:56:16.274752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:56:16.286464 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m03:56:16.288474 [debug] [MainThread]: On debug: Close
[0m03:56:16.290670 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:56:16.292685 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:56:16.300857 [debug] [MainThread]: Command `dbt debug` succeeded at 03:56:16.300857 after 1.14 seconds
[0m03:56:16.300857 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:56:16.302870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BCA19FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BCA3C2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BCA3C2FF0>]}
[0m03:56:16.302870 [debug] [MainThread]: Flushing usage events
[0m03:56:23.385930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4B177740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4D527410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4D10A990>]}


============================== 03:56:23.401711 | 4811157f-6851-4934-972c-bf1828daa954 ==============================
[0m03:56:23.401711 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:56:23.401711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:56:23.766862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4811157f-6851-4934-972c-bf1828daa954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4E0DA090>]}
[0m03:56:23.831239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4811157f-6851-4934-972c-bf1828daa954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4E058080>]}
[0m03:56:23.842883 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m03:56:24.246478 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m03:56:24.372855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:56:24.372855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:56:24.388640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4811157f-6851-4934-972c-bf1828daa954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4F2CA960>]}
[0m03:56:24.547745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4811157f-6851-4934-972c-bf1828daa954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4E0E1070>]}
[0m03:56:24.547745 [info ] [MainThread]: Found 7 models, 421 macros
[0m03:56:24.547745 [info ] [MainThread]: 
[0m03:56:24.563679 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:56:24.563679 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m03:56:24.691069 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m03:56:24.691069 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m03:56:24.691069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:24.707200 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m03:56:24.707200 [debug] [ThreadPool]: On list_warehouse: Close
[0m03:56:24.707200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m03:56:24.707200 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m03:56:24.723174 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:56:24.723174 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m03:56:24.723174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:24.723174 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m03:56:24.723174 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:56:24.723174 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m03:56:24.723174 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:56:24.738881 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:56:24.738881 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m03:56:24.738881 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:56:24.738881 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m03:56:24.738881 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:56:24.738881 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m03:56:24.738881 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:56:24.738881 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m03:56:24.744500 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m03:56:24.744500 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m03:56:24.744500 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m03:56:24.744500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:24.754706 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m03:56:24.754706 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m03:56:24.754706 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m03:56:24.786191 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m03:56:24.786191 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m03:56:24.786191 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m03:56:24.786191 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m03:56:24.802155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4811157f-6851-4934-972c-bf1828daa954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4F4D1820>]}
[0m03:56:24.802155 [debug] [MainThread]: Using duckdb connection "master"
[0m03:56:24.802155 [debug] [MainThread]: On master: BEGIN
[0m03:56:24.802155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:56:24.802155 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m03:56:24.802155 [debug] [MainThread]: On master: COMMIT
[0m03:56:24.802155 [debug] [MainThread]: Using duckdb connection "master"
[0m03:56:24.802155 [debug] [MainThread]: On master: COMMIT
[0m03:56:24.802155 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:56:24.802155 [debug] [MainThread]: On master: Close
[0m03:56:24.817916 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:56:24.817916 [info ] [MainThread]: 
[0m03:56:24.833648 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m03:56:24.833648 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m03:56:24.833648 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m03:56:24.833648 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m03:56:24.833648 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m03:56:24.833648 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m03:56:24.833648 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m03:56:24.833648 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m03:56:24.849561 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m03:56:24.849561 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m03:56:24.833648 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m03:56:24.849561 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m03:56:24.849561 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m03:56:24.849561 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m03:56:24.849561 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m03:56:24.849561 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m03:56:24.849561 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m03:56:24.865698 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m03:56:24.897770 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m03:56:24.897770 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m03:56:24.913540 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m03:56:24.913540 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m03:56:24.913540 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m03:56:24.913540 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:56:24.913540 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m03:56:24.913540 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m03:56:24.919433 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m03:56:24.919433 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:56:24.919433 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m03:56:24.921444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:56:24.926121 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m03:56:24.926121 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m03:56:24.926121 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m03:56:24.929231 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m03:56:24.929231 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m03:56:24.929231 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m03:56:24.929231 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m03:56:24.929231 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m03:56:24.929231 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m03:56:24.929231 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m03:56:24.929231 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m03:56:24.929231 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m03:56:24.929231 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m03:56:24.929231 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m03:56:24.929231 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: ROLLBACK
[0m03:56:24.929231 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: ROLLBACK
[0m03:56:24.929231 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:56:24.944564 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: ROLLBACK
[0m03:56:24.960350 [debug] [Thread-3 (]: Failed to rollback 'model.meta_product_analytics.stg_users'
[0m03:56:24.962372 [debug] [Thread-2 (]: Failed to rollback 'model.meta_product_analytics.stg_events'
[0m03:56:24.964387 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m03:56:24.964387 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m03:56:24.964387 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.stg_content'
[0m03:56:24.968840 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m03:56:24.968840 [debug] [Thread-2 (]: Runtime Error in model stg_events (models\staging\stg_events.sql)
  IO Error: No files found that match the pattern "data/raw/events_app.csv"
[0m03:56:24.980459 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4811157f-6851-4934-972c-bf1828daa954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4FA461E0>]}
[0m03:56:24.980459 [debug] [Thread-3 (]: Runtime Error in model stg_users (models\staging\stg_users.sql)
  IO Error: No files found that match the pattern "data/raw/users.csv"
[0m03:56:24.980459 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4811157f-6851-4934-972c-bf1828daa954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4D587200>]}
[0m03:56:24.980459 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.14s]
[0m03:56:24.980459 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m03:56:24.980459 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.13s]
[0m03:56:24.991771 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.fct_product_events
[0m03:56:24.991771 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m03:56:24.997596 [debug] [Thread-1 (]: Runtime Error in model stg_content (models\staging\stg_content.sql)
  IO Error: No files found that match the pattern "data/raw/content.csv"
[0m03:56:24.997596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4811157f-6851-4934-972c-bf1828daa954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4F7125D0>]}
[0m03:56:24.997596 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.dim_users
[0m03:56:24.991771 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.fct_product_events ................................... [[33mSKIP[0m]
[0m03:56:24.997596 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m03:56:24.997596 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_content .......................... [[31mERROR[0m in 0.16s]
[0m03:56:24.997596 [info ] [Thread-2 (]: 5 of 7 SKIP relation main.dim_users ............................................ [[33mSKIP[0m]
[0m03:56:24.997596 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m03:56:24.997596 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.dim_users
[0m03:56:25.007453 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.dim_content
[0m03:56:25.007453 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m03:56:25.007453 [info ] [Thread-3 (]: 6 of 7 SKIP relation main.dim_content .......................................... [[33mSKIP[0m]
[0m03:56:25.007453 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.dim_content
[0m03:56:25.007453 [info ] [Thread-4 (]: 7 of 7 SKIP relation main.agg_product_kpis ..................................... [[33mSKIP[0m]
[0m03:56:25.007453 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m03:56:25.007453 [debug] [MainThread]: Using duckdb connection "master"
[0m03:56:25.007453 [debug] [MainThread]: On master: BEGIN
[0m03:56:25.007453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:56:25.032083 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m03:56:25.032083 [debug] [MainThread]: On master: COMMIT
[0m03:56:25.034098 [debug] [MainThread]: Using duckdb connection "master"
[0m03:56:25.034098 [debug] [MainThread]: On master: COMMIT
[0m03:56:25.034098 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:56:25.034098 [debug] [MainThread]: On master: Close
[0m03:56:25.039481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:56:25.039481 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m03:56:25.041508 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m03:56:25.041508 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_content' was properly closed.
[0m03:56:25.041508 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_events' was properly closed.
[0m03:56:25.041508 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_users' was properly closed.
[0m03:56:25.043527 [info ] [MainThread]: 
[0m03:56:25.044542 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m03:56:25.044542 [debug] [MainThread]: Command end result
[0m03:56:25.105477 [info ] [MainThread]: 
[0m03:56:25.105477 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:56:25.105477 [info ] [MainThread]: 
[0m03:56:25.105477 [error] [MainThread]:   Runtime Error in model stg_events (models\staging\stg_events.sql)
  IO Error: No files found that match the pattern "data/raw/events_app.csv"
[0m03:56:25.105477 [info ] [MainThread]: 
[0m03:56:25.105477 [error] [MainThread]:   Runtime Error in model stg_users (models\staging\stg_users.sql)
  IO Error: No files found that match the pattern "data/raw/users.csv"
[0m03:56:25.112439 [info ] [MainThread]: 
[0m03:56:25.112439 [error] [MainThread]:   Runtime Error in model stg_content (models\staging\stg_content.sql)
  IO Error: No files found that match the pattern "data/raw/content.csv"
[0m03:56:25.112439 [info ] [MainThread]: 
[0m03:56:25.112439 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m03:56:25.119045 [debug] [MainThread]: Command `dbt build` failed at 03:56:25.117520 after 1.91 seconds
[0m03:56:25.119045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4DA78500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4DA787A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4DD4EA50>]}
[0m03:56:25.119045 [debug] [MainThread]: Flushing usage events
[0m03:56:37.111067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E2C97260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E3193800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E25BF860>]}


============================== 03:56:37.119306 | 1c147bed-41f5-4ea4-95f7-99f93ac6653e ==============================
[0m03:56:37.119306 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:56:47.059892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m03:56:47.133393 [info ] [MainThread]: dbt version: 1.8.6
[0m03:56:47.135936 [info ] [MainThread]: python version: 3.12.10
[0m03:56:47.145846 [info ] [MainThread]: python path: C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Scripts\python.exe
[0m03:56:47.147858 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m03:56:47.305662 [info ] [MainThread]: Using profiles dir at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project
[0m03:56:47.310064 [info ] [MainThread]: Using profiles.yml file at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\profiles.yml
[0m03:56:47.316109 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\dbt_project.yml
[0m03:56:47.320718 [info ] [MainThread]: adapter type: duckdb
[0m03:56:47.323523 [info ] [MainThread]: adapter version: 1.8.2
[0m03:56:47.459778 [info ] [MainThread]: Configuration:
[0m03:56:47.463653 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:56:47.467679 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:56:47.467679 [info ] [MainThread]: Required dependencies:
[0m03:56:47.467679 [debug] [MainThread]: Executing "git --help"
[0m03:56:47.534484 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:56:47.534484 [debug] [MainThread]: STDERR: "b''"
[0m03:56:47.534484 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:56:47.537017 [info ] [MainThread]: Connection:
[0m03:56:47.544904 [info ] [MainThread]:   database: warehouse
[0m03:56:47.544904 [info ] [MainThread]:   schema: main
[0m03:56:47.544904 [info ] [MainThread]:   path: ./infra/warehouse.duckdb
[0m03:56:47.544904 [info ] [MainThread]:   config_options: None
[0m03:56:47.544904 [info ] [MainThread]:   extensions: None
[0m03:56:47.544904 [info ] [MainThread]:   settings: {}
[0m03:56:47.544904 [info ] [MainThread]:   external_root: .
[0m03:56:47.544904 [info ] [MainThread]:   use_credential_provider: None
[0m03:56:47.558748 [info ] [MainThread]:   attach: None
[0m03:56:47.558748 [info ] [MainThread]:   filesystems: None
[0m03:56:47.558748 [info ] [MainThread]:   remote: None
[0m03:56:47.558748 [info ] [MainThread]:   plugins: None
[0m03:56:47.558748 [info ] [MainThread]:   disable_transactions: False
[0m03:56:47.558748 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m03:56:47.930640 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:56:48.020148 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:56:48.022161 [debug] [MainThread]: On debug: select 1 as id
[0m03:56:48.022161 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:56:48.035691 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m03:56:48.035691 [debug] [MainThread]: On debug: Close
[0m03:56:48.037707 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:56:48.037707 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:56:48.048014 [debug] [MainThread]: Command `dbt debug` succeeded at 03:56:48.048014 after 11.15 seconds
[0m03:56:48.048014 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:56:48.048014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E49A28D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E716C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E55369F0>]}
[0m03:56:48.048014 [debug] [MainThread]: Flushing usage events
[0m03:56:55.848890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002768290F6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276828A40E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276820038C0>]}


============================== 03:56:55.858394 | 652cf822-21bd-464f-98aa-a2a955d4754a ==============================
[0m03:56:55.858394 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:56:55.858394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:56:56.213305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '652cf822-21bd-464f-98aa-a2a955d4754a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027682DBA540>]}
[0m03:56:56.300770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '652cf822-21bd-464f-98aa-a2a955d4754a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027682D98860>]}
[0m03:56:56.303558 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m03:56:56.784882 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m03:56:56.972435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:56:56.972435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:56:57.020293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '652cf822-21bd-464f-98aa-a2a955d4754a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027681B54E30>]}
[0m03:56:57.212778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '652cf822-21bd-464f-98aa-a2a955d4754a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027682DA8050>]}
[0m03:56:57.212778 [info ] [MainThread]: Found 7 models, 421 macros
[0m03:56:57.224069 [info ] [MainThread]: 
[0m03:56:57.228789 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:56:57.240003 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m03:56:57.370614 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m03:56:57.374914 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m03:56:57.374914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:57.389886 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m03:56:57.389886 [debug] [ThreadPool]: On list_warehouse: Close
[0m03:56:57.389886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m03:56:57.389886 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m03:56:57.413882 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:56:57.413882 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m03:56:57.413882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:57.435469 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m03:56:57.439931 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:56:57.439931 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m03:56:57.439931 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:56:57.442590 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:56:57.442590 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m03:56:57.442590 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:56:57.442590 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m03:56:57.442590 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m03:56:57.442590 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m03:56:57.442590 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:56:57.442590 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m03:56:57.454403 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m03:56:57.459567 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m03:56:57.459567 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m03:56:57.459567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:57.477871 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m03:56:57.477871 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m03:56:57.477871 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m03:56:57.530619 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m03:56:57.532629 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m03:56:57.534641 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m03:56:57.534641 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m03:56:57.541664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '652cf822-21bd-464f-98aa-a2a955d4754a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027683F57F80>]}
[0m03:56:57.542662 [debug] [MainThread]: Using duckdb connection "master"
[0m03:56:57.542662 [debug] [MainThread]: On master: BEGIN
[0m03:56:57.542662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:56:57.554923 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m03:56:57.554923 [debug] [MainThread]: On master: COMMIT
[0m03:56:57.554923 [debug] [MainThread]: Using duckdb connection "master"
[0m03:56:57.554923 [debug] [MainThread]: On master: COMMIT
[0m03:56:57.554923 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:56:57.554923 [debug] [MainThread]: On master: Close
[0m03:56:57.554923 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:56:57.554923 [info ] [MainThread]: 
[0m03:56:57.576126 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m03:56:57.576126 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m03:56:57.576126 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m03:56:57.576126 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m03:56:57.576126 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m03:56:57.584737 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m03:56:57.576126 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m03:56:57.585748 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m03:56:57.590709 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m03:56:57.590709 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m03:56:57.590709 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m03:56:57.598739 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m03:56:57.600744 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m03:56:57.601748 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m03:56:57.605775 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m03:56:57.609600 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m03:56:57.617816 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m03:56:57.672609 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m03:56:57.681653 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m03:56:57.682650 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m03:56:57.690212 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m03:56:57.690212 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m03:56:57.692225 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m03:56:57.692225 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m03:56:57.692225 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m03:56:57.692225 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:56:57.692225 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m03:56:57.692225 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:56:57.696072 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m03:56:57.696072 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:56:57.707534 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m03:56:57.707534 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m03:56:57.707534 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m03:56:57.710773 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m03:56:57.710773 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m03:56:57.710773 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m03:56:57.710773 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m03:56:57.710773 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m03:56:57.710773 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m03:56:57.710773 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m03:56:57.710773 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m03:56:57.710773 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m03:56:57.710773 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m03:56:57.710773 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: ROLLBACK
[0m03:56:57.710773 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: ROLLBACK
[0m03:56:57.710773 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m03:56:57.722595 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:56:57.722595 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: ROLLBACK
[0m03:56:57.737833 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.stg_content'
[0m03:56:57.738676 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m03:56:57.738676 [debug] [Thread-3 (]: Failed to rollback 'model.meta_product_analytics.stg_users'
[0m03:56:57.738676 [debug] [Thread-2 (]: Failed to rollback 'model.meta_product_analytics.stg_events'
[0m03:56:57.738676 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m03:56:57.738676 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m03:56:57.748617 [debug] [Thread-1 (]: Runtime Error in model stg_content (models\staging\stg_content.sql)
  IO Error: No files found that match the pattern "data/raw/content.csv"
[0m03:56:57.748617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '652cf822-21bd-464f-98aa-a2a955d4754a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276845FF4D0>]}
[0m03:56:57.754958 [debug] [Thread-3 (]: Runtime Error in model stg_users (models\staging\stg_users.sql)
  IO Error: No files found that match the pattern "data/raw/users.csv"
[0m03:56:57.754958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '652cf822-21bd-464f-98aa-a2a955d4754a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002768482F1A0>]}
[0m03:56:57.748617 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_content .......................... [[31mERROR[0m in 0.17s]
[0m03:56:57.754958 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m03:56:57.759979 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_content
[0m03:56:57.762885 [debug] [Thread-2 (]: Runtime Error in model stg_events (models\staging\stg_events.sql)
  IO Error: No files found that match the pattern "data/raw/events_app.csv"
[0m03:56:57.754958 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.16s]
[0m03:56:57.762885 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '652cf822-21bd-464f-98aa-a2a955d4754a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027683FB7B30>]}
[0m03:56:57.762114 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.dim_content .......................................... [[33mSKIP[0m]
[0m03:56:57.762885 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m03:56:57.762885 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.18s]
[0m03:56:57.762885 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_content
[0m03:56:57.762885 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m03:56:57.772160 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.fct_product_events
[0m03:56:57.769246 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.dim_users
[0m03:56:57.772160 [info ] [Thread-3 (]: 6 of 7 SKIP relation main.fct_product_events ................................... [[33mSKIP[0m]
[0m03:56:57.774724 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m03:56:57.772160 [info ] [Thread-1 (]: 5 of 7 SKIP relation main.dim_users ............................................ [[33mSKIP[0m]
[0m03:56:57.775715 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.dim_users
[0m03:56:57.777466 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m03:56:57.777466 [info ] [Thread-2 (]: 7 of 7 SKIP relation main.agg_product_kpis ..................................... [[33mSKIP[0m]
[0m03:56:57.779473 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m03:56:57.781482 [debug] [MainThread]: Using duckdb connection "master"
[0m03:56:57.781482 [debug] [MainThread]: On master: BEGIN
[0m03:56:57.781482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:56:57.794530 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m03:56:57.794530 [debug] [MainThread]: On master: COMMIT
[0m03:56:57.796537 [debug] [MainThread]: Using duckdb connection "master"
[0m03:56:57.796537 [debug] [MainThread]: On master: COMMIT
[0m03:56:57.796537 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:56:57.798546 [debug] [MainThread]: On master: Close
[0m03:56:57.800556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:56:57.800556 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m03:56:57.801562 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m03:56:57.801562 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_content' was properly closed.
[0m03:56:57.801562 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_events' was properly closed.
[0m03:56:57.801562 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_users' was properly closed.
[0m03:56:57.801562 [info ] [MainThread]: 
[0m03:56:57.804517 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m03:56:57.818168 [debug] [MainThread]: Command end result
[0m03:56:57.855815 [info ] [MainThread]: 
[0m03:56:57.855815 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:56:57.855815 [info ] [MainThread]: 
[0m03:56:57.863209 [error] [MainThread]:   Runtime Error in model stg_content (models\staging\stg_content.sql)
  IO Error: No files found that match the pattern "data/raw/content.csv"
[0m03:56:57.863209 [info ] [MainThread]: 
[0m03:56:57.863209 [error] [MainThread]:   Runtime Error in model stg_users (models\staging\stg_users.sql)
  IO Error: No files found that match the pattern "data/raw/users.csv"
[0m03:56:57.865217 [info ] [MainThread]: 
[0m03:56:57.865217 [error] [MainThread]:   Runtime Error in model stg_events (models\staging\stg_events.sql)
  IO Error: No files found that match the pattern "data/raw/events_app.csv"
[0m03:56:57.875766 [info ] [MainThread]: 
[0m03:56:57.875766 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m03:56:57.875766 [debug] [MainThread]: Command `dbt build` failed at 03:56:57.875766 after 2.25 seconds
[0m03:56:57.875766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002768290F6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276822C46B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276829FC3E0>]}
[0m03:56:57.875766 [debug] [MainThread]: Flushing usage events
[0m04:07:00.589942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F52B13D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F1D86960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F4C020F0>]}


============================== 04:07:00.600391 | e737a2fd-501d-4a60-997c-0b5316e0ec5a ==============================
[0m04:07:00.600391 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:07:00.600391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:07:00.876390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e737a2fd-501d-4a60-997c-0b5316e0ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F5293F50>]}
[0m04:07:00.955580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e737a2fd-501d-4a60-997c-0b5316e0ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F4C03AA0>]}
[0m04:07:00.955580 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:07:01.294423 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:07:01.479766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:07:01.479766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:07:01.511960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e737a2fd-501d-4a60-997c-0b5316e0ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F653E6F0>]}
[0m04:07:01.677116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e737a2fd-501d-4a60-997c-0b5316e0ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F683C2F0>]}
[0m04:07:01.677116 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:07:01.677116 [info ] [MainThread]: 
[0m04:07:01.682643 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:07:01.689121 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:07:01.811694 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:07:01.811694 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:07:01.811694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:01.840261 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m04:07:01.843515 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:07:01.847388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:07:01.849415 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:07:01.861247 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:07:01.861247 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:07:01.861247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:07:01.867298 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m04:07:01.874961 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:07:01.876477 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:07:01.876477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:07:01.876477 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:07:01.876477 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:07:01.876477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:07:01.876477 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:07:01.876477 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:07:01.876477 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:07:01.876477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:07:01.876477 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:07:01.886711 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:07:01.897119 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:07:01.897119 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:07:01.899131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:01.914337 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m04:07:01.914337 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:07:01.914337 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:07:01.954751 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m04:07:01.954751 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:07:01.954751 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:07:01.954751 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:07:01.954751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e737a2fd-501d-4a60-997c-0b5316e0ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F6817CE0>]}
[0m04:07:01.954751 [debug] [MainThread]: Using duckdb connection "master"
[0m04:07:01.954751 [debug] [MainThread]: On master: BEGIN
[0m04:07:01.954751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:07:01.978466 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:07:01.978466 [debug] [MainThread]: On master: COMMIT
[0m04:07:01.978466 [debug] [MainThread]: Using duckdb connection "master"
[0m04:07:01.978466 [debug] [MainThread]: On master: COMMIT
[0m04:07:01.978466 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:07:01.980475 [debug] [MainThread]: On master: Close
[0m04:07:01.982495 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:07:01.982495 [info ] [MainThread]: 
[0m04:07:01.988461 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:07:01.988461 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:07:01.988461 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:07:01.988461 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:07:02.010514 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:07:01.988461 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:07:02.010514 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:07:02.010514 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:07:02.024973 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:07:01.988461 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:07:02.020412 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:07:02.026988 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:07:02.026988 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:07:02.026988 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:07:02.026988 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:07:02.026988 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:07:02.040548 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:07:02.050580 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:07:02.094073 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:07:02.097893 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:07:02.097893 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:07:02.097893 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:07:02.097893 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:07:02.097893 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:07:02.097893 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:07:02.097893 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:07:02.097893 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:07:02.109700 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:07:02.109700 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:07:02.109700 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:07:02.116402 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m04:07:02.116402 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m04:07:02.116402 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:07:02.116402 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:07:02.116402 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m04:07:02.116402 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m04:07:02.116402 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m04:07:02.116402 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:07:02.116402 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m04:07:02.125362 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m04:07:02.125362 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m04:07:02.126656 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m04:07:02.126656 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:07:02.126656 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:07:02.126656 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:07:02.126656 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: ROLLBACK
[0m04:07:02.129837 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: ROLLBACK
[0m04:07:02.129837 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: ROLLBACK
[0m04:07:02.139918 [debug] [Thread-3 (]: Failed to rollback 'model.meta_product_analytics.stg_users'
[0m04:07:02.142719 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:07:02.142719 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.stg_content'
[0m04:07:02.142719 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:07:02.145933 [debug] [Thread-2 (]: Failed to rollback 'model.meta_product_analytics.stg_events'
[0m04:07:02.145933 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:07:02.147941 [debug] [Thread-1 (]: Runtime Error in model stg_content (models\staging\stg_content.sql)
  Binder Error: Referenced column "topic" not found in FROM clause!
  Candidate bindings: "raw.content_id"
  LINE 11:   topic,
             ^
[0m04:07:02.151945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e737a2fd-501d-4a60-997c-0b5316e0ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F652C470>]}
[0m04:07:02.156882 [debug] [Thread-3 (]: Runtime Error in model stg_users (models\staging\stg_users.sql)
  Binder Error: Column "signup_ts" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m04:07:02.156882 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e737a2fd-501d-4a60-997c-0b5316e0ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F6D5A120>]}
[0m04:07:02.163443 [debug] [Thread-2 (]: Runtime Error in model stg_events (models\staging\stg_events.sql)
  Binder Error: Referenced column "app_version" not found in FROM clause!
  Candidate bindings: "raw.user_id", "raw.event_id", "raw.event_ts"
  LINE 14:   app_version,
             ^
[0m04:07:02.151945 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_content .......................... [[31mERROR[0m in 0.16s]
[0m04:07:02.163443 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e737a2fd-501d-4a60-997c-0b5316e0ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F6DA0650>]}
[0m04:07:02.163443 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:07:02.163443 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.15s]
[0m04:07:02.158896 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.13s]
[0m04:07:02.163443 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:07:02.163443 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:07:02.163443 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_content
[0m04:07:02.163443 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:07:02.163443 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.dim_content .......................................... [[33mSKIP[0m]
[0m04:07:02.177957 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:07:02.174920 [info ] [Thread-1 (]: 5 of 7 SKIP relation main.fct_product_events ................................... [[33mSKIP[0m]
[0m04:07:02.177957 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:07:02.176440 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.dim_users
[0m04:07:02.179980 [info ] [Thread-3 (]: 6 of 7 SKIP relation main.dim_users ............................................ [[33mSKIP[0m]
[0m04:07:02.179980 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:07:02.179980 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:07:02.179980 [info ] [Thread-4 (]: 7 of 7 SKIP relation main.agg_product_kpis ..................................... [[33mSKIP[0m]
[0m04:07:02.179980 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:07:02.192367 [debug] [MainThread]: Using duckdb connection "master"
[0m04:07:02.192367 [debug] [MainThread]: On master: BEGIN
[0m04:07:02.193879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:07:02.203647 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m04:07:02.205659 [debug] [MainThread]: On master: COMMIT
[0m04:07:02.205659 [debug] [MainThread]: Using duckdb connection "master"
[0m04:07:02.205659 [debug] [MainThread]: On master: COMMIT
[0m04:07:02.205659 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:07:02.207678 [debug] [MainThread]: On master: Close
[0m04:07:02.209691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:02.211714 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:07:02.211714 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:07:02.211714 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_content' was properly closed.
[0m04:07:02.211714 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_events' was properly closed.
[0m04:07:02.211714 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_users' was properly closed.
[0m04:07:02.213725 [info ] [MainThread]: 
[0m04:07:02.213725 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m04:07:02.224238 [debug] [MainThread]: Command end result
[0m04:07:02.261020 [info ] [MainThread]: 
[0m04:07:02.261020 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m04:07:02.274979 [info ] [MainThread]: 
[0m04:07:02.276492 [error] [MainThread]:   Runtime Error in model stg_content (models\staging\stg_content.sql)
  Binder Error: Referenced column "topic" not found in FROM clause!
  Candidate bindings: "raw.content_id"
  LINE 11:   topic,
             ^
[0m04:07:02.276492 [info ] [MainThread]: 
[0m04:07:02.276492 [error] [MainThread]:   Runtime Error in model stg_events (models\staging\stg_events.sql)
  Binder Error: Referenced column "app_version" not found in FROM clause!
  Candidate bindings: "raw.user_id", "raw.event_id", "raw.event_ts"
  LINE 14:   app_version,
             ^
[0m04:07:02.276492 [info ] [MainThread]: 
[0m04:07:02.276492 [error] [MainThread]:   Runtime Error in model stg_users (models\staging\stg_users.sql)
  Binder Error: Column "signup_ts" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m04:07:02.276492 [info ] [MainThread]: 
[0m04:07:02.276492 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m04:07:02.276492 [debug] [MainThread]: Command `dbt build` failed at 04:07:02.276492 after 1.87 seconds
[0m04:07:02.276492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F4EFC2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F4F89010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116F4F8B9B0>]}
[0m04:07:02.276492 [debug] [MainThread]: Flushing usage events
[0m04:15:42.242122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240612F61E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240619FD880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024061DF3C20>]}


============================== 04:15:42.250082 | aa0bdce9-3bbf-4ad9-b123-0495b327fddf ==============================
[0m04:15:42.250082 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:15:42.250082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m04:15:42.523595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa0bdce9-3bbf-4ad9-b123-0495b327fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024062F801D0>]}
[0m04:15:42.595003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa0bdce9-3bbf-4ad9-b123-0495b327fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024061EAB0B0>]}
[0m04:15:42.597009 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:15:42.935041 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:15:43.085988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:15:43.085988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:15:43.118185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa0bdce9-3bbf-4ad9-b123-0495b327fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024062F83FE0>]}
[0m04:15:43.266159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa0bdce9-3bbf-4ad9-b123-0495b327fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240633CB050>]}
[0m04:15:43.266159 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:15:43.272161 [info ] [MainThread]: 
[0m04:15:43.278220 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:15:43.286032 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:15:43.416602 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:15:43.416602 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:15:43.416602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:15:43.425311 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m04:15:43.425311 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:15:43.439798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:15:43.439798 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:15:43.450038 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:15:43.450038 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:15:43.450038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:15:43.458840 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m04:15:43.458840 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:15:43.458840 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:15:43.458840 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:15:43.458840 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:15:43.458840 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:15:43.458840 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:15:43.466275 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:15:43.466275 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:15:43.466275 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:15:43.468285 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:15:43.468285 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:15:43.473001 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:15:43.479854 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:15:43.479854 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:15:43.479854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:15:43.488930 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m04:15:43.491753 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:15:43.491753 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:15:43.532722 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m04:15:43.532722 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:15:43.535919 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:15:43.535919 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:15:43.541419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa0bdce9-3bbf-4ad9-b123-0495b327fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405F510E30>]}
[0m04:15:43.541419 [debug] [MainThread]: Using duckdb connection "master"
[0m04:15:43.541419 [debug] [MainThread]: On master: BEGIN
[0m04:15:43.541419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:15:43.551674 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:15:43.551674 [debug] [MainThread]: On master: COMMIT
[0m04:15:43.553684 [debug] [MainThread]: Using duckdb connection "master"
[0m04:15:43.553684 [debug] [MainThread]: On master: COMMIT
[0m04:15:43.553684 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:15:43.553684 [debug] [MainThread]: On master: Close
[0m04:15:43.553684 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:15:43.558007 [info ] [MainThread]: 
[0m04:15:43.571388 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:15:43.571388 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:15:43.573396 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:15:43.573396 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:15:43.573396 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:15:43.573396 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:15:43.573396 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:15:43.573396 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:15:43.573396 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:15:43.573396 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:15:43.573396 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:15:43.589268 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:15:43.589268 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:15:43.592819 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:15:43.595552 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:15:43.595552 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:15:43.630128 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:15:43.630128 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:15:43.646153 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:15:43.648299 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:15:43.648299 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:15:43.654084 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:15:43.655437 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:15:43.655437 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:15:43.655437 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:15:43.655437 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:15:43.658053 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:15:43.658053 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:15:43.658053 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:15:43.659961 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:15:43.661805 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m04:15:43.661805 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m04:15:43.661805 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m04:15:43.661805 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:15:43.661805 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:15:43.661805 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:15:43.661805 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m04:15:43.661805 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m04:15:43.661805 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m04:15:43.661805 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m04:15:43.661805 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:15:43.675762 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: ROLLBACK
[0m04:15:43.675762 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m04:15:43.675762 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:15:43.677500 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m04:15:43.677500 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: ROLLBACK
[0m04:15:43.677500 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:15:43.677500 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: ROLLBACK
[0m04:15:43.677500 [debug] [Thread-2 (]: Failed to rollback 'model.meta_product_analytics.stg_events'
[0m04:15:43.693260 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.stg_content'
[0m04:15:43.694878 [debug] [Thread-3 (]: Failed to rollback 'model.meta_product_analytics.stg_users'
[0m04:15:43.696891 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:15:43.696891 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:15:43.696891 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:15:43.698899 [debug] [Thread-1 (]: Runtime Error in model stg_content (models\staging\stg_content.sql)
  Binder Error: Referenced column "topic" not found in FROM clause!
  Candidate bindings: "raw.content_id"
  LINE 11:   topic,
             ^
[0m04:15:43.698899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa0bdce9-3bbf-4ad9-b123-0495b327fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240613626C0>]}
[0m04:15:43.698899 [debug] [Thread-2 (]: Runtime Error in model stg_events (models\staging\stg_events.sql)
  Binder Error: Referenced column "app_version" not found in FROM clause!
  Candidate bindings: "raw.user_id", "raw.event_id", "raw.event_ts"
  LINE 14:   app_version,
             ^
[0m04:15:43.707239 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa0bdce9-3bbf-4ad9-b123-0495b327fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240638D2960>]}
[0m04:15:43.707239 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_content .......................... [[31mERROR[0m in 0.13s]
[0m04:15:43.709983 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:15:43.712001 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_content
[0m04:15:43.713907 [debug] [Thread-3 (]: Runtime Error in model stg_users (models\staging\stg_users.sql)
  Binder Error: Column "signup_ts" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m04:15:43.715914 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa0bdce9-3bbf-4ad9-b123-0495b327fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240633CBF20>]}
[0m04:15:43.709983 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.13s]
[0m04:15:43.715914 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:15:43.713176 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.dim_content .......................................... [[33mSKIP[0m]
[0m04:15:43.715914 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:15:43.715914 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:15:43.715914 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.14s]
[0m04:15:43.719964 [info ] [Thread-1 (]: 5 of 7 SKIP relation main.fct_product_events ................................... [[33mSKIP[0m]
[0m04:15:43.719964 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:15:43.721755 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:15:43.721755 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.dim_users
[0m04:15:43.723763 [info ] [Thread-1 (]: 6 of 7 SKIP relation main.dim_users ............................................ [[33mSKIP[0m]
[0m04:15:43.723763 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:15:43.726062 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:15:43.726062 [info ] [Thread-2 (]: 7 of 7 SKIP relation main.agg_product_kpis ..................................... [[33mSKIP[0m]
[0m04:15:43.731286 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:15:43.731286 [debug] [MainThread]: Using duckdb connection "master"
[0m04:15:43.731286 [debug] [MainThread]: On master: BEGIN
[0m04:15:43.731286 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:15:43.745977 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:15:43.745977 [debug] [MainThread]: On master: COMMIT
[0m04:15:43.745977 [debug] [MainThread]: Using duckdb connection "master"
[0m04:15:43.745977 [debug] [MainThread]: On master: COMMIT
[0m04:15:43.745977 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:15:43.745977 [debug] [MainThread]: On master: Close
[0m04:15:43.745977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:15:43.745977 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:15:43.745977 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:15:43.745977 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_content' was properly closed.
[0m04:15:43.745977 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_events' was properly closed.
[0m04:15:43.745977 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_users' was properly closed.
[0m04:15:43.745977 [info ] [MainThread]: 
[0m04:15:43.745977 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m04:15:43.745977 [debug] [MainThread]: Command end result
[0m04:15:43.789751 [info ] [MainThread]: 
[0m04:15:43.789751 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m04:15:43.789751 [info ] [MainThread]: 
[0m04:15:43.801950 [error] [MainThread]:   Runtime Error in model stg_content (models\staging\stg_content.sql)
  Binder Error: Referenced column "topic" not found in FROM clause!
  Candidate bindings: "raw.content_id"
  LINE 11:   topic,
             ^
[0m04:15:43.801950 [info ] [MainThread]: 
[0m04:15:43.801950 [error] [MainThread]:   Runtime Error in model stg_events (models\staging\stg_events.sql)
  Binder Error: Referenced column "app_version" not found in FROM clause!
  Candidate bindings: "raw.user_id", "raw.event_id", "raw.event_ts"
  LINE 14:   app_version,
             ^
[0m04:15:43.804201 [info ] [MainThread]: 
[0m04:15:43.805495 [error] [MainThread]:   Runtime Error in model stg_users (models\staging\stg_users.sql)
  Binder Error: Column "signup_ts" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m04:15:43.805495 [info ] [MainThread]: 
[0m04:15:43.805495 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m04:15:43.807235 [debug] [MainThread]: Command `dbt build` failed at 04:15:43.807235 after 1.72 seconds
[0m04:15:43.807235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024061EAB0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024061E6EF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024063233410>]}
[0m04:15:43.807235 [debug] [MainThread]: Flushing usage events
[0m04:16:00.485278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76F3F3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76F3F3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76F3F3AD0>]}


============================== 04:16:00.492262 | 8bfb58a0-b57b-4803-a1e0-be9377fc1381 ==============================
[0m04:16:00.492262 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:16:00.493670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:16:00.894036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bfb58a0-b57b-4803-a1e0-be9377fc1381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7705D68D0>]}
[0m04:16:00.984045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bfb58a0-b57b-4803-a1e0-be9377fc1381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76F4B8A40>]}
[0m04:16:00.984045 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:16:01.612833 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:16:03.439048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:16:03.439048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:16:03.486639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bfb58a0-b57b-4803-a1e0-be9377fc1381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A770685520>]}
[0m04:16:03.646369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bfb58a0-b57b-4803-a1e0-be9377fc1381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76F10C860>]}
[0m04:16:03.646369 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:16:03.649933 [info ] [MainThread]: 
[0m04:16:03.651944 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:16:03.657975 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:16:06.695238 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:16:06.695238 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:16:06.695238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:16:06.723662 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m04:16:06.726696 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:16:06.731564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:16:06.734199 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:16:06.748610 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:16:06.748610 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:16:06.748610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:16:06.762415 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m04:16:06.764432 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:16:06.764432 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:16:06.766446 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:16:06.766446 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:16:06.766446 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:16:06.766446 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:16:06.768462 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:16:06.768462 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:16:06.768462 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:16:06.770483 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:16:06.770483 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:16:06.774034 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:16:06.784791 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:16:06.784791 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:16:06.784791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:16:06.793850 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m04:16:06.795860 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:16:06.795860 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:16:06.846051 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m04:16:06.848066 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:16:06.848066 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:16:06.848066 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:16:06.853203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bfb58a0-b57b-4803-a1e0-be9377fc1381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A770E85E80>]}
[0m04:16:06.853203 [debug] [MainThread]: Using duckdb connection "master"
[0m04:16:06.853203 [debug] [MainThread]: On master: BEGIN
[0m04:16:06.853203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:16:06.859792 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m04:16:06.867689 [debug] [MainThread]: On master: COMMIT
[0m04:16:06.867689 [debug] [MainThread]: Using duckdb connection "master"
[0m04:16:06.869701 [debug] [MainThread]: On master: COMMIT
[0m04:16:06.869701 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:16:06.869701 [debug] [MainThread]: On master: Close
[0m04:16:06.872956 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:16:06.872956 [info ] [MainThread]: 
[0m04:16:06.885937 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:16:06.885937 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:16:06.885937 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:16:06.885937 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:16:06.885937 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:16:06.894868 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:16:06.894868 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:16:06.885937 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:16:06.905149 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:16:06.885937 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:16:06.907161 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:16:06.903132 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:16:06.907161 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:16:06.909570 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:16:06.911591 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:16:06.913605 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:16:06.946915 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:16:06.948929 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:16:06.961982 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:16:06.961982 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:16:06.962996 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:16:06.962996 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:16:06.962996 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:16:06.968646 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:16:06.968646 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:16:06.968646 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:16:06.968646 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:16:06.971634 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:16:06.971634 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:16:06.971634 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:16:06.978803 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m04:16:06.978803 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m04:16:06.978803 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m04:16:06.978803 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:16:06.978803 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:16:06.978803 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:16:06.978803 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m04:16:06.978803 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m04:16:06.978803 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m04:16:06.994692 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m04:16:06.996727 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m04:16:06.996727 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m04:16:06.996727 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:16:06.996727 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:16:06.996727 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:16:06.996727 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: ROLLBACK
[0m04:16:06.996727 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: ROLLBACK
[0m04:16:06.996727 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: ROLLBACK
[0m04:16:07.021253 [debug] [Thread-3 (]: Failed to rollback 'model.meta_product_analytics.stg_users'
[0m04:16:07.021253 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:16:07.023266 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.stg_content'
[0m04:16:07.025259 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:16:07.028792 [debug] [Thread-2 (]: Failed to rollback 'model.meta_product_analytics.stg_events'
[0m04:16:07.028792 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:16:07.028792 [debug] [Thread-1 (]: Runtime Error in model stg_content (models\staging\stg_content.sql)
  Binder Error: Referenced column "topic" not found in FROM clause!
  Candidate bindings: "raw.content_id"
  LINE 11:   topic,
             ^
[0m04:16:07.028792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bfb58a0-b57b-4803-a1e0-be9377fc1381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76F4B92B0>]}
[0m04:16:07.028792 [debug] [Thread-3 (]: Runtime Error in model stg_users (models\staging\stg_users.sql)
  Binder Error: Column "signup_ts" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m04:16:07.038949 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bfb58a0-b57b-4803-a1e0-be9377fc1381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76E952510>]}
[0m04:16:07.028792 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_content .......................... [[31mERROR[0m in 0.14s]
[0m04:16:07.040959 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:16:07.043423 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_content
[0m04:16:07.038949 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.13s]
[0m04:16:07.043423 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.dim_content .......................................... [[33mSKIP[0m]
[0m04:16:07.045439 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:16:07.047456 [debug] [Thread-2 (]: Runtime Error in model stg_events (models\staging\stg_events.sql)
  Binder Error: Referenced column "app_version" not found in FROM clause!
  Candidate bindings: "raw.user_id", "raw.event_id", "raw.event_ts"
  LINE 14:   app_version,
             ^
[0m04:16:07.047456 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:16:07.050076 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bfb58a0-b57b-4803-a1e0-be9377fc1381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76CBCBDA0>]}
[0m04:16:07.050627 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.dim_users
[0m04:16:07.050627 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.15s]
[0m04:16:07.053579 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:16:07.055041 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:16:07.052643 [info ] [Thread-1 (]: 5 of 7 SKIP relation main.dim_users ............................................ [[33mSKIP[0m]
[0m04:16:07.056307 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:16:07.055041 [info ] [Thread-4 (]: 6 of 7 SKIP relation main.fct_product_events ................................... [[33mSKIP[0m]
[0m04:16:07.056307 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:16:07.058535 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:16:07.059351 [info ] [Thread-2 (]: 7 of 7 SKIP relation main.agg_product_kpis ..................................... [[33mSKIP[0m]
[0m04:16:07.063691 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:16:07.063691 [debug] [MainThread]: Using duckdb connection "master"
[0m04:16:07.063691 [debug] [MainThread]: On master: BEGIN
[0m04:16:07.063691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:16:07.078985 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m04:16:07.078985 [debug] [MainThread]: On master: COMMIT
[0m04:16:07.078985 [debug] [MainThread]: Using duckdb connection "master"
[0m04:16:07.078985 [debug] [MainThread]: On master: COMMIT
[0m04:16:07.083585 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:16:07.083585 [debug] [MainThread]: On master: Close
[0m04:16:07.083585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:16:07.083585 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:16:07.083585 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:16:07.083585 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_content' was properly closed.
[0m04:16:07.083585 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_events' was properly closed.
[0m04:16:07.083585 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_users' was properly closed.
[0m04:16:07.083585 [info ] [MainThread]: 
[0m04:16:07.083585 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m04:16:07.090761 [debug] [MainThread]: Command end result
[0m04:16:07.120982 [info ] [MainThread]: 
[0m04:16:07.120982 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m04:16:07.128929 [info ] [MainThread]: 
[0m04:16:07.128929 [error] [MainThread]:   Runtime Error in model stg_content (models\staging\stg_content.sql)
  Binder Error: Referenced column "topic" not found in FROM clause!
  Candidate bindings: "raw.content_id"
  LINE 11:   topic,
             ^
[0m04:16:07.128929 [info ] [MainThread]: 
[0m04:16:07.136814 [error] [MainThread]:   Runtime Error in model stg_users (models\staging\stg_users.sql)
  Binder Error: Column "signup_ts" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m04:16:07.136814 [info ] [MainThread]: 
[0m04:16:07.138825 [error] [MainThread]:   Runtime Error in model stg_events (models\staging\stg_events.sql)
  Binder Error: Referenced column "app_version" not found in FROM clause!
  Candidate bindings: "raw.user_id", "raw.event_id", "raw.event_ts"
  LINE 14:   app_version,
             ^
[0m04:16:07.138825 [info ] [MainThread]: 
[0m04:16:07.138825 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m04:16:07.138825 [debug] [MainThread]: Command `dbt build` failed at 04:16:07.138825 after 6.88 seconds
[0m04:16:07.138825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76F01EC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76EDDF140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76EEAF9B0>]}
[0m04:16:07.138825 [debug] [MainThread]: Flushing usage events
[0m04:16:12.653917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9802F5B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9802CFF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9802CCF20>]}


============================== 04:16:12.658945 | 47ca6a70-6cda-469f-9431-cc0b5a5b5ef9 ==============================
[0m04:16:12.658945 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:16:15.813407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m04:16:16.144911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47ca6a70-6cda-469f-9431-cc0b5a5b5ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9806C8350>]}
[0m04:16:16.242224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47ca6a70-6cda-469f-9431-cc0b5a5b5ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A98066D6D0>]}
[0m04:16:16.244236 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:16:16.709164 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:16:16.788642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:16:16.788642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:16:16.836185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47ca6a70-6cda-469f-9431-cc0b5a5b5ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9818256A0>]}
[0m04:16:16.935237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47ca6a70-6cda-469f-9431-cc0b5a5b5ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A981B7BE60>]}
[0m04:16:16.935237 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:16:16.940438 [info ] [MainThread]: 
[0m04:16:16.944404 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:16:16.951225 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:16:17.013439 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:16:17.013439 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:16:17.013439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:16:17.013439 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m04:16:17.026078 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:16:17.026078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:16:17.026078 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:16:17.026078 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:16:17.026078 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:16:17.026078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:16:17.042012 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m04:16:17.042012 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:16:17.042012 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:16:17.042012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:16:17.042012 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:16:17.042012 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:16:17.042012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:16:17.042012 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:16:17.042012 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:16:17.042012 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:16:17.042012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:16:17.042012 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:16:17.042012 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:16:17.056679 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:16:17.056679 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:16:17.056679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:16:17.060034 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m04:16:17.060034 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:16:17.060034 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:16:17.090292 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m04:16:17.092310 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:16:17.092310 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:16:17.092310 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:16:17.097253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47ca6a70-6cda-469f-9431-cc0b5a5b5ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A981B55A30>]}
[0m04:16:17.099527 [debug] [MainThread]: Using duckdb connection "master"
[0m04:16:17.099527 [debug] [MainThread]: On master: BEGIN
[0m04:16:17.099527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:16:17.106186 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m04:16:17.106186 [debug] [MainThread]: On master: COMMIT
[0m04:16:17.106186 [debug] [MainThread]: Using duckdb connection "master"
[0m04:16:17.106186 [debug] [MainThread]: On master: COMMIT
[0m04:16:17.106186 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:16:17.108199 [debug] [MainThread]: On master: Close
[0m04:16:17.108199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:16:17.108199 [info ] [MainThread]: 
[0m04:16:17.112857 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:16:17.122221 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:16:17.121558 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:16:17.112857 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:16:17.122221 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:16:17.122221 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:16:17.122221 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:16:17.128569 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:16:17.122221 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:16:17.130905 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:16:17.137692 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:16:17.137692 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:16:17.141370 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:16:17.141370 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:16:17.141370 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:16:17.141370 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:16:17.169269 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:16:17.170488 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:16:17.171214 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:16:17.171214 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:16:17.171214 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:16:17.171214 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:16:17.184959 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:16:17.184959 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:16:17.186489 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:16:17.186489 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:16:17.187675 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:16:17.187675 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:16:17.187675 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:16:17.187675 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:16:17.195474 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m04:16:17.195474 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:16:17.195474 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m04:16:17.195474 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m04:16:17.199095 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m04:16:17.200125 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:16:17.200125 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:16:17.201392 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m04:16:17.201392 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv')
)
select
  cast(user_id as integer) as user_id,
  cast(signup_ts as timestamp) as signup_ts,
  country,
  cast(is_creator as integer) as is_creator,
  acq_channel
from raw
  );

[0m04:16:17.201392 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m04:16:17.201392 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:16:17.203824 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv')
)
select
  cast(content_id as integer) as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  topic,
  cast(created_ts as timestamp) as created_ts
from raw
  );

[0m04:16:17.203824 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: ROLLBACK
[0m04:16:17.205670 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:16:17.205670 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv')
)
select
  event_id,
  event_type,
  cast(user_id as integer) as user_id,
  nullif(content_id, '')::integer as content_id,
  cast(event_ts as timestamp) as event_ts,
  app_version,
  os,
  country,
  experiment,
  request_id,
  cast(ingested_at as timestamp) as ingested_at,
  date_trunc('day', event_ts) as event_date
from raw
  );

[0m04:16:17.205670 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: ROLLBACK
[0m04:16:17.205670 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:16:17.205670 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: ROLLBACK
[0m04:16:17.218213 [debug] [Thread-2 (]: Failed to rollback 'model.meta_product_analytics.stg_events'
[0m04:16:17.218213 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:16:17.220228 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.stg_content'
[0m04:16:17.220228 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:16:17.220228 [debug] [Thread-3 (]: Failed to rollback 'model.meta_product_analytics.stg_users'
[0m04:16:17.220228 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:16:17.226574 [debug] [Thread-3 (]: Runtime Error in model stg_users (models\staging\stg_users.sql)
  Binder Error: Column "signup_ts" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m04:16:17.226574 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47ca6a70-6cda-469f-9431-cc0b5a5b5ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A982064560>]}
[0m04:16:17.229258 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.10s]
[0m04:16:17.231328 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:16:17.231328 [debug] [Thread-2 (]: Runtime Error in model stg_events (models\staging\stg_events.sql)
  Binder Error: Referenced column "app_version" not found in FROM clause!
  Candidate bindings: "raw.user_id", "raw.event_id", "raw.event_ts"
  LINE 14:   app_version,
             ^
[0m04:16:17.235521 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_users
[0m04:16:17.235521 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47ca6a70-6cda-469f-9431-cc0b5a5b5ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9820C78F0>]}
[0m04:16:17.235521 [debug] [Thread-1 (]: Runtime Error in model stg_content (models\staging\stg_content.sql)
  Binder Error: Referenced column "topic" not found in FROM clause!
  Candidate bindings: "raw.content_id"
  LINE 11:   topic,
             ^
[0m04:16:17.235521 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.dim_users ............................................ [[33mSKIP[0m]
[0m04:16:17.235521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47ca6a70-6cda-469f-9431-cc0b5a5b5ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A981B4E9C0>]}
[0m04:16:17.235521 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:16:17.235521 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.10s]
[0m04:16:17.235521 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_content .......................... [[31mERROR[0m in 0.11s]
[0m04:16:17.235521 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:16:17.235521 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:16:17.247708 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.dim_content
[0m04:16:17.249056 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:16:17.249056 [info ] [Thread-3 (]: 5 of 7 SKIP relation main.dim_content .......................................... [[33mSKIP[0m]
[0m04:16:17.253772 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:16:17.251073 [info ] [Thread-4 (]: 6 of 7 SKIP relation main.fct_product_events ................................... [[33mSKIP[0m]
[0m04:16:17.253772 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:16:17.253772 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:16:17.256057 [info ] [Thread-1 (]: 7 of 7 SKIP relation main.agg_product_kpis ..................................... [[33mSKIP[0m]
[0m04:16:17.256057 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:16:17.257862 [debug] [MainThread]: Using duckdb connection "master"
[0m04:16:17.259677 [debug] [MainThread]: On master: BEGIN
[0m04:16:17.259677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:16:17.264029 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m04:16:17.264029 [debug] [MainThread]: On master: COMMIT
[0m04:16:17.264029 [debug] [MainThread]: Using duckdb connection "master"
[0m04:16:17.264029 [debug] [MainThread]: On master: COMMIT
[0m04:16:17.264029 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:16:17.264029 [debug] [MainThread]: On master: Close
[0m04:16:17.264029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:16:17.264029 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:16:17.264029 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:16:17.264029 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_content' was properly closed.
[0m04:16:17.264029 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_users' was properly closed.
[0m04:16:17.264029 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_events' was properly closed.
[0m04:16:17.264029 [info ] [MainThread]: 
[0m04:16:17.264029 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m04:16:17.280135 [debug] [MainThread]: Command end result
[0m04:16:17.297926 [info ] [MainThread]: 
[0m04:16:17.297926 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m04:16:17.297926 [info ] [MainThread]: 
[0m04:16:17.297926 [error] [MainThread]:   Runtime Error in model stg_users (models\staging\stg_users.sql)
  Binder Error: Column "signup_ts" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m04:16:17.297926 [info ] [MainThread]: 
[0m04:16:17.297926 [error] [MainThread]:   Runtime Error in model stg_events (models\staging\stg_events.sql)
  Binder Error: Referenced column "app_version" not found in FROM clause!
  Candidate bindings: "raw.user_id", "raw.event_id", "raw.event_ts"
  LINE 14:   app_version,
             ^
[0m04:16:17.297926 [info ] [MainThread]: 
[0m04:16:17.297926 [error] [MainThread]:   Runtime Error in model stg_content (models\staging\stg_content.sql)
  Binder Error: Referenced column "topic" not found in FROM clause!
  Candidate bindings: "raw.content_id"
  LINE 11:   topic,
             ^
[0m04:16:17.311102 [info ] [MainThread]: 
[0m04:16:17.316123 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m04:16:17.318140 [debug] [MainThread]: Command `dbt build` failed at 04:16:17.318140 after 4.83 seconds
[0m04:16:17.318140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FF6CA810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FFF6CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FFF6D7C0>]}
[0m04:16:17.318140 [debug] [MainThread]: Flushing usage events
[0m04:23:32.856329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C909D02180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C909D02030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C909D012E0>]}


============================== 04:23:32.856329 | 0b6794f7-79e5-47b6-b320-a71ab8903c7a ==============================
[0m04:23:32.856329 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:23:32.856329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:23:33.204050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b6794f7-79e5-47b6-b320-a71ab8903c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C909DA8A40>]}
[0m04:23:33.273325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b6794f7-79e5-47b6-b320-a71ab8903c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90AE943B0>]}
[0m04:23:33.275338 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:23:33.857850 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:23:35.883976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m04:23:35.883976 [debug] [MainThread]: Partial parsing: updated file: meta_product_analytics://models\staging\stg_events.sql
[0m04:23:35.883976 [debug] [MainThread]: Partial parsing: updated file: meta_product_analytics://models\staging\stg_users.sql
[0m04:23:35.883976 [debug] [MainThread]: Partial parsing: updated file: meta_product_analytics://models\staging\stg_content.sql
[0m04:23:36.153626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b6794f7-79e5-47b6-b320-a71ab8903c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90B2EFF20>]}
[0m04:23:36.296716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b6794f7-79e5-47b6-b320-a71ab8903c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90B35B110>]}
[0m04:23:36.312575 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:23:36.315762 [info ] [MainThread]: 
[0m04:23:36.315762 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:23:36.324392 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:23:41.321233 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:23:41.323254 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:23:41.323254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:23:41.352275 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m04:23:41.354292 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:23:41.356306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:23:41.356306 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:23:41.360073 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:23:41.360073 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:23:41.360073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:23:41.376177 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m04:23:41.376177 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:23:41.376177 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:23:41.376177 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:23:41.376177 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:23:41.376177 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:23:41.376177 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:23:41.376177 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:23:41.376177 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:23:41.376177 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:23:41.376177 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:23:41.376177 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:23:41.394039 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:23:41.401378 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:23:41.403394 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:23:41.403394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:23:41.415495 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m04:23:41.415495 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:23:41.415495 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:23:41.459400 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m04:23:41.459400 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:23:41.481592 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:23:41.481592 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:23:41.487529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b6794f7-79e5-47b6-b320-a71ab8903c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9073C7F80>]}
[0m04:23:41.487529 [debug] [MainThread]: Using duckdb connection "master"
[0m04:23:41.487529 [debug] [MainThread]: On master: BEGIN
[0m04:23:41.487529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:23:41.499905 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m04:23:41.499905 [debug] [MainThread]: On master: COMMIT
[0m04:23:41.499905 [debug] [MainThread]: Using duckdb connection "master"
[0m04:23:41.499905 [debug] [MainThread]: On master: COMMIT
[0m04:23:41.499905 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:23:41.499905 [debug] [MainThread]: On master: Close
[0m04:23:41.503558 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:23:41.503558 [info ] [MainThread]: 
[0m04:23:41.503558 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:23:41.503558 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:23:41.503558 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:23:41.503558 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:23:41.521637 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:23:41.523654 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:23:41.519612 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:23:41.528474 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:23:41.521637 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:23:41.535371 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:23:41.537390 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:23:41.537390 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:23:41.537390 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:23:41.542732 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:23:41.542732 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:23:41.542732 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:23:41.583366 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:23:41.583366 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:23:41.598727 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:23:41.598727 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:23:41.598727 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:23:41.598727 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:23:41.598727 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:23:41.598727 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:23:41.598727 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:23:41.598727 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:23:41.598727 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:23:41.612243 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:23:41.612243 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:23:41.612243 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:23:41.616278 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m04:23:41.616278 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m04:23:41.616278 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m04:23:41.616278 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:23:41.616278 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:23:41.616278 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:23:41.616278 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw;
  );

[0m04:23:41.616278 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw;
  );

[0m04:23:41.616278 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw;
  );

[0m04:23:41.616278 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw;
  );

[0m04:23:41.628454 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw;
  );

[0m04:23:41.628454 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw;
  );

[0m04:23:41.630207 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:23:41.630207 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:23:41.630207 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:23:41.630207 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: ROLLBACK
[0m04:23:41.630207 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: ROLLBACK
[0m04:23:41.630207 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: ROLLBACK
[0m04:23:41.851559 [debug] [Thread-3 (]: Failed to rollback 'model.meta_product_analytics.stg_users'
[0m04:23:41.851559 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:23:41.851559 [debug] [Thread-2 (]: Failed to rollback 'model.meta_product_analytics.stg_events'
[0m04:23:41.858448 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:23:41.858448 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.stg_content'
[0m04:23:41.858448 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:23:41.865362 [debug] [Thread-3 (]: Runtime Error in model stg_users (models\staging\stg_users.sql)
  Parser Error: syntax error at or near ";"
[0m04:23:41.867383 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6794f7-79e5-47b6-b320-a71ab8903c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90B50EB40>]}
[0m04:23:41.873478 [debug] [Thread-2 (]: Runtime Error in model stg_events (models\staging\stg_events.sql)
  Parser Error: syntax error at or near ";"
[0m04:23:41.869408 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.34s]
[0m04:23:41.873478 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6794f7-79e5-47b6-b320-a71ab8903c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90B37ED80>]}
[0m04:23:41.873478 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:23:41.873478 [debug] [Thread-1 (]: Runtime Error in model stg_content (models\staging\stg_content.sql)
  Parser Error: syntax error at or near ";"
[0m04:23:41.873478 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.34s]
[0m04:23:41.873478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6794f7-79e5-47b6-b320-a71ab8903c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90B8168A0>]}
[0m04:23:41.885473 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_users
[0m04:23:41.891153 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:23:41.891153 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_content .......................... [[31mERROR[0m in 0.35s]
[0m04:23:41.891153 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:23:41.891153 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:23:41.891153 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.dim_users ............................................ [[33mSKIP[0m]
[0m04:23:41.899417 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:23:41.891153 [info ] [Thread-3 (]: 5 of 7 SKIP relation main.fct_product_events ................................... [[33mSKIP[0m]
[0m04:23:41.901446 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:23:41.901446 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.dim_content
[0m04:23:41.904639 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:23:41.901446 [info ] [Thread-2 (]: 6 of 7 SKIP relation main.dim_content .......................................... [[33mSKIP[0m]
[0m04:23:41.904639 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:23:41.904639 [info ] [Thread-1 (]: 7 of 7 SKIP relation main.agg_product_kpis ..................................... [[33mSKIP[0m]
[0m04:23:41.904639 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:23:41.904639 [debug] [MainThread]: Using duckdb connection "master"
[0m04:23:41.904639 [debug] [MainThread]: On master: BEGIN
[0m04:23:41.904639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:23:41.915427 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:23:41.915427 [debug] [MainThread]: On master: COMMIT
[0m04:23:41.915427 [debug] [MainThread]: Using duckdb connection "master"
[0m04:23:41.915427 [debug] [MainThread]: On master: COMMIT
[0m04:23:41.921717 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:23:41.921717 [debug] [MainThread]: On master: Close
[0m04:23:41.921717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:23:41.921717 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:23:41.921717 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:23:41.921717 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_content' was properly closed.
[0m04:23:41.921717 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_users' was properly closed.
[0m04:23:41.921717 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_events' was properly closed.
[0m04:23:41.921717 [info ] [MainThread]: 
[0m04:23:41.921717 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m04:23:41.928800 [debug] [MainThread]: Command end result
[0m04:23:41.962979 [info ] [MainThread]: 
[0m04:23:41.964458 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m04:23:41.964458 [info ] [MainThread]: 
[0m04:23:41.964458 [error] [MainThread]:   Runtime Error in model stg_users (models\staging\stg_users.sql)
  Parser Error: syntax error at or near ";"
[0m04:23:41.964458 [info ] [MainThread]: 
[0m04:23:41.964458 [error] [MainThread]:   Runtime Error in model stg_events (models\staging\stg_events.sql)
  Parser Error: syntax error at or near ";"
[0m04:23:41.964458 [info ] [MainThread]: 
[0m04:23:41.964458 [error] [MainThread]:   Runtime Error in model stg_content (models\staging\stg_content.sql)
  Parser Error: syntax error at or near ";"
[0m04:23:41.964458 [info ] [MainThread]: 
[0m04:23:41.964458 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m04:23:41.973275 [debug] [MainThread]: Command `dbt build` failed at 04:23:41.971252 after 9.37 seconds
[0m04:23:41.973275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C908EF9AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90AEF6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9092499D0>]}
[0m04:23:41.973275 [debug] [MainThread]: Flushing usage events
[0m04:23:58.880596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6CCB2CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6FEECA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6FF20890>]}


============================== 04:23:58.890669 | e93536fc-e4b0-41e5-ba74-b3e900ef84bd ==============================
[0m04:23:58.890669 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:23:58.892687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:23:59.212621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e93536fc-e4b0-41e5-ba74-b3e900ef84bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC7023F0E0>]}
[0m04:23:59.287352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e93536fc-e4b0-41e5-ba74-b3e900ef84bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC7022EEA0>]}
[0m04:23:59.287352 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:23:59.635903 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:23:59.811391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:23:59.811391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:23:59.844170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e93536fc-e4b0-41e5-ba74-b3e900ef84bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC70289880>]}
[0m04:23:59.997094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e93536fc-e4b0-41e5-ba74-b3e900ef84bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC717942F0>]}
[0m04:23:59.997094 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:24:00.007691 [info ] [MainThread]: 
[0m04:24:00.008706 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:24:00.029518 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:24:00.138103 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:24:00.138103 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:24:00.138103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:24:00.165512 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m04:24:00.168179 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:24:00.171223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:24:00.171223 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:24:00.187309 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:00.187309 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:24:00.187309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:24:00.198575 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m04:24:00.200597 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:00.200597 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:24:00.200597 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:24:00.200597 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:00.200597 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:24:00.200597 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:24:00.200597 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:24:00.207778 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:00.207778 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:24:00.207778 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:24:00.209792 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:24:00.211805 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:24:00.221432 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:24:00.223459 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:24:00.223459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:24:00.232658 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m04:24:00.232658 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:24:00.232658 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:24:00.276804 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m04:24:00.276804 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:24:00.285207 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:24:00.285207 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:24:00.288981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e93536fc-e4b0-41e5-ba74-b3e900ef84bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6D8DC830>]}
[0m04:24:00.288981 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:00.290764 [debug] [MainThread]: On master: BEGIN
[0m04:24:00.290764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:24:00.290764 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:24:00.290764 [debug] [MainThread]: On master: COMMIT
[0m04:24:00.290764 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:00.290764 [debug] [MainThread]: On master: COMMIT
[0m04:24:00.290764 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:24:00.290764 [debug] [MainThread]: On master: Close
[0m04:24:00.290764 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:24:05.589895 [info ] [MainThread]: 
[0m04:24:05.640653 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:24:05.644678 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:24:05.644678 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:24:05.644678 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:24:05.648953 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:24:05.650978 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:24:05.644678 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:24:05.659519 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:24:05.659519 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:24:05.650978 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:24:05.659519 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:24:05.659519 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:24:05.668573 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:24:05.668573 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:24:05.668573 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:24:05.670585 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:24:05.704759 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:24:05.723763 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:24:05.720789 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:24:05.724302 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:24:05.724302 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:24:05.724302 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:24:05.732772 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:24:05.732772 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:24:05.733864 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:24:05.733864 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:24:05.734930 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:24:05.734930 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:24:05.736914 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:24:05.735903 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:24:05.742973 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m04:24:05.742973 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m04:24:05.742973 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:24:05.742973 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:24:05.742973 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m04:24:05.742973 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw;
  );

[0m04:24:05.742973 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw;
  );

[0m04:24:05.742973 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:24:05.742973 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw;
  );

[0m04:24:05.742973 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw;
  );

[0m04:24:05.742973 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw;
  );

[0m04:24:05.742973 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:24:05.753379 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw;
  );

[0m04:24:05.753379 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:24:05.753379 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: ROLLBACK
[0m04:24:05.753379 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:24:05.753379 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: ROLLBACK
[0m04:24:05.753379 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: ROLLBACK
[0m04:24:05.768544 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.stg_content'
[0m04:24:05.769436 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:24:05.769436 [debug] [Thread-2 (]: Failed to rollback 'model.meta_product_analytics.stg_events'
[0m04:24:05.769436 [debug] [Thread-3 (]: Failed to rollback 'model.meta_product_analytics.stg_users'
[0m04:24:05.769436 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:24:05.769436 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:24:05.769436 [debug] [Thread-1 (]: Runtime Error in model stg_content (models\staging\stg_content.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:05.769436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93536fc-e4b0-41e5-ba74-b3e900ef84bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC71D17DA0>]}
[0m04:24:05.782732 [debug] [Thread-2 (]: Runtime Error in model stg_events (models\staging\stg_events.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:05.784464 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93536fc-e4b0-41e5-ba74-b3e900ef84bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC713F1CD0>]}
[0m04:24:05.779784 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_content .......................... [[31mERROR[0m in 0.12s]
[0m04:24:05.786916 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:24:05.790952 [debug] [Thread-3 (]: Runtime Error in model stg_users (models\staging\stg_users.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:05.784464 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.12s]
[0m04:24:05.792966 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93536fc-e4b0-41e5-ba74-b3e900ef84bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC713F21B0>]}
[0m04:24:05.792966 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_content
[0m04:24:05.792966 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:24:05.792966 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.13s]
[0m04:24:05.798719 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:24:05.796550 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.dim_content .......................................... [[33mSKIP[0m]
[0m04:24:05.800479 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:24:05.800479 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.dim_users
[0m04:24:05.800479 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:24:05.802504 [info ] [Thread-1 (]: 5 of 7 SKIP relation main.dim_users ............................................ [[33mSKIP[0m]
[0m04:24:05.805047 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:24:05.805047 [info ] [Thread-2 (]: 6 of 7 SKIP relation main.fct_product_events ................................... [[33mSKIP[0m]
[0m04:24:05.805047 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:24:05.807967 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:24:05.807967 [info ] [Thread-4 (]: 7 of 7 SKIP relation main.agg_product_kpis ..................................... [[33mSKIP[0m]
[0m04:24:05.811141 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:24:05.813152 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:05.813737 [debug] [MainThread]: On master: BEGIN
[0m04:24:05.813737 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:24:05.823215 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m04:24:05.825230 [debug] [MainThread]: On master: COMMIT
[0m04:24:05.826435 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:05.826435 [debug] [MainThread]: On master: COMMIT
[0m04:24:05.827050 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:24:05.827050 [debug] [MainThread]: On master: Close
[0m04:24:05.831507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:24:05.831507 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:24:05.831507 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:24:05.831507 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_content' was properly closed.
[0m04:24:05.831507 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_events' was properly closed.
[0m04:24:05.831507 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_users' was properly closed.
[0m04:24:05.831507 [info ] [MainThread]: 
[0m04:24:05.831507 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m04:24:05.838653 [debug] [MainThread]: Command end result
[0m04:24:05.873510 [info ] [MainThread]: 
[0m04:24:05.873510 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m04:24:05.873510 [info ] [MainThread]: 
[0m04:24:05.873510 [error] [MainThread]:   Runtime Error in model stg_content (models\staging\stg_content.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:05.873510 [info ] [MainThread]: 
[0m04:24:05.873510 [error] [MainThread]:   Runtime Error in model stg_events (models\staging\stg_events.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:05.879195 [info ] [MainThread]: 
[0m04:24:05.879195 [error] [MainThread]:   Runtime Error in model stg_users (models\staging\stg_users.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:05.879195 [info ] [MainThread]: 
[0m04:24:05.879195 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m04:24:05.879195 [debug] [MainThread]: Command `dbt build` failed at 04:24:05.879195 after 7.19 seconds
[0m04:24:05.879195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6FE63560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC701C3E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC701C3B90>]}
[0m04:24:05.879195 [debug] [MainThread]: Flushing usage events
[0m04:24:13.393658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F8C69340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F7F551C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F8C6BCE0>]}


============================== 04:24:13.408220 | fc24feea-ec35-4e50-90ad-b84805c4734a ==============================
[0m04:24:13.408220 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:24:13.408220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:24:13.808562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc24feea-ec35-4e50-90ad-b84805c4734a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F90380E0>]}
[0m04:24:13.915295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc24feea-ec35-4e50-90ad-b84805c4734a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F7CD72F0>]}
[0m04:24:13.915295 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:24:14.353123 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:24:14.522582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:24:14.523220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:24:14.554412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc24feea-ec35-4e50-90ad-b84805c4734a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA2DE0C0>]}
[0m04:24:14.721829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc24feea-ec35-4e50-90ad-b84805c4734a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA5DB0B0>]}
[0m04:24:14.721829 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:24:14.736325 [info ] [MainThread]: 
[0m04:24:14.738086 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:24:14.753768 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:24:15.076700 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:24:15.076700 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:24:15.076700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:24:15.088238 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m04:24:15.096374 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:24:15.096374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:24:15.102187 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:24:15.113349 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:15.113349 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:24:15.113349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:24:15.129616 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m04:24:15.130831 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:15.130831 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:24:15.130831 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:24:15.130831 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:15.130831 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:24:15.130831 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:24:15.137376 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:24:15.137376 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:15.137376 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:24:15.137376 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:24:15.137376 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:24:15.144519 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:24:15.154419 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:24:15.155115 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:24:15.155115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:24:15.166798 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m04:24:15.166798 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:24:15.168812 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:24:15.226672 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m04:24:15.226672 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:24:15.233267 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:24:15.233267 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:24:15.240516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc24feea-ec35-4e50-90ad-b84805c4734a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F8F9CC50>]}
[0m04:24:15.240516 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:15.240516 [debug] [MainThread]: On master: BEGIN
[0m04:24:15.240516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:24:15.255901 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m04:24:15.255901 [debug] [MainThread]: On master: COMMIT
[0m04:24:15.260263 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:15.260711 [debug] [MainThread]: On master: COMMIT
[0m04:24:15.260711 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:24:15.260711 [debug] [MainThread]: On master: Close
[0m04:24:15.264994 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:24:15.266929 [info ] [MainThread]: 
[0m04:24:15.276526 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:24:15.281727 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:24:15.281727 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:24:15.281727 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:24:15.289485 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:24:15.284923 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:24:15.289485 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:24:15.291395 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:24:15.287464 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:24:15.306290 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:24:15.307848 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:24:15.308605 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:24:15.310107 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:24:15.310107 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:24:15.316913 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:24:15.316913 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:24:15.341576 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:24:15.407309 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:24:15.407309 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:24:15.410377 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:24:15.415718 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:24:15.419819 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:24:15.421550 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:24:15.422677 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:24:15.423069 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:24:15.424320 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:24:15.424320 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:24:15.426335 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:24:15.426335 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:24:15.426335 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:24:15.432799 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m04:24:15.437023 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m04:24:15.437944 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m04:24:15.437944 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:24:15.437944 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:24:15.437944 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:24:15.440929 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw;
  );

[0m04:24:15.440929 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw;
  );

[0m04:24:15.440929 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw;
  );

[0m04:24:15.444830 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw;
  );

[0m04:24:15.444830 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw;
  );

[0m04:24:15.444830 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw;
  );

[0m04:24:15.444830 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:24:15.449346 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:24:15.449346 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:24:15.452210 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: ROLLBACK
[0m04:24:15.451021 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: ROLLBACK
[0m04:24:15.454691 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: ROLLBACK
[0m04:24:15.473995 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.stg_content'
[0m04:24:15.473995 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:24:15.478732 [debug] [Thread-2 (]: Failed to rollback 'model.meta_product_analytics.stg_events'
[0m04:24:15.482054 [debug] [Thread-3 (]: Failed to rollback 'model.meta_product_analytics.stg_users'
[0m04:24:15.484071 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:24:15.487573 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:24:15.492814 [debug] [Thread-1 (]: Runtime Error in model stg_content (models\staging\stg_content.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:15.492814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc24feea-ec35-4e50-90ad-b84805c4734a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FAB18C80>]}
[0m04:24:15.498442 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_content .......................... [[31mERROR[0m in 0.21s]
[0m04:24:15.498442 [debug] [Thread-2 (]: Runtime Error in model stg_events (models\staging\stg_events.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:15.504193 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:24:15.506291 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc24feea-ec35-4e50-90ad-b84805c4734a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA709520>]}
[0m04:24:15.507366 [debug] [Thread-3 (]: Runtime Error in model stg_users (models\staging\stg_users.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:15.507366 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_content
[0m04:24:15.507366 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.21s]
[0m04:24:15.513757 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc24feea-ec35-4e50-90ad-b84805c4734a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FAB3C6B0>]}
[0m04:24:15.514657 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:24:15.514657 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.dim_content .......................................... [[33mSKIP[0m]
[0m04:24:15.521377 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:24:15.522836 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:24:15.514657 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.21s]
[0m04:24:15.522836 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:24:15.522836 [info ] [Thread-1 (]: 5 of 7 SKIP relation main.fct_product_events ................................... [[33mSKIP[0m]
[0m04:24:15.522836 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:24:15.522836 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.dim_users
[0m04:24:15.522836 [info ] [Thread-1 (]: 6 of 7 SKIP relation main.dim_users ............................................ [[33mSKIP[0m]
[0m04:24:15.522836 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:24:15.531298 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:24:15.531298 [info ] [Thread-2 (]: 7 of 7 SKIP relation main.agg_product_kpis ..................................... [[33mSKIP[0m]
[0m04:24:15.531298 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:24:15.537768 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:15.537768 [debug] [MainThread]: On master: BEGIN
[0m04:24:15.537768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:24:15.553296 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m04:24:15.553296 [debug] [MainThread]: On master: COMMIT
[0m04:24:15.555592 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:15.555592 [debug] [MainThread]: On master: COMMIT
[0m04:24:15.555592 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m04:24:15.555592 [debug] [MainThread]: On master: Close
[0m04:24:15.555592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:24:15.555592 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:24:15.555592 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:24:15.555592 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_content' was properly closed.
[0m04:24:15.555592 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_events' was properly closed.
[0m04:24:15.563997 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_users' was properly closed.
[0m04:24:15.563997 [info ] [MainThread]: 
[0m04:24:15.563997 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m04:24:15.563997 [debug] [MainThread]: Command end result
[0m04:24:15.622338 [info ] [MainThread]: 
[0m04:24:15.622338 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m04:24:15.624839 [info ] [MainThread]: 
[0m04:24:15.624839 [error] [MainThread]:   Runtime Error in model stg_content (models\staging\stg_content.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:15.624839 [info ] [MainThread]: 
[0m04:24:15.628450 [error] [MainThread]:   Runtime Error in model stg_events (models\staging\stg_events.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:15.629495 [info ] [MainThread]: 
[0m04:24:15.630388 [error] [MainThread]:   Runtime Error in model stg_users (models\staging\stg_users.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:15.632883 [info ] [MainThread]: 
[0m04:24:15.632883 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m04:24:15.639489 [debug] [MainThread]: Command `dbt build` failed at 04:24:15.639489 after 2.51 seconds
[0m04:24:15.640250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F8510620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F8F83C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F5CE1C70>]}
[0m04:24:15.641263 [debug] [MainThread]: Flushing usage events
[0m04:24:24.108175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B52919B440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B529198920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B529198B30>]}


============================== 04:24:24.121154 | ebe81ba1-f72e-411d-9624-1dc0a7f3723d ==============================
[0m04:24:24.121154 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:24:24.121154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m04:24:24.519755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebe81ba1-f72e-411d-9624-1dc0a7f3723d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B529673A40>]}
[0m04:24:24.622016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebe81ba1-f72e-411d-9624-1dc0a7f3723d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B526B94890>]}
[0m04:24:24.622016 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:24:25.074457 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:24:25.257504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:24:25.257504 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:24:25.303204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebe81ba1-f72e-411d-9624-1dc0a7f3723d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B525F39970>]}
[0m04:24:25.512674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebe81ba1-f72e-411d-9624-1dc0a7f3723d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B52A87ED20>]}
[0m04:24:25.512674 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:24:25.519478 [info ] [MainThread]: 
[0m04:24:25.519478 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:24:25.528504 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:24:25.696801 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:24:25.696801 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:24:25.696801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:24:25.712756 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m04:24:25.720974 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:24:25.720974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:24:25.720974 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:24:25.736485 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:25.736485 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:24:25.736485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:24:25.753056 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m04:24:25.753056 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:25.753056 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:24:25.753056 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:24:25.753056 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:25.753056 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:24:25.753056 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:24:25.753056 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:24:25.753056 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:24:25.753056 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:24:25.753056 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:24:25.753056 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:24:25.770961 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:24:25.770961 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:24:25.770961 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:24:25.770961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:24:25.787851 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m04:24:25.787851 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:24:25.787851 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:24:25.851797 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m04:24:25.854226 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:24:25.856155 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:24:25.856155 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:24:25.856155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebe81ba1-f72e-411d-9624-1dc0a7f3723d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B52A87EC60>]}
[0m04:24:25.856155 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:25.856155 [debug] [MainThread]: On master: BEGIN
[0m04:24:25.856155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:24:25.872660 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:24:25.872660 [debug] [MainThread]: On master: COMMIT
[0m04:24:25.872660 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:25.872660 [debug] [MainThread]: On master: COMMIT
[0m04:24:25.872660 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:24:25.872660 [debug] [MainThread]: On master: Close
[0m04:24:25.872660 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:24:25.872660 [info ] [MainThread]: 
[0m04:24:25.886244 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:24:25.887645 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:24:25.889432 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:24:25.887645 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:24:25.889432 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:24:25.889432 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:24:25.889432 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:24:25.889432 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:24:25.889432 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:24:25.889432 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:24:25.889432 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:24:25.902874 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:24:25.907742 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:24:25.907742 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:24:25.907742 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:24:25.911079 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:24:25.911079 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:24:25.953526 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:24:25.953526 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:24:25.953526 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:24:25.971080 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:24:25.971080 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:24:25.971080 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:24:25.971080 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:24:25.971080 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:24:25.971080 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:24:25.971080 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:24:25.971080 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:24:25.971080 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:24:25.971080 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:24:25.987487 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m04:24:25.987487 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m04:24:25.987487 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:24:25.987487 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m04:24:25.987487 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:24:25.987487 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw;
  );

[0m04:24:25.987487 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:24:25.987487 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw;
  );

[0m04:24:25.987487 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw;
  );

[0m04:24:25.987487 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw;
  );

[0m04:24:26.001085 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw;
  );

[0m04:24:26.001085 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:24:26.005373 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw;
  );

[0m04:24:26.005373 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:24:26.005373 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: ROLLBACK
[0m04:24:26.005373 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:24:26.005373 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: ROLLBACK
[0m04:24:26.005373 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: ROLLBACK
[0m04:24:26.030520 [debug] [Thread-2 (]: Failed to rollback 'model.meta_product_analytics.stg_events'
[0m04:24:26.030520 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:24:26.032535 [debug] [Thread-3 (]: Failed to rollback 'model.meta_product_analytics.stg_users'
[0m04:24:26.037630 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:24:26.037630 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.stg_content'
[0m04:24:26.037630 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:24:26.044999 [debug] [Thread-3 (]: Runtime Error in model stg_users (models\staging\stg_users.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:26.048542 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebe81ba1-f72e-411d-9624-1dc0a7f3723d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B528A19D60>]}
[0m04:24:26.054445 [debug] [Thread-2 (]: Runtime Error in model stg_events (models\staging\stg_events.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:26.056142 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebe81ba1-f72e-411d-9624-1dc0a7f3723d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B52AF736B0>]}
[0m04:24:26.056142 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.16s]
[0m04:24:26.056142 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.17s]
[0m04:24:26.056142 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:24:26.056142 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:24:26.064552 [debug] [Thread-1 (]: Runtime Error in model stg_content (models\staging\stg_content.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:26.064552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebe81ba1-f72e-411d-9624-1dc0a7f3723d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B52AF72D50>]}
[0m04:24:26.070580 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_users
[0m04:24:26.073724 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:24:26.070580 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_content .......................... [[31mERROR[0m in 0.18s]
[0m04:24:26.073724 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.dim_users ............................................ [[33mSKIP[0m]
[0m04:24:26.077956 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:24:26.077956 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:24:26.075944 [info ] [Thread-3 (]: 5 of 7 SKIP relation main.fct_product_events ................................... [[33mSKIP[0m]
[0m04:24:26.079971 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:24:26.081993 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.dim_content
[0m04:24:26.081993 [info ] [Thread-3 (]: 6 of 7 SKIP relation main.dim_content .......................................... [[33mSKIP[0m]
[0m04:24:26.084005 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:24:26.084005 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:24:26.086019 [info ] [Thread-1 (]: 7 of 7 SKIP relation main.agg_product_kpis ..................................... [[33mSKIP[0m]
[0m04:24:26.088038 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:24:26.089890 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:26.089890 [debug] [MainThread]: On master: BEGIN
[0m04:24:26.093186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:24:26.106350 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m04:24:26.106350 [debug] [MainThread]: On master: COMMIT
[0m04:24:26.106350 [debug] [MainThread]: Using duckdb connection "master"
[0m04:24:26.106350 [debug] [MainThread]: On master: COMMIT
[0m04:24:26.106350 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:24:26.106350 [debug] [MainThread]: On master: Close
[0m04:24:26.112974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:24:26.114831 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:24:26.114831 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:24:26.114831 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_content' was properly closed.
[0m04:24:26.114831 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_events' was properly closed.
[0m04:24:26.114831 [debug] [MainThread]: Connection 'model.meta_product_analytics.stg_users' was properly closed.
[0m04:24:26.114831 [info ] [MainThread]: 
[0m04:24:26.114831 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m04:24:26.120649 [debug] [MainThread]: Command end result
[0m04:24:26.156874 [info ] [MainThread]: 
[0m04:24:26.158736 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m04:24:26.158736 [info ] [MainThread]: 
[0m04:24:26.158736 [error] [MainThread]:   Runtime Error in model stg_users (models\staging\stg_users.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:26.158736 [info ] [MainThread]: 
[0m04:24:26.158736 [error] [MainThread]:   Runtime Error in model stg_events (models\staging\stg_events.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:26.158736 [info ] [MainThread]: 
[0m04:24:26.158736 [error] [MainThread]:   Runtime Error in model stg_content (models\staging\stg_content.sql)
  Parser Error: syntax error at or near ";"
[0m04:24:26.158736 [info ] [MainThread]: 
[0m04:24:26.165040 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m04:24:26.165040 [debug] [MainThread]: Command `dbt build` failed at 04:24:26.165040 after 2.29 seconds
[0m04:24:26.165040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5294D0A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B529178920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B52917A4E0>]}
[0m04:24:26.165040 [debug] [MainThread]: Flushing usage events
[0m04:27:46.282201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033110A030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032DEADDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020330E18BF0>]}


============================== 04:27:46.292061 | d8b50744-2e68-4516-b372-1e74c8deaa20 ==============================
[0m04:27:46.292061 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:27:46.292061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:27:46.567568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203314DA450>]}
[0m04:27:46.646643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203310C7830>]}
[0m04:27:46.646643 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:27:46.968613 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:27:47.139965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m04:27:47.141984 [debug] [MainThread]: Partial parsing: updated file: meta_product_analytics://models\staging\stg_events.sql
[0m04:27:47.141984 [debug] [MainThread]: Partial parsing: updated file: meta_product_analytics://models\staging\stg_users.sql
[0m04:27:47.141984 [debug] [MainThread]: Partial parsing: updated file: meta_product_analytics://models\staging\stg_content.sql
[0m04:27:47.406649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203325D3830>]}
[0m04:27:47.522479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020332AA0AD0>]}
[0m04:27:47.522479 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:27:47.537467 [info ] [MainThread]: 
[0m04:27:47.537467 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:27:47.545133 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:27:47.644731 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:27:47.644731 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:27:47.646743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:27:47.654531 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m04:27:47.661310 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:27:47.664288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:27:47.664288 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:27:47.664288 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:27:47.664288 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:27:47.664288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:47.680241 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m04:27:47.685469 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:27:47.685469 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:27:47.685469 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:27:47.685469 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:27:47.685469 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:27:47.687481 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:27:47.687481 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:27:47.687481 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:27:47.689495 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:27:47.689495 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:27:47.689495 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:27:47.693582 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:27:47.700785 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:27:47.700785 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:27:47.702800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:27:47.711866 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m04:27:47.711866 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:27:47.711866 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:27:47.749664 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m04:27:47.751677 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:27:47.753692 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:27:47.753692 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:27:47.757801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020332A0F800>]}
[0m04:27:47.757801 [debug] [MainThread]: Using duckdb connection "master"
[0m04:27:47.757801 [debug] [MainThread]: On master: BEGIN
[0m04:27:47.759576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:27:47.759576 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:27:47.759576 [debug] [MainThread]: On master: COMMIT
[0m04:27:47.759576 [debug] [MainThread]: Using duckdb connection "master"
[0m04:27:47.759576 [debug] [MainThread]: On master: COMMIT
[0m04:27:47.759576 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:27:47.759576 [debug] [MainThread]: On master: Close
[0m04:27:47.759576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:27:47.772775 [info ] [MainThread]: 
[0m04:27:47.775375 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:27:47.775375 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:27:47.784487 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:27:47.775375 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:27:47.784487 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:27:47.784487 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:27:47.793758 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:27:47.784487 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:27:47.793758 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:27:47.800147 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:27:47.802160 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:27:47.784487 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:27:47.802160 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:27:47.802160 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:27:47.806904 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:27:47.808921 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:27:47.838692 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:27:47.854658 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:27:47.858399 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:27:47.858399 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:27:47.862284 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:27:47.864296 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:27:47.864296 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:27:47.864296 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:27:47.866954 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:27:47.867991 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:27:47.867991 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:27:47.867991 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:27:47.867991 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:27:47.867991 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:27:47.875045 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m04:27:47.875045 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:27:47.875045 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw
  );

[0m04:27:47.875045 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m04:27:47.875045 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:27:47.875045 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw
  );

[0m04:27:47.881716 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m04:27:47.889785 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:27:47.891803 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m04:27:47.891803 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m04:27:47.893838 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:27:47.893838 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m04:27:47.893838 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m04:27:47.893838 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:27:47.893838 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw
  );

[0m04:27:47.893838 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m04:27:47.917503 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:27:47.917503 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:27:47.917503 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m04:27:47.917503 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:27:47.917503 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m04:27:47.921986 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:27:47.921986 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:27:47.921986 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content__dbt_tmp" rename to "stg_content"
[0m04:27:47.921986 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:27:47.921986 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:27:47.927162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:27:47.928173 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:27:47.929709 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:27:47.929709 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:27:47.933527 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m04:27:47.939849 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:27:47.939849 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
drop view if exists "warehouse"."main"."stg_events__dbt_backup" cascade
[0m04:27:47.939849 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m04:27:47.939849 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m04:27:47.944141 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:27:47.944141 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:27:47.944141 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
drop view if exists "warehouse"."main"."stg_users__dbt_backup" cascade
[0m04:27:47.944141 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m04:27:47.948796 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
drop view if exists "warehouse"."main"."stg_content__dbt_backup" cascade
[0m04:27:47.948796 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:27:47.948796 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m04:27:47.948796 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203314FC500>]}
[0m04:27:47.948796 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:27:47.948796 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m04:27:47.948796 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203330988C0>]}
[0m04:27:47.948796 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.16s]
[0m04:27:47.948796 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:27:47.948796 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:27:47.948796 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.15s]
[0m04:27:47.966643 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:27:47.968662 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_users
[0m04:27:47.968662 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:27:47.968662 [info ] [Thread-4 (]: 4 of 7 START sql table model main.dim_users .................................... [RUN]
[0m04:27:47.972552 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.meta_product_analytics.dim_users'
[0m04:27:47.968662 [info ] [Thread-2 (]: 5 of 7 START sql table model main.fct_product_events ........................... [RUN]
[0m04:27:47.972552 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_users
[0m04:27:47.974773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203330980B0>]}
[0m04:27:47.974773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now model.meta_product_analytics.fct_product_events)
[0m04:27:48.076822 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m04:27:48.076822 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m04:27:48.093930 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m04:27:48.076822 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_content .............................. [[32mOK[0m in 0.19s]
[0m04:27:48.093930 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:27:48.099728 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m04:27:48.122876 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.fct_product_events"
[0m04:27:48.122876 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.dim_content
[0m04:27:48.134475 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_users
[0m04:27:48.138807 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:27:48.134475 [info ] [Thread-3 (]: 6 of 7 START sql table model main.dim_content .................................. [RUN]
[0m04:27:48.140029 [debug] [Thread-4 (]: Writing runtime sql for node "model.meta_product_analytics.dim_users"
[0m04:27:48.140029 [debug] [Thread-2 (]: On model.meta_product_analytics.fct_product_events: BEGIN
[0m04:27:48.140029 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now model.meta_product_analytics.dim_content)
[0m04:27:48.140029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:27:48.140029 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.dim_content
[0m04:27:48.151005 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m04:27:48.140029 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:27:48.154347 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: BEGIN
[0m04:27:48.155374 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:27:48.160041 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.dim_content
[0m04:27:48.168202 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.dim_content"
[0m04:27:48.170220 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:27:48.170220 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: BEGIN
[0m04:27:48.172238 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:27:48.175499 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m04:27:48.175499 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:27:48.175499 [debug] [Thread-4 (]: SQL status: OK in 0.023 seconds
[0m04:27:48.175499 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */

  
    
    

    create  table
      "warehouse"."main"."dim_content__dbt_tmp"
  
    as (
      with c as (select * from "warehouse"."main"."stg_content")
select * from c
    );
  
  
[0m04:27:48.175499 [debug] [Thread-2 (]: SQL status: OK in 0.033 seconds
[0m04:27:48.175499 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:27:48.175499 [debug] [Thread-2 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */

  
    
    

    create  table
      "warehouse"."main"."fct_product_events__dbt_tmp"
  
    as (
      with e as (select * from "warehouse"."main"."stg_events")
select * from e
    );
  
  
[0m04:27:48.175499 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:27:48.175499 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */

  
    
    

    create  table
      "warehouse"."main"."dim_users__dbt_tmp"
  
    as (
      with u as (select * from "warehouse"."main"."stg_users")
select * from u
    );
  
  
[0m04:27:48.186018 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m04:27:48.186018 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:27:48.186018 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content__dbt_tmp" rename to "dim_content"
[0m04:27:48.186018 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m04:27:48.193947 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:27:48.193947 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m04:27:48.193947 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users__dbt_tmp" rename to "dim_users"
[0m04:27:48.193947 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m04:27:48.198252 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:27:48.206062 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:27:48.206062 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m04:27:48.206062 [debug] [Thread-2 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events__dbt_tmp" rename to "fct_product_events"
[0m04:27:48.206062 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:27:48.206062 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:27:48.210493 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:27:48.210493 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:27:48.210493 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:27:48.210493 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m04:27:48.213957 [debug] [Thread-2 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:27:48.213957 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:27:48.213957 [debug] [Thread-2 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:27:48.213957 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m04:27:48.219907 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:27:48.219907 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m04:27:48.219907 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
drop table if exists "warehouse"."main"."dim_content__dbt_backup" cascade
[0m04:27:48.219907 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m04:27:48.224026 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:27:48.228017 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:27:48.228017 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
drop table if exists "warehouse"."main"."dim_users__dbt_backup" cascade
[0m04:27:48.228017 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m04:27:48.228017 [debug] [Thread-2 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
drop table if exists "warehouse"."main"."fct_product_events__dbt_backup" cascade
[0m04:27:48.228017 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: Close
[0m04:27:48.232187 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020332C26270>]}
[0m04:27:48.233925 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m04:27:48.232187 [info ] [Thread-3 (]: 6 of 7 OK created sql table model main.dim_content ............................. [[32mOK[0m in 0.09s]
[0m04:27:48.233925 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: Close
[0m04:27:48.233925 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m04:27:48.233925 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:27:48.233925 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020332C24FB0>]}
[0m04:27:48.233925 [debug] [Thread-2 (]: On model.meta_product_analytics.fct_product_events: Close
[0m04:27:48.233925 [info ] [Thread-4 (]: 4 of 7 OK created sql table model main.dim_users ............................... [[32mOK[0m in 0.27s]
[0m04:27:48.233925 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:27:48.255937 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020332FE75C0>]}
[0m04:27:48.257951 [info ] [Thread-2 (]: 5 of 7 OK created sql table model main.fct_product_events ...................... [[32mOK[0m in 0.28s]
[0m04:27:48.257951 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:27:48.259964 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:27:48.259964 [info ] [Thread-1 (]: 7 of 7 START sql table model main.agg_product_kpis ............................. [RUN]
[0m04:27:48.262167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now model.meta_product_analytics.agg_product_kpis)
[0m04:27:48.262167 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m04:27:48.267704 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m04:27:48.267704 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m04:27:48.273748 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.agg_product_kpis"
[0m04:27:48.275762 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:27:48.275762 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: BEGIN
[0m04:27:48.275762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:27:48.297375 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m04:27:48.301094 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:27:48.301094 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */

  
    
    

    create  table
      "warehouse"."main"."agg_product_kpis__dbt_tmp"
  
    as (
      with e as (select * from "warehouse"."main"."fct_product_events"),
u as (select * from "warehouse"."main"."dim_users")
select
  event_date,
  count(distinct case when event_type='session_start' then user_id end) as dau,
  count(distinct user_id) filter (where event_type='follow') as daily_followers,
  count(*) filter (where event_type='impression') as impressions,
  count(*) filter (where event_type='like') as likes,
  (count(*) filter (where event_type='like'))::double / nullif((count(*) filter (where event_type='impression')),0) as like_rate
from e
group by 1
order by 1
    );
  
  
[0m04:27:48.303109 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */

  
    
    

    create  table
      "warehouse"."main"."agg_product_kpis__dbt_tmp"
  
    as (
      with e as (select * from "warehouse"."main"."fct_product_events"),
u as (select * from "warehouse"."main"."dim_users")
select
  event_date,
  count(distinct case when event_type='session_start' then user_id end) as dau,
  count(distinct user_id) filter (where event_type='follow') as daily_followers,
  count(*) filter (where event_type='impression') as impressions,
  count(*) filter (where event_type='like') as likes,
  (count(*) filter (where event_type='like'))::double / nullif((count(*) filter (where event_type='impression')),0) as like_rate
from e
group by 1
order by 1
    );
  
  
[0m04:27:48.303109 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:27:48.303109 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: ROLLBACK
[0m04:27:48.309144 [debug] [Thread-1 (]: Failed to rollback 'model.meta_product_analytics.agg_product_kpis'
[0m04:27:48.311157 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: Close
[0m04:27:48.315190 [debug] [Thread-1 (]: Runtime Error in model agg_product_kpis (models\marts\agg_product_kpis.sql)
  Binder Error: Referenced column "event_date" not found in FROM clause!
  Candidate bindings: "e.event_type", "e.event_id", "e.event_ts", "e.user_id", "e.content_id"
  LINE 14:   event_date,
             ^
[0m04:27:48.315190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b50744-2e68-4516-b372-1e74c8deaa20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203329CBA70>]}
[0m04:27:48.315190 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model main.agg_product_kpis .................... [[31mERROR[0m in 0.05s]
[0m04:27:48.315190 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:27:48.319276 [debug] [MainThread]: Using duckdb connection "master"
[0m04:27:48.319276 [debug] [MainThread]: On master: BEGIN
[0m04:27:48.319276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:27:48.329013 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:27:48.329013 [debug] [MainThread]: On master: COMMIT
[0m04:27:48.329013 [debug] [MainThread]: Using duckdb connection "master"
[0m04:27:48.329013 [debug] [MainThread]: On master: COMMIT
[0m04:27:48.329013 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:27:48.329013 [debug] [MainThread]: On master: Close
[0m04:27:48.336392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:27:48.336392 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:27:48.336392 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:27:48.336392 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m04:27:48.336392 [debug] [MainThread]: Connection 'model.meta_product_analytics.fct_product_events' was properly closed.
[0m04:27:48.336392 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_content' was properly closed.
[0m04:27:48.336392 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_users' was properly closed.
[0m04:27:48.336392 [info ] [MainThread]: 
[0m04:27:48.336392 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m04:27:48.336392 [debug] [MainThread]: Command end result
[0m04:27:48.376523 [info ] [MainThread]: 
[0m04:27:48.380543 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:27:48.384572 [info ] [MainThread]: 
[0m04:27:48.386587 [error] [MainThread]:   Runtime Error in model agg_product_kpis (models\marts\agg_product_kpis.sql)
  Binder Error: Referenced column "event_date" not found in FROM clause!
  Candidate bindings: "e.event_type", "e.event_id", "e.event_ts", "e.user_id", "e.content_id"
  LINE 14:   event_date,
             ^
[0m04:27:48.386587 [info ] [MainThread]: 
[0m04:27:48.386587 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m04:27:48.386587 [debug] [MainThread]: Command `dbt build` failed at 04:27:48.386587 after 2.29 seconds
[0m04:27:48.386587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020330F10B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033078E6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020330505130>]}
[0m04:27:48.392547 [debug] [MainThread]: Flushing usage events
[0m04:30:34.454879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10D49BB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10C5DED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10D499280>]}


============================== 04:30:34.454879 | 622953cb-1305-4eb1-aebc-957efeff776b ==============================
[0m04:30:34.454879 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:30:34.465022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:30:34.744401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10D0E1820>]}
[0m04:30:34.818233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10D8789B0>]}
[0m04:30:34.819991 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:30:35.148857 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:30:35.314969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:30:35.314969 [debug] [MainThread]: Partial parsing: updated file: meta_product_analytics://models\marts\agg_product_kpis.sql
[0m04:30:35.580556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10EEBF830>]}
[0m04:30:35.707324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10EE88AA0>]}
[0m04:30:35.707324 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:30:35.714972 [info ] [MainThread]: 
[0m04:30:35.714972 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:30:35.723238 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:30:35.828594 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:30:35.828594 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:30:35.830617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:35.840548 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m04:30:35.840548 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:30:35.848349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:30:35.850404 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:30:35.858456 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:30:35.858456 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:30:35.858456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:30:35.867791 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m04:30:35.872235 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:30:35.872235 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:30:35.872235 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:30:35.872235 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:30:35.872235 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:30:35.874248 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:30:35.874248 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:30:35.874248 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:30:35.874248 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:30:35.876261 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:30:35.876261 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:30:35.876261 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:30:35.887215 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:30:35.887215 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:30:35.887215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:35.897844 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m04:30:35.897844 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:30:35.897844 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:30:35.929778 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m04:30:35.929778 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:30:35.929778 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:30:35.929778 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:30:35.945643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10D82FA70>]}
[0m04:30:35.947655 [debug] [MainThread]: Using duckdb connection "master"
[0m04:30:35.947655 [debug] [MainThread]: On master: BEGIN
[0m04:30:35.947655 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:30:35.957711 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:30:35.957711 [debug] [MainThread]: On master: COMMIT
[0m04:30:35.957711 [debug] [MainThread]: Using duckdb connection "master"
[0m04:30:35.957711 [debug] [MainThread]: On master: COMMIT
[0m04:30:35.959724 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:30:35.959724 [debug] [MainThread]: On master: Close
[0m04:30:35.961479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:30:35.961479 [info ] [MainThread]: 
[0m04:30:35.964752 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:30:35.964752 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:30:35.964752 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:30:35.964752 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:30:35.964752 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:30:35.977592 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:30:35.964752 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:30:35.977592 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:30:35.977592 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:30:35.977592 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:30:35.977592 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:30:35.985187 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:30:35.985187 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:30:35.991311 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:30:35.993370 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:30:35.995386 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:30:36.024816 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:30:36.046794 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:30:36.050030 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:30:36.050030 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:30:36.050030 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:30:36.050030 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:36.050030 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:30:36.056547 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:30:36.056547 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:36.056547 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:30:36.056547 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:30:36.059106 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:36.059106 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:30:36.059106 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:30:36.067167 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m04:30:36.067167 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:36.067167 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw
  );

[0m04:30:36.067167 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m04:30:36.067167 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:36.067167 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw
  );

[0m04:30:36.070840 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m04:30:36.070840 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:36.070840 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw
  );

[0m04:30:36.072579 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m04:30:36.081309 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:36.083323 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m04:30:36.083323 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m04:30:36.083323 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:36.088345 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content" rename to "stg_content__dbt_backup"
[0m04:30:36.088345 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m04:30:36.090743 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:36.092756 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m04:30:36.092756 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m04:30:36.092756 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:36.092756 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m04:30:36.092756 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m04:30:36.092756 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content__dbt_tmp" rename to "stg_content"
[0m04:30:36.092756 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:36.104928 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:36.104928 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m04:30:36.104928 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m04:30:36.104928 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m04:30:36.120188 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:30:36.120188 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m04:30:36.120188 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:36.120188 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m04:30:36.120188 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:30:36.120188 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:30:36.120188 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:30:36.120188 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:36.135917 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:30:36.120188 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:36.137864 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:30:36.143550 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m04:30:36.151893 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:36.151893 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m04:30:36.151893 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
drop view if exists "warehouse"."main"."stg_content__dbt_backup" cascade
[0m04:30:36.151893 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m04:30:36.259198 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:36.263202 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:36.265224 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
drop view if exists "warehouse"."main"."stg_users__dbt_backup" cascade
[0m04:30:36.265224 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
drop view if exists "warehouse"."main"."stg_events__dbt_backup" cascade
[0m04:30:36.273183 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m04:30:36.282779 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:30:36.283292 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m04:30:36.283292 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m04:30:36.283292 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:30:36.283292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10CD065A0>]}
[0m04:30:36.283292 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:30:36.283292 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10ED4EAE0>]}
[0m04:30:36.283292 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_content .............................. [[32mOK[0m in 0.32s]
[0m04:30:36.294544 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:30:36.292812 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.31s]
[0m04:30:36.296492 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:30:36.298504 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_content
[0m04:30:36.302531 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.dim_users
[0m04:30:36.300518 [info ] [Thread-4 (]: 4 of 7 START sql table model main.dim_content .................................. [RUN]
[0m04:30:36.303686 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10F451610>]}
[0m04:30:36.303686 [info ] [Thread-1 (]: 5 of 7 START sql table model main.dim_users .................................... [RUN]
[0m04:30:36.303686 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.meta_product_analytics.dim_content'
[0m04:30:36.306645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now model.meta_product_analytics.dim_users)
[0m04:30:36.305702 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.33s]
[0m04:30:36.306645 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_content
[0m04:30:36.308657 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.dim_users
[0m04:30:36.308657 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:30:36.312310 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m04:30:36.316350 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m04:30:36.316350 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:30:36.320666 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_content
[0m04:30:36.316350 [info ] [Thread-3 (]: 6 of 7 START sql table model main.fct_product_events ........................... [RUN]
[0m04:30:36.343737 [debug] [Thread-4 (]: Writing runtime sql for node "model.meta_product_analytics.dim_content"
[0m04:30:36.343737 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now model.meta_product_analytics.fct_product_events)
[0m04:30:36.343737 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.dim_users
[0m04:30:36.343737 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m04:30:36.343737 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.dim_users"
[0m04:30:36.354153 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m04:30:36.356167 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:36.357179 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:36.359200 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_content: BEGIN
[0m04:30:36.359200 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: BEGIN
[0m04:30:36.360225 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:30:36.360952 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m04:30:36.360952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:30:36.365902 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.fct_product_events"
[0m04:30:36.365902 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:36.367916 [debug] [Thread-3 (]: On model.meta_product_analytics.fct_product_events: BEGIN
[0m04:30:36.367916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:30:36.383884 [debug] [Thread-4 (]: SQL status: OK in 0.025 seconds
[0m04:30:36.383884 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m04:30:36.383884 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:36.383884 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:36.383884 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m04:30:36.383884 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */

  
    
    

    create  table
      "warehouse"."main"."dim_content__dbt_tmp"
  
    as (
      with c as (select * from "warehouse"."main"."stg_content")
select * from c
    );
  
  
[0m04:30:36.388629 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */

  
    
    

    create  table
      "warehouse"."main"."dim_users__dbt_tmp"
  
    as (
      with u as (select * from "warehouse"."main"."stg_users")
select * from u
    );
  
  
[0m04:30:36.388629 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:36.388629 [debug] [Thread-3 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */

  
    
    

    create  table
      "warehouse"."main"."fct_product_events__dbt_tmp"
  
    as (
      with e as (select * from "warehouse"."main"."stg_events")
select * from e
    );
  
  
[0m04:30:36.393305 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m04:30:36.397335 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:36.397335 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content" rename to "dim_content__dbt_backup"
[0m04:30:36.397335 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m04:30:36.397335 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:36.397335 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users" rename to "dim_users__dbt_backup"
[0m04:30:36.397335 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m04:30:36.406304 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m04:30:36.406304 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:36.410179 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:36.410179 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m04:30:36.410179 [debug] [Thread-3 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events" rename to "fct_product_events__dbt_backup"
[0m04:30:36.410179 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content__dbt_tmp" rename to "dim_content"
[0m04:30:36.410179 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:36.410179 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m04:30:36.410179 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m04:30:36.410179 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users__dbt_tmp" rename to "dim_users"
[0m04:30:36.422086 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:36.422086 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:30:36.422086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:30:36.422086 [debug] [Thread-3 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events__dbt_tmp" rename to "fct_product_events"
[0m04:30:36.422086 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:36.422086 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:30:36.433839 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:30:36.433839 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:36.435853 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:30:36.433839 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m04:30:36.438205 [debug] [Thread-3 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:30:36.439227 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:36.439227 [debug] [Thread-3 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:30:36.443910 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m04:30:36.443910 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:36.443910 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
drop table if exists "warehouse"."main"."dim_content__dbt_backup" cascade
[0m04:30:36.443910 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m04:30:36.452280 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:36.454291 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
drop table if exists "warehouse"."main"."dim_users__dbt_backup" cascade
[0m04:30:36.454291 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m04:30:36.454291 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:36.454291 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m04:30:36.454291 [debug] [Thread-3 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
drop table if exists "warehouse"."main"."fct_product_events__dbt_backup" cascade
[0m04:30:36.454291 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_content: Close
[0m04:30:36.454291 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m04:30:36.454291 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10ED4D8E0>]}
[0m04:30:36.454291 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: Close
[0m04:30:36.464066 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m04:30:36.464066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10F414EC0>]}
[0m04:30:36.464066 [info ] [Thread-4 (]: 4 of 7 OK created sql table model main.dim_content ............................. [[32mOK[0m in 0.15s]
[0m04:30:36.467903 [debug] [Thread-3 (]: On model.meta_product_analytics.fct_product_events: Close
[0m04:30:36.467903 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:30:36.467903 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main.dim_users ............................... [[32mOK[0m in 0.16s]
[0m04:30:36.467903 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:30:36.485672 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10E997320>]}
[0m04:30:36.485672 [info ] [Thread-3 (]: 6 of 7 OK created sql table model main.fct_product_events ...................... [[32mOK[0m in 0.14s]
[0m04:30:36.487686 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:30:36.489699 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:30:36.489699 [info ] [Thread-2 (]: 7 of 7 START sql table model main.agg_product_kpis ............................. [RUN]
[0m04:30:36.489699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now model.meta_product_analytics.agg_product_kpis)
[0m04:30:36.492055 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m04:30:36.492055 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m04:30:36.492055 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m04:30:36.502617 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.agg_product_kpis"
[0m04:30:36.504640 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:30:36.504640 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: BEGIN
[0m04:30:36.504640 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:30:36.528732 [debug] [Thread-2 (]: SQL status: OK in 0.024 seconds
[0m04:30:36.530474 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:30:36.530474 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */

  
    
    

    create  table
      "warehouse"."main"."agg_product_kpis__dbt_tmp"
  
    as (
      with e as (
    select
        event_id,
        user_id,
        content_id,
        event_type,
        cast(event_ts as timestamp) as event_ts,
        cast(event_ts as date) as event_date
    from "warehouse"."main"."fct_product_events"
),
a as (
    select * from "warehouse"."main"."dim_users"
)
select
    event_date,
    count(distinct case when event_type = 'session_start' then user_id end) as dau,
    count(distinct user_id) filter (where event_type = 'follow') as daily_followers,
    count(*) filter (where event_type = 'impression') as impressions,
    count(*) filter (where event_type = 'like') as likes,
    (count(*) filter (where event_type = 'like'))::double 
        / nullif((count(*) filter (where event_type = 'impression')), 0) as like_rate
from e
group by event_date
order by event_date
    );
  
  
[0m04:30:36.536511 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m04:30:36.540535 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:30:36.540535 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis__dbt_tmp" rename to "agg_product_kpis"
[0m04:30:36.542546 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m04:30:36.542546 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m04:30:36.544559 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:30:36.544559 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m04:30:36.546315 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m04:30:36.546315 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:30:36.546315 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
drop table if exists "warehouse"."main"."agg_product_kpis__dbt_backup" cascade
[0m04:30:36.546315 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m04:30:36.546315 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: Close
[0m04:30:36.560191 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '622953cb-1305-4eb1-aebc-957efeff776b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10F402030>]}
[0m04:30:36.560191 [info ] [Thread-2 (]: 7 of 7 OK created sql table model main.agg_product_kpis ........................ [[32mOK[0m in 0.07s]
[0m04:30:36.563161 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:30:36.566637 [debug] [MainThread]: Using duckdb connection "master"
[0m04:30:36.566637 [debug] [MainThread]: On master: BEGIN
[0m04:30:36.566637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:30:36.591862 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m04:30:36.591862 [debug] [MainThread]: On master: COMMIT
[0m04:30:36.591862 [debug] [MainThread]: Using duckdb connection "master"
[0m04:30:36.591862 [debug] [MainThread]: On master: COMMIT
[0m04:30:36.594266 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:30:36.594266 [debug] [MainThread]: On master: Close
[0m04:30:36.594266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:30:36.597401 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:30:36.597401 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:30:36.597401 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_users' was properly closed.
[0m04:30:36.597401 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m04:30:36.597401 [debug] [MainThread]: Connection 'model.meta_product_analytics.fct_product_events' was properly closed.
[0m04:30:36.597401 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_content' was properly closed.
[0m04:30:36.600431 [info ] [MainThread]: 
[0m04:30:36.600431 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m04:30:36.600431 [debug] [MainThread]: Command end result
[0m04:30:36.638468 [info ] [MainThread]: 
[0m04:30:36.639536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:30:36.642069 [info ] [MainThread]: 
[0m04:30:36.642069 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m04:30:36.642069 [debug] [MainThread]: Command `dbt build` succeeded at 04:30:36.642069 after 2.38 seconds
[0m04:30:36.642069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10D50D100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10EE88B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10E9724E0>]}
[0m04:30:36.642069 [debug] [MainThread]: Flushing usage events
[0m04:30:46.131518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A13E0A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A15D9DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A15D9E0F0>]}


============================== 04:30:46.140433 | 14815265-d98c-4e6c-bf5c-f21916894f28 ==============================
[0m04:30:46.140433 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:30:49.239732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:30:49.634259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A16D8A210>]}
[0m04:30:49.746287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A13FACFE0>]}
[0m04:30:49.746287 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:30:50.128754 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:30:50.267761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:30:50.267761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:30:50.312570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A17F801D0>]}
[0m04:30:50.460458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1828B140>]}
[0m04:30:50.460458 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:30:50.472197 [info ] [MainThread]: 
[0m04:30:50.474215 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:30:50.483328 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:30:50.588761 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:30:50.588761 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:30:50.588761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:50.614765 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m04:30:50.617137 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:30:50.621220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:30:50.621220 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:30:50.634630 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:30:50.634630 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:30:50.634630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:30:50.642699 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m04:30:50.648680 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:30:50.648680 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:30:50.648680 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:30:50.648680 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:30:50.648680 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:30:50.648680 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:30:50.648680 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:30:50.648680 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:30:50.648680 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:30:50.648680 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:30:50.648680 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:30:50.648680 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:30:50.666452 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:30:50.666452 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:30:50.666452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:50.678976 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m04:30:50.680496 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:30:50.680496 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:30:50.729834 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m04:30:50.731849 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:30:50.733868 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:30:50.733868 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:30:50.733868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A16E19B50>]}
[0m04:30:50.733868 [debug] [MainThread]: Using duckdb connection "master"
[0m04:30:50.733868 [debug] [MainThread]: On master: BEGIN
[0m04:30:50.733868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:30:50.743754 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m04:30:50.743754 [debug] [MainThread]: On master: COMMIT
[0m04:30:50.743754 [debug] [MainThread]: Using duckdb connection "master"
[0m04:30:50.743754 [debug] [MainThread]: On master: COMMIT
[0m04:30:50.743754 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:30:50.743754 [debug] [MainThread]: On master: Close
[0m04:30:50.743754 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:30:50.743754 [info ] [MainThread]: 
[0m04:30:50.760752 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:30:50.760752 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:30:50.766960 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:30:50.766960 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:30:50.766960 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:30:50.766960 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:30:50.766960 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:30:50.766960 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:30:50.766960 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:30:50.766960 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:30:50.766960 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:30:50.781122 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:30:50.784635 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:30:50.784635 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:30:50.787795 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:30:50.787795 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:30:50.789811 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:30:50.806580 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:30:50.838375 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:30:50.838375 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:30:50.838375 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:30:50.854752 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:50.854752 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:30:50.854752 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:30:50.856668 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:50.856668 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:30:50.856668 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:30:50.856668 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:50.858681 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:30:50.858681 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:30:50.858681 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m04:30:50.858681 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m04:30:50.858681 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m04:30:50.858681 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:50.858681 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:50.858681 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:50.869975 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw
  );

[0m04:30:50.869975 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw
  );

[0m04:30:50.869975 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw
  );

[0m04:30:50.876518 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m04:30:50.886069 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:50.886069 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content" rename to "stg_content__dbt_backup"
[0m04:30:50.886069 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m04:30:50.886069 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:50.886069 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m04:30:50.886069 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m04:30:50.886069 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m04:30:50.886069 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:50.886069 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m04:30:50.902131 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m04:30:50.904859 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:50.904859 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:50.904859 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content__dbt_tmp" rename to "stg_content"
[0m04:30:50.911385 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m04:30:50.911385 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m04:30:50.911385 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:50.911385 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m04:30:50.918104 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m04:30:50.934185 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m04:30:50.934185 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:30:50.950266 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:50.950266 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:30:50.950266 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:30:50.950266 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:50.950266 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:30:50.950266 [debug] [Thread-3 (]: SQL status: OK in 0.035 seconds
[0m04:30:50.957213 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:30:50.957213 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:50.957213 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:30:50.963812 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m04:30:50.969707 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:30:50.969707 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
drop view if exists "warehouse"."main"."stg_events__dbt_backup" cascade
[0m04:30:50.969707 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m04:30:50.974212 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:30:50.974212 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
drop view if exists "warehouse"."main"."stg_content__dbt_backup" cascade
[0m04:30:50.974212 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m04:30:50.974212 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:30:50.974212 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
drop view if exists "warehouse"."main"."stg_users__dbt_backup" cascade
[0m04:30:50.974212 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m04:30:50.983719 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:30:50.985732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A14337860>]}
[0m04:30:50.985732 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m04:30:50.990647 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:30:50.990647 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m04:30:50.985732 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.22s]
[0m04:30:50.990647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A18794710>]}
[0m04:30:50.990647 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:30:50.990647 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_content .............................. [[32mOK[0m in 0.22s]
[0m04:30:50.990647 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:30:50.999667 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:30:50.999667 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:30:50.999667 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.dim_content
[0m04:30:50.999667 [info ] [Thread-4 (]: 4 of 7 START sql table model main.fct_product_events ........................... [RUN]
[0m04:30:51.005369 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.meta_product_analytics.fct_product_events'
[0m04:30:51.007381 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m04:30:51.007381 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A183D35C0>]}
[0m04:30:51.011497 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m04:30:51.005369 [info ] [Thread-1 (]: 5 of 7 START sql table model main.dim_content .................................. [RUN]
[0m04:30:51.013509 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.24s]
[0m04:30:51.017533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now model.meta_product_analytics.dim_content)
[0m04:30:51.017533 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:30:51.019545 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.dim_content
[0m04:30:51.020275 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m04:30:51.023358 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m04:30:51.023358 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.dim_users
[0m04:30:51.052375 [debug] [Thread-4 (]: Writing runtime sql for node "model.meta_product_analytics.fct_product_events"
[0m04:30:51.052375 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.dim_content
[0m04:30:51.052375 [info ] [Thread-2 (]: 6 of 7 START sql table model main.dim_users .................................... [RUN]
[0m04:30:51.067013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now model.meta_product_analytics.dim_users)
[0m04:30:51.069025 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.dim_users
[0m04:30:51.062983 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.dim_content"
[0m04:30:51.067013 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:51.072086 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m04:30:51.072654 [debug] [Thread-4 (]: On model.meta_product_analytics.fct_product_events: BEGIN
[0m04:30:51.073761 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:30:51.073761 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:51.075779 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: BEGIN
[0m04:30:51.075779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:30:51.077589 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.dim_users
[0m04:30:51.082518 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.dim_users"
[0m04:30:51.084538 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:51.084538 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_users: BEGIN
[0m04:30:51.084538 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:30:51.095082 [debug] [Thread-4 (]: SQL status: OK in 0.027 seconds
[0m04:30:51.095082 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m04:30:51.095082 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:51.095082 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m04:30:51.095082 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:51.095082 [debug] [Thread-4 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */

  
    
    

    create  table
      "warehouse"."main"."fct_product_events__dbt_tmp"
  
    as (
      with e as (select * from "warehouse"."main"."stg_events")
select * from e
    );
  
  
[0m04:30:51.095082 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:51.095082 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */

  
    
    

    create  table
      "warehouse"."main"."dim_users__dbt_tmp"
  
    as (
      with u as (select * from "warehouse"."main"."stg_users")
select * from u
    );
  
  
[0m04:30:51.095082 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */

  
    
    

    create  table
      "warehouse"."main"."dim_content__dbt_tmp"
  
    as (
      with c as (select * from "warehouse"."main"."stg_content")
select * from c
    );
  
  
[0m04:30:51.110041 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m04:30:51.113574 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:51.115589 [debug] [Thread-4 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events" rename to "fct_product_events__dbt_backup"
[0m04:30:51.115589 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m04:30:51.115589 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:51.115589 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m04:30:51.115589 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users" rename to "dim_users__dbt_backup"
[0m04:30:51.123937 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m04:30:51.123937 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:51.123937 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:51.123937 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m04:30:51.123937 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content" rename to "dim_content__dbt_backup"
[0m04:30:51.123937 [debug] [Thread-4 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events__dbt_tmp" rename to "fct_product_events"
[0m04:30:51.133138 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:51.133138 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users__dbt_tmp" rename to "dim_users"
[0m04:30:51.133138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:30:51.133138 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m04:30:51.139783 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:51.139783 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m04:30:51.139783 [debug] [Thread-4 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:30:51.139783 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content__dbt_tmp" rename to "dim_content"
[0m04:30:51.150396 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:30:51.150396 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:51.150396 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:51.150396 [debug] [Thread-4 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:30:51.150396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:30:51.150396 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:30:51.154885 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:30:51.156023 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:51.156023 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:30:51.165451 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m04:30:51.168377 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:30:51.168377 [debug] [Thread-4 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
drop table if exists "warehouse"."main"."fct_product_events__dbt_backup" cascade
[0m04:30:51.168377 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m04:30:51.168377 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m04:30:51.172118 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:30:51.172118 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:30:51.172118 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
drop table if exists "warehouse"."main"."dim_users__dbt_backup" cascade
[0m04:30:51.172118 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
drop table if exists "warehouse"."main"."dim_content__dbt_backup" cascade
[0m04:30:51.172118 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m04:30:51.288555 [debug] [Thread-4 (]: On model.meta_product_analytics.fct_product_events: Close
[0m04:30:51.288555 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A169DCCB0>]}
[0m04:30:51.293215 [debug] [Thread-2 (]: SQL status: OK in 0.115 seconds
[0m04:30:51.296294 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_users: Close
[0m04:30:51.293215 [info ] [Thread-4 (]: 4 of 7 OK created sql table model main.fct_product_events ...................... [[32mOK[0m in 0.28s]
[0m04:30:51.299017 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m04:30:51.299017 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A16CC35C0>]}
[0m04:30:51.299017 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:30:51.299017 [info ] [Thread-2 (]: 6 of 7 OK created sql table model main.dim_users ............................... [[32mOK[0m in 0.23s]
[0m04:30:51.299017 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: Close
[0m04:30:51.299017 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:30:51.299017 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:30:51.299017 [info ] [Thread-3 (]: 7 of 7 START sql table model main.agg_product_kpis ............................. [RUN]
[0m04:30:51.308648 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now model.meta_product_analytics.agg_product_kpis)
[0m04:30:51.310661 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m04:30:51.319666 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m04:30:51.321706 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m04:30:51.326451 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.agg_product_kpis"
[0m04:30:51.328465 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:30:51.330227 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: BEGIN
[0m04:30:51.330227 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:30:51.330227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A187FA4B0>]}
[0m04:30:51.333250 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main.dim_content ............................. [[32mOK[0m in 0.31s]
[0m04:30:51.335869 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:30:51.348033 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m04:30:51.348033 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:30:51.348033 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */

  
    
    

    create  table
      "warehouse"."main"."agg_product_kpis__dbt_tmp"
  
    as (
      with e as (
    select
        event_id,
        user_id,
        content_id,
        event_type,
        cast(event_ts as timestamp) as event_ts,
        cast(event_ts as date) as event_date
    from "warehouse"."main"."fct_product_events"
),
a as (
    select * from "warehouse"."main"."dim_users"
)
select
    event_date,
    count(distinct case when event_type = 'session_start' then user_id end) as dau,
    count(distinct user_id) filter (where event_type = 'follow') as daily_followers,
    count(*) filter (where event_type = 'impression') as impressions,
    count(*) filter (where event_type = 'like') as likes,
    (count(*) filter (where event_type = 'like'))::double 
        / nullif((count(*) filter (where event_type = 'impression')), 0) as like_rate
from e
group by event_date
order by event_date
    );
  
  
[0m04:30:51.362958 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m04:30:51.364973 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:30:51.368825 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis" rename to "agg_product_kpis__dbt_backup"
[0m04:30:51.368825 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m04:30:51.372848 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:30:51.372848 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis__dbt_tmp" rename to "agg_product_kpis"
[0m04:30:51.372848 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m04:30:51.376394 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m04:30:51.376394 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:30:51.377403 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m04:30:51.379654 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m04:30:51.384033 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:30:51.384033 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
drop table if exists "warehouse"."main"."agg_product_kpis__dbt_backup" cascade
[0m04:30:51.386043 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m04:30:51.386043 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: Close
[0m04:30:51.394329 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14815265-d98c-4e6c-bf5c-f21916894f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A188A7FB0>]}
[0m04:30:51.394329 [info ] [Thread-3 (]: 7 of 7 OK created sql table model main.agg_product_kpis ........................ [[32mOK[0m in 0.09s]
[0m04:30:51.394329 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:30:51.398350 [debug] [MainThread]: Using duckdb connection "master"
[0m04:30:51.398350 [debug] [MainThread]: On master: BEGIN
[0m04:30:51.398350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:30:51.424521 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m04:30:51.424521 [debug] [MainThread]: On master: COMMIT
[0m04:30:51.424521 [debug] [MainThread]: Using duckdb connection "master"
[0m04:30:51.424521 [debug] [MainThread]: On master: COMMIT
[0m04:30:51.424521 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:30:51.424521 [debug] [MainThread]: On master: Close
[0m04:30:51.424521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:30:51.424521 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:30:51.424521 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:30:51.424521 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_content' was properly closed.
[0m04:30:51.424521 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_users' was properly closed.
[0m04:30:51.424521 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m04:30:51.424521 [debug] [MainThread]: Connection 'model.meta_product_analytics.fct_product_events' was properly closed.
[0m04:30:51.424521 [info ] [MainThread]: 
[0m04:30:51.424521 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m04:30:51.440401 [debug] [MainThread]: Command end result
[0m04:30:51.487760 [info ] [MainThread]: 
[0m04:30:51.488956 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:30:51.488956 [info ] [MainThread]: 
[0m04:30:51.488956 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m04:30:51.488956 [debug] [MainThread]: Command `dbt build` succeeded at 04:30:51.488956 after 5.53 seconds
[0m04:30:51.488956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A18265520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A185AE8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A185AEBA0>]}
[0m04:30:51.494882 [debug] [MainThread]: Flushing usage events
[0m04:30:59.948178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4ECF4DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4CE0E9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4E874D10>]}


============================== 04:30:59.948178 | a8ff9af3-8662-4f44-a09b-1396c2654d32 ==============================
[0m04:30:59.948178 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:30:59.964920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:31:00.358330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4E5F4E00>]}
[0m04:31:00.451448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4F0F3740>]}
[0m04:31:00.453460 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:31:00.901420 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:31:01.066982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:31:01.066982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:31:01.110209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C50A62600>]}
[0m04:31:01.287273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4F83FE00>]}
[0m04:31:01.288286 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:31:01.290238 [info ] [MainThread]: 
[0m04:31:01.290238 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:31:01.301384 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:31:01.438942 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:31:01.438942 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:31:01.438942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:01.459454 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m04:31:01.459454 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:31:01.466630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:31:01.466630 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:31:01.475022 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:31:01.475022 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:31:01.475022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:31:01.495972 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m04:31:01.495972 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:31:01.495972 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:31:01.495972 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:31:01.495972 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:31:01.495972 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:31:01.502744 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:31:01.502744 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:31:01.504583 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:31:01.504583 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:31:01.504583 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:31:01.504583 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:31:01.509624 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:31:01.520011 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:31:01.520011 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:31:01.520011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:01.529735 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m04:31:01.529735 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:31:01.529735 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:31:01.585013 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m04:31:01.585013 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:31:01.585013 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:31:01.585013 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:31:01.600123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4F7A0410>]}
[0m04:31:01.600123 [debug] [MainThread]: Using duckdb connection "master"
[0m04:31:01.600123 [debug] [MainThread]: On master: BEGIN
[0m04:31:01.600123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:31:01.614972 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m04:31:01.614972 [debug] [MainThread]: On master: COMMIT
[0m04:31:01.614972 [debug] [MainThread]: Using duckdb connection "master"
[0m04:31:01.614972 [debug] [MainThread]: On master: COMMIT
[0m04:31:01.614972 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:31:01.614972 [debug] [MainThread]: On master: Close
[0m04:31:01.614972 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:31:01.623892 [info ] [MainThread]: 
[0m04:31:01.629116 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:31:01.629116 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:31:01.629116 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:31:01.629116 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:31:01.629116 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:31:01.629116 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:31:01.629116 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:31:01.644214 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:31:01.644214 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:31:01.648259 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:31:01.648259 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:31:01.648259 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:31:01.659963 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:31:01.662961 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:31:01.662961 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:31:01.662961 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:31:01.724202 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:31:01.724202 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:31:01.734180 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:31:01.734180 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:31:01.739205 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:31:01.741221 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:01.741221 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:01.741221 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:31:01.743233 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:01.743233 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:31:01.745246 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:31:01.746642 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:31:01.748542 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:31:01.748542 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:31:01.757933 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m04:31:01.757933 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m04:31:01.757933 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:01.757933 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m04:31:01.757933 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:01.763886 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw
  );

[0m04:31:01.763886 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:01.763886 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw
  );

[0m04:31:01.763886 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw
  );

[0m04:31:01.769974 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m04:31:01.780037 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m04:31:01.786069 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:01.787818 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m04:31:01.787818 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m04:31:01.791835 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:01.797154 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:01.797154 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content" rename to "stg_content__dbt_backup"
[0m04:31:01.797154 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m04:31:01.797154 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m04:31:01.802302 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:01.804084 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m04:31:01.804084 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m04:31:01.804084 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m04:31:01.804084 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:01.813070 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:01.813070 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m04:31:01.815062 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content__dbt_tmp" rename to "stg_content"
[0m04:31:01.815062 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m04:31:01.839178 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m04:31:01.840579 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:31:01.841246 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m04:31:01.843822 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:31:01.843822 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:01.847363 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:31:01.848401 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:01.848401 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:31:01.848401 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:01.848401 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:31:01.848401 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:31:01.864274 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m04:31:01.871199 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:01.871199 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m04:31:01.871199 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
drop view if exists "warehouse"."main"."stg_users__dbt_backup" cascade
[0m04:31:01.871199 [debug] [Thread-2 (]: SQL status: OK in 0.022 seconds
[0m04:31:01.871199 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:01.879778 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
drop view if exists "warehouse"."main"."stg_content__dbt_backup" cascade
[0m04:31:01.881376 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:01.883682 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
drop view if exists "warehouse"."main"."stg_events__dbt_backup" cascade
[0m04:31:01.883682 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m04:31:01.889397 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:31:01.889397 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m04:31:01.892935 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4CE0EA80>]}
[0m04:31:01.895477 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:31:01.897810 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.24s]
[0m04:31:01.898389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C51263F50>]}
[0m04:31:01.898389 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:31:01.898389 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m04:31:01.898389 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_content .............................. [[32mOK[0m in 0.27s]
[0m04:31:01.898389 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:31:01.898389 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:31:01.898389 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_users
[0m04:31:01.898389 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.dim_content
[0m04:31:01.898389 [info ] [Thread-4 (]: 4 of 7 START sql table model main.dim_users .................................... [RUN]
[0m04:31:01.898389 [info ] [Thread-3 (]: 5 of 7 START sql table model main.dim_content .................................. [RUN]
[0m04:31:01.911575 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now model.meta_product_analytics.dim_content)
[0m04:31:01.913330 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.meta_product_analytics.dim_users'
[0m04:31:01.913330 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.dim_content
[0m04:31:01.916083 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_users
[0m04:31:01.920204 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m04:31:01.920204 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C51309B50>]}
[0m04:31:01.924572 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m04:31:01.927574 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.29s]
[0m04:31:01.930648 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:31:01.931254 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.dim_content
[0m04:31:01.958885 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_users
[0m04:31:01.963924 [debug] [Thread-4 (]: Writing runtime sql for node "model.meta_product_analytics.dim_users"
[0m04:31:01.974902 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:31:01.979801 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.dim_content"
[0m04:31:01.983000 [info ] [Thread-1 (]: 6 of 7 START sql table model main.fct_product_events ........................... [RUN]
[0m04:31:01.983000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now model.meta_product_analytics.fct_product_events)
[0m04:31:01.983000 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m04:31:01.983000 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m04:31:01.990854 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:01.983000 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:01.990854 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: BEGIN
[0m04:31:01.990854 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: BEGIN
[0m04:31:01.990854 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:31:01.990854 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m04:31:01.990854 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:31:02.002185 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.fct_product_events"
[0m04:31:02.002185 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:02.005178 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: BEGIN
[0m04:31:02.005178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:02.031381 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m04:31:02.032480 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m04:31:02.033826 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m04:31:02.033826 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:02.033826 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:02.033826 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:02.033826 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */

  
    
    

    create  table
      "warehouse"."main"."dim_users__dbt_tmp"
  
    as (
      with u as (select * from "warehouse"."main"."stg_users")
select * from u
    );
  
  
[0m04:31:02.033826 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */

  
    
    

    create  table
      "warehouse"."main"."fct_product_events__dbt_tmp"
  
    as (
      with e as (select * from "warehouse"."main"."stg_events")
select * from e
    );
  
  
[0m04:31:02.033826 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */

  
    
    

    create  table
      "warehouse"."main"."dim_content__dbt_tmp"
  
    as (
      with c as (select * from "warehouse"."main"."stg_content")
select * from c
    );
  
  
[0m04:31:02.048539 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m04:31:02.053401 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:02.053401 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m04:31:02.053401 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users" rename to "dim_users__dbt_backup"
[0m04:31:02.053401 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m04:31:02.057857 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:02.064124 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:02.064124 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content" rename to "dim_content__dbt_backup"
[0m04:31:02.064124 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events" rename to "fct_product_events__dbt_backup"
[0m04:31:02.064124 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m04:31:02.064124 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:02.064124 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users__dbt_tmp" rename to "dim_users"
[0m04:31:02.064124 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m04:31:02.064124 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m04:31:02.078414 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:02.078414 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m04:31:02.085751 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:02.087764 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events__dbt_tmp" rename to "fct_product_events"
[0m04:31:02.097421 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:31:02.098900 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content__dbt_tmp" rename to "dim_content"
[0m04:31:02.098900 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:02.098900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:31:02.098900 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:31:02.098900 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m04:31:02.098900 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:31:02.107837 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:31:02.107837 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:02.109566 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:02.109566 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:31:02.109566 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:31:02.114523 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m04:31:02.114523 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:02.114523 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
drop table if exists "warehouse"."main"."dim_users__dbt_backup" cascade
[0m04:31:02.114523 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m04:31:02.124764 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m04:31:02.129740 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:02.244428 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:02.260446 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
drop table if exists "warehouse"."main"."dim_content__dbt_backup" cascade
[0m04:31:02.260446 [debug] [Thread-4 (]: SQL status: OK in 0.137 seconds
[0m04:31:02.260446 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
drop table if exists "warehouse"."main"."fct_product_events__dbt_backup" cascade
[0m04:31:02.260446 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: Close
[0m04:31:02.260446 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4F7F1BB0>]}
[0m04:31:02.260446 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m04:31:02.272967 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: Close
[0m04:31:02.260446 [info ] [Thread-4 (]: 4 of 7 OK created sql table model main.dim_users ............................... [[32mOK[0m in 0.36s]
[0m04:31:02.272967 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C5134EE70>]}
[0m04:31:02.276431 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:31:02.276431 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m04:31:02.281478 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: Close
[0m04:31:02.276431 [info ] [Thread-3 (]: 5 of 7 OK created sql table model main.dim_content ............................. [[32mOK[0m in 0.36s]
[0m04:31:02.281478 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:31:02.304293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C5130EAE0>]}
[0m04:31:02.306306 [info ] [Thread-1 (]: 6 of 7 OK created sql table model main.fct_product_events ...................... [[32mOK[0m in 0.32s]
[0m04:31:02.308112 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:31:02.308803 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:31:02.308803 [info ] [Thread-2 (]: 7 of 7 START sql table model main.agg_product_kpis ............................. [RUN]
[0m04:31:02.308803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now model.meta_product_analytics.agg_product_kpis)
[0m04:31:02.313341 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m04:31:02.315409 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m04:31:02.315409 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m04:31:02.324794 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.agg_product_kpis"
[0m04:31:02.326811 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:02.328828 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: BEGIN
[0m04:31:02.328828 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:31:02.355522 [debug] [Thread-2 (]: SQL status: OK in 0.030 seconds
[0m04:31:02.355522 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:02.355522 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */

  
    
    

    create  table
      "warehouse"."main"."agg_product_kpis__dbt_tmp"
  
    as (
      with e as (
    select
        event_id,
        user_id,
        content_id,
        event_type,
        cast(event_ts as timestamp) as event_ts,
        cast(event_ts as date) as event_date
    from "warehouse"."main"."fct_product_events"
),
a as (
    select * from "warehouse"."main"."dim_users"
)
select
    event_date,
    count(distinct case when event_type = 'session_start' then user_id end) as dau,
    count(distinct user_id) filter (where event_type = 'follow') as daily_followers,
    count(*) filter (where event_type = 'impression') as impressions,
    count(*) filter (where event_type = 'like') as likes,
    (count(*) filter (where event_type = 'like'))::double 
        / nullif((count(*) filter (where event_type = 'impression')), 0) as like_rate
from e
group by event_date
order by event_date
    );
  
  
[0m04:31:02.366869 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m04:31:02.366869 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:02.366869 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis" rename to "agg_product_kpis__dbt_backup"
[0m04:31:02.366869 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m04:31:02.382080 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:02.382080 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis__dbt_tmp" rename to "agg_product_kpis"
[0m04:31:02.382080 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m04:31:02.382080 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m04:31:02.382080 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:02.382080 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m04:31:02.382080 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m04:31:02.397036 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:02.397036 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
drop table if exists "warehouse"."main"."agg_product_kpis__dbt_backup" cascade
[0m04:31:02.397036 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m04:31:02.404759 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: Close
[0m04:31:02.413608 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ff9af3-8662-4f44-a09b-1396c2654d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4E58DC10>]}
[0m04:31:02.413608 [info ] [Thread-2 (]: 7 of 7 OK created sql table model main.agg_product_kpis ........................ [[32mOK[0m in 0.10s]
[0m04:31:02.413608 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:31:02.413608 [debug] [MainThread]: Using duckdb connection "master"
[0m04:31:02.413608 [debug] [MainThread]: On master: BEGIN
[0m04:31:02.413608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:31:02.448258 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m04:31:02.448258 [debug] [MainThread]: On master: COMMIT
[0m04:31:02.448258 [debug] [MainThread]: Using duckdb connection "master"
[0m04:31:02.459592 [debug] [MainThread]: On master: COMMIT
[0m04:31:02.459592 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:31:02.459592 [debug] [MainThread]: On master: Close
[0m04:31:02.459592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:31:02.459592 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:31:02.459592 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:31:02.459592 [debug] [MainThread]: Connection 'model.meta_product_analytics.fct_product_events' was properly closed.
[0m04:31:02.459592 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m04:31:02.459592 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_content' was properly closed.
[0m04:31:02.459592 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_users' was properly closed.
[0m04:31:02.459592 [info ] [MainThread]: 
[0m04:31:02.459592 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m04:31:02.459592 [debug] [MainThread]: Command end result
[0m04:31:02.525165 [info ] [MainThread]: 
[0m04:31:02.525165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:31:02.530864 [info ] [MainThread]: 
[0m04:31:02.532908 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m04:31:02.532908 [debug] [MainThread]: Command `dbt build` succeeded at 04:31:02.532908 after 2.82 seconds
[0m04:31:02.535328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4F2CDB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4F188D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C4A847A40>]}
[0m04:31:02.535328 [debug] [MainThread]: Flushing usage events
[0m04:31:11.050427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E641F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E6753B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E6753860>]}


============================== 04:31:11.067332 | 584f949f-0e7d-4fd8-870d-6d3ef550f447 ==============================
[0m04:31:11.067332 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:31:11.067332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m04:31:11.431097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E6772390>]}
[0m04:31:11.534079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E6796150>]}
[0m04:31:11.534079 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:31:12.131843 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:31:12.272153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:31:12.272153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:31:12.306191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E79A7B60>]}
[0m04:31:12.477789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E7D2B770>]}
[0m04:31:12.479768 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:31:12.487185 [info ] [MainThread]: 
[0m04:31:12.487185 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:31:12.497810 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:31:12.632383 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:31:12.632383 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:31:12.632383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:12.650265 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m04:31:12.650265 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:31:12.660855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:31:12.662955 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:31:12.675512 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:31:12.677529 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:31:12.677529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:31:12.691404 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m04:31:12.691404 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:31:12.696503 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:31:12.698517 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:31:12.699397 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:31:12.699397 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:31:12.699397 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:31:12.699397 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:31:12.699397 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:31:12.699397 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:31:12.699397 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:31:12.699397 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:31:12.708819 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:31:12.720531 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:31:12.720531 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:31:12.722545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:12.732652 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m04:31:12.732652 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:31:12.732652 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:31:12.796538 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m04:31:12.799714 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:31:12.799714 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:31:12.799714 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:31:12.807611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E7D2ADB0>]}
[0m04:31:12.809621 [debug] [MainThread]: Using duckdb connection "master"
[0m04:31:12.809621 [debug] [MainThread]: On master: BEGIN
[0m04:31:12.809621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:31:12.822927 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m04:31:12.822927 [debug] [MainThread]: On master: COMMIT
[0m04:31:12.825409 [debug] [MainThread]: Using duckdb connection "master"
[0m04:31:12.825409 [debug] [MainThread]: On master: COMMIT
[0m04:31:12.825409 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:31:12.825409 [debug] [MainThread]: On master: Close
[0m04:31:12.830986 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:31:12.832381 [info ] [MainThread]: 
[0m04:31:12.840602 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:31:12.840602 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:31:12.840602 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:31:12.840602 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:31:12.848741 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:31:12.840602 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:31:12.848741 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:31:12.851544 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:31:12.846376 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:31:12.865057 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:31:12.863429 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:31:12.856668 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:31:12.866194 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:31:12.866194 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:31:12.872563 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:31:12.872563 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:31:12.879709 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:31:12.949362 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:31:12.949362 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:31:12.949362 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:31:12.962988 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:31:12.966530 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:12.966530 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:12.966530 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:31:12.966530 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:31:12.966530 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:31:12.966530 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:31:12.966530 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:12.966530 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:31:12.966530 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:31:12.985555 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m04:31:12.985555 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:12.985555 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw
  );

[0m04:31:12.985555 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m04:31:12.985555 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:12.985555 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m04:31:12.985555 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw
  );

[0m04:31:12.985555 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:12.985555 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw
  );

[0m04:31:12.985555 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m04:31:13.000881 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:13.000881 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m04:31:13.000881 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m04:31:13.013202 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m04:31:13.018976 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:13.020987 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content" rename to "stg_content__dbt_backup"
[0m04:31:13.020987 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m04:31:13.020987 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:13.020987 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:13.029835 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m04:31:13.020987 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m04:31:13.029835 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m04:31:13.033573 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m04:31:13.033573 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m04:31:13.038769 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:13.065994 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:13.074006 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:31:13.074006 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content__dbt_tmp" rename to "stg_content"
[0m04:31:13.074006 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m04:31:13.074006 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:13.079610 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:31:13.085603 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:31:13.088258 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:31:13.090272 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m04:31:13.090272 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:13.092912 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:31:13.094930 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:31:13.096243 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:13.096243 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m04:31:13.099790 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:31:13.108887 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m04:31:13.099790 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:31:13.114064 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:31:13.116756 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m04:31:13.116756 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
drop view if exists "warehouse"."main"."stg_users__dbt_backup" cascade
[0m04:31:13.116756 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
drop view if exists "warehouse"."main"."stg_content__dbt_backup" cascade
[0m04:31:13.121357 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:31:13.121357 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
drop view if exists "warehouse"."main"."stg_events__dbt_backup" cascade
[0m04:31:13.124837 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m04:31:13.129861 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:31:13.131879 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m04:31:13.134991 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E3DCB290>]}
[0m04:31:13.134991 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:31:13.134991 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m04:31:13.142980 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:31:13.142980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E79A7F80>]}
[0m04:31:13.134991 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.27s]
[0m04:31:13.146308 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:31:13.151107 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_users
[0m04:31:13.142980 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_content .............................. [[32mOK[0m in 0.29s]
[0m04:31:13.151107 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:31:13.151107 [info ] [Thread-4 (]: 4 of 7 START sql table model main.dim_users .................................... [RUN]
[0m04:31:13.151107 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.meta_product_analytics.dim_users'
[0m04:31:13.154698 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_users
[0m04:31:13.158740 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m04:31:13.158740 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.dim_content
[0m04:31:13.158740 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E828FBC0>]}
[0m04:31:13.166978 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_users
[0m04:31:13.164416 [info ] [Thread-3 (]: 5 of 7 START sql table model main.dim_content .................................. [RUN]
[0m04:31:13.197969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now model.meta_product_analytics.dim_content)
[0m04:31:13.164416 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.31s]
[0m04:31:13.204252 [debug] [Thread-4 (]: Writing runtime sql for node "model.meta_product_analytics.dim_users"
[0m04:31:13.204252 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.dim_content
[0m04:31:13.204252 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:31:13.204252 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m04:31:13.216384 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:31:13.218588 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:13.220602 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: BEGIN
[0m04:31:13.218588 [info ] [Thread-1 (]: 6 of 7 START sql table model main.fct_product_events ........................... [RUN]
[0m04:31:13.220602 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.dim_content
[0m04:31:13.222619 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:31:13.222619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now model.meta_product_analytics.fct_product_events)
[0m04:31:13.228493 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m04:31:13.234504 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m04:31:13.237182 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.dim_content"
[0m04:31:13.239195 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:13.239195 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m04:31:13.241206 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: BEGIN
[0m04:31:13.243590 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.fct_product_events"
[0m04:31:13.246343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:31:13.248337 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:13.249342 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: BEGIN
[0m04:31:13.249342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.249342 [debug] [Thread-4 (]: SQL status: OK in 0.034 seconds
[0m04:31:13.249342 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m04:31:13.249342 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:13.249342 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m04:31:13.249342 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:13.249342 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */

  
    
    

    create  table
      "warehouse"."main"."dim_users__dbt_tmp"
  
    as (
      with u as (select * from "warehouse"."main"."stg_users")
select * from u
    );
  
  
[0m04:31:13.259500 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:13.259500 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */

  
    
    

    create  table
      "warehouse"."main"."fct_product_events__dbt_tmp"
  
    as (
      with e as (select * from "warehouse"."main"."stg_events")
select * from e
    );
  
  
[0m04:31:13.259500 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */

  
    
    

    create  table
      "warehouse"."main"."dim_content__dbt_tmp"
  
    as (
      with c as (select * from "warehouse"."main"."stg_content")
select * from c
    );
  
  
[0m04:31:13.265709 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m04:31:13.265709 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m04:31:13.265709 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:13.275439 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m04:31:13.282193 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:13.284206 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content" rename to "dim_content__dbt_backup"
[0m04:31:13.293261 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:13.293261 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events" rename to "fct_product_events__dbt_backup"
[0m04:31:13.293261 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users" rename to "dim_users__dbt_backup"
[0m04:31:13.296812 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m04:31:13.298757 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:31:13.298757 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m04:31:13.302448 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:13.306987 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:13.313995 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:13.315009 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content__dbt_tmp" rename to "dim_content"
[0m04:31:13.315835 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events__dbt_tmp" rename to "fct_product_events"
[0m04:31:13.316828 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users__dbt_tmp" rename to "dim_users"
[0m04:31:13.316828 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m04:31:13.316828 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:31:13.316828 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m04:31:13.316828 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:13.316828 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m04:31:13.330539 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:31:13.332971 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:31:13.336120 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:31:13.336120 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:13.336120 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:13.336120 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:31:13.339668 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:31:13.348947 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m04:31:13.353159 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:31:13.353159 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
drop table if exists "warehouse"."main"."dim_content__dbt_backup" cascade
[0m04:31:13.355169 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m04:31:13.355169 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:31:13.361494 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m04:31:13.363107 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
drop table if exists "warehouse"."main"."fct_product_events__dbt_backup" cascade
[0m04:31:13.363107 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m04:31:13.490162 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:31:13.496616 [debug] [Thread-3 (]: On model.meta_product_analytics.dim_content: Close
[0m04:31:13.498564 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
drop table if exists "warehouse"."main"."dim_users__dbt_backup" cascade
[0m04:31:13.500411 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E82E7650>]}
[0m04:31:13.503346 [info ] [Thread-3 (]: 5 of 7 OK created sql table model main.dim_content ............................. [[32mOK[0m in 0.30s]
[0m04:31:13.504421 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:31:13.509582 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m04:31:13.516521 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: Close
[0m04:31:13.516521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E828FE00>]}
[0m04:31:13.516521 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m04:31:13.523521 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: Close
[0m04:31:13.516521 [info ] [Thread-1 (]: 6 of 7 OK created sql table model main.fct_product_events ...................... [[32mOK[0m in 0.29s]
[0m04:31:13.525244 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:31:13.546817 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E643CDA0>]}
[0m04:31:13.547684 [info ] [Thread-4 (]: 4 of 7 OK created sql table model main.dim_users ............................... [[32mOK[0m in 0.39s]
[0m04:31:13.549459 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:31:13.549459 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:31:13.549459 [info ] [Thread-2 (]: 7 of 7 START sql table model main.agg_product_kpis ............................. [RUN]
[0m04:31:13.549459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now model.meta_product_analytics.agg_product_kpis)
[0m04:31:13.549459 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m04:31:13.557571 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m04:31:13.563244 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m04:31:13.567171 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.agg_product_kpis"
[0m04:31:13.567171 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:13.567171 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: BEGIN
[0m04:31:13.567171 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:31:13.615578 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m04:31:13.616520 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:13.616520 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */

  
    
    

    create  table
      "warehouse"."main"."agg_product_kpis__dbt_tmp"
  
    as (
      with e as (
    select
        event_id,
        user_id,
        content_id,
        event_type,
        cast(event_ts as timestamp) as event_ts,
        cast(event_ts as date) as event_date
    from "warehouse"."main"."fct_product_events"
),
a as (
    select * from "warehouse"."main"."dim_users"
)
select
    event_date,
    count(distinct case when event_type = 'session_start' then user_id end) as dau,
    count(distinct user_id) filter (where event_type = 'follow') as daily_followers,
    count(*) filter (where event_type = 'impression') as impressions,
    count(*) filter (where event_type = 'like') as likes,
    (count(*) filter (where event_type = 'like'))::double 
        / nullif((count(*) filter (where event_type = 'impression')), 0) as like_rate
from e
group by event_date
order by event_date
    );
  
  
[0m04:31:13.621831 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m04:31:13.631796 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:13.633303 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis" rename to "agg_product_kpis__dbt_backup"
[0m04:31:13.633303 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m04:31:13.633303 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:13.633303 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis__dbt_tmp" rename to "agg_product_kpis"
[0m04:31:13.641773 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m04:31:13.643591 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m04:31:13.643591 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:13.646504 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m04:31:13.650047 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m04:31:13.650047 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:31:13.650047 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
drop table if exists "warehouse"."main"."agg_product_kpis__dbt_backup" cascade
[0m04:31:13.659560 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m04:31:13.663148 [debug] [Thread-2 (]: On model.meta_product_analytics.agg_product_kpis: Close
[0m04:31:13.675011 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584f949f-0e7d-4fd8-870d-6d3ef550f447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E828FF20>]}
[0m04:31:13.677034 [info ] [Thread-2 (]: 7 of 7 OK created sql table model main.agg_product_kpis ........................ [[32mOK[0m in 0.13s]
[0m04:31:13.677034 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:31:13.682518 [debug] [MainThread]: Using duckdb connection "master"
[0m04:31:13.682518 [debug] [MainThread]: On master: BEGIN
[0m04:31:13.682518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:31:13.718441 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m04:31:13.718441 [debug] [MainThread]: On master: COMMIT
[0m04:31:13.720457 [debug] [MainThread]: Using duckdb connection "master"
[0m04:31:13.720457 [debug] [MainThread]: On master: COMMIT
[0m04:31:13.720457 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:31:13.722476 [debug] [MainThread]: On master: Close
[0m04:31:13.726930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:31:13.726930 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:31:13.726930 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:31:13.726930 [debug] [MainThread]: Connection 'model.meta_product_analytics.fct_product_events' was properly closed.
[0m04:31:13.728948 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m04:31:13.730531 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_content' was properly closed.
[0m04:31:13.730531 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_users' was properly closed.
[0m04:31:13.733528 [info ] [MainThread]: 
[0m04:31:13.736898 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m04:31:13.738907 [debug] [MainThread]: Command end result
[0m04:31:13.783106 [info ] [MainThread]: 
[0m04:31:13.783106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:31:13.798142 [info ] [MainThread]: 
[0m04:31:13.800475 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m04:31:13.800475 [debug] [MainThread]: Command `dbt build` succeeded at 04:31:13.800475 after 2.97 seconds
[0m04:31:13.800475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E814F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E814E300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E814E810>]}
[0m04:31:13.800475 [debug] [MainThread]: Flushing usage events
[0m04:50:57.389324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175434CD0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001754435D400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001754435D730>]}


============================== 04:50:57.399789 | 1bc97eef-b189-4baa-a464-60f6fd5e9dcf ==============================
[0m04:50:57.399789 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:50:57.399789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m04:50:57.695019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001754435FE90>]}
[0m04:50:57.758598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017544496480>]}
[0m04:50:57.758598 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:50:58.091503 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:50:58.221766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:50:58.221766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:50:58.254159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175444091C0>]}
[0m04:50:58.388416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175458D9A30>]}
[0m04:50:58.390437 [info ] [MainThread]: Found 7 models, 421 macros
[0m04:50:58.396240 [info ] [MainThread]: 
[0m04:50:58.396240 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:50:58.407939 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m04:50:58.514142 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m04:50:58.514142 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m04:50:58.516157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:50:58.526396 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m04:50:58.532088 [debug] [ThreadPool]: On list_warehouse: Close
[0m04:50:58.534112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m04:50:58.534112 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m04:50:58.534112 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:50:58.534112 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m04:50:58.534112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:50:58.555076 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m04:50:58.557090 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:50:58.557090 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m04:50:58.559103 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:50:58.559103 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:50:58.559103 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m04:50:58.559103 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:50:58.561122 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:50:58.561122 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m04:50:58.561122 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m04:50:58.563135 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:50:58.563135 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m04:50:58.566166 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:50:58.573993 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:50:58.573993 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:50:58.573993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:50:58.584839 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m04:50:58.584839 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:50:58.584839 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:50:58.622276 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m04:50:58.622276 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:50:58.622276 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:50:58.622276 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:50:58.629535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017541A5CCE0>]}
[0m04:50:58.629535 [debug] [MainThread]: Using duckdb connection "master"
[0m04:50:58.629535 [debug] [MainThread]: On master: BEGIN
[0m04:50:58.629535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:50:58.641851 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:50:58.641851 [debug] [MainThread]: On master: COMMIT
[0m04:50:58.641851 [debug] [MainThread]: Using duckdb connection "master"
[0m04:50:58.643864 [debug] [MainThread]: On master: COMMIT
[0m04:50:58.643864 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:50:58.643864 [debug] [MainThread]: On master: Close
[0m04:50:58.645620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:50:58.647642 [info ] [MainThread]: 
[0m04:50:58.647642 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m04:50:58.647642 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m04:50:58.647642 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m04:50:58.647642 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m04:50:58.647642 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m04:50:58.647642 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m04:50:58.665472 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m04:50:58.647642 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m04:50:58.665472 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m04:50:58.647642 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m04:50:58.665472 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m04:50:58.665472 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m04:50:58.679547 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m04:50:58.679547 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m04:50:58.682077 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m04:50:58.711959 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m04:50:58.726415 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m04:50:58.726415 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m04:50:58.730304 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m04:50:58.732315 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m04:50:58.732315 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:50:58.735632 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m04:50:58.735632 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m04:50:58.735632 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:50:58.735632 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:50:58.735632 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m04:50:58.740769 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:50:58.735632 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:50:58.740769 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m04:50:58.740769 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:50:58.748834 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m04:50:58.748834 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m04:50:58.748834 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:50:58.748834 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m04:50:58.748834 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:50:58.748834 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw
  );

[0m04:50:58.748834 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:50:58.748834 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw
  );

[0m04:50:58.748834 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw
  );

[0m04:50:58.758654 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m04:50:58.760664 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:50:58.760664 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m04:50:58.760664 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m04:50:58.772490 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:50:58.772490 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m04:50:58.772490 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m04:50:58.772490 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m04:50:58.772490 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:50:58.780685 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:50:58.780685 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content" rename to "stg_content__dbt_backup"
[0m04:50:58.780685 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m04:50:58.780685 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m04:50:58.780685 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:50:58.787042 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:50:58.790585 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:50:58.792606 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m04:50:58.792606 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m04:50:58.792606 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content__dbt_tmp" rename to "stg_content"
[0m04:50:58.813402 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:50:58.813402 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m04:50:58.813402 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:50:58.813402 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:50:58.818209 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m04:50:58.818209 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m04:50:58.818209 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:50:58.820375 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:50:58.820375 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m04:50:58.823523 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:50:58.823523 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m04:50:58.829785 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m04:50:58.836185 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m04:50:58.838754 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m04:50:58.841321 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m04:50:58.841321 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m04:50:58.841321 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
drop view if exists "warehouse"."main"."stg_events__dbt_backup" cascade
[0m04:50:58.841321 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
drop view if exists "warehouse"."main"."stg_content__dbt_backup" cascade
[0m04:50:58.845452 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m04:50:58.845452 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
drop view if exists "warehouse"."main"."stg_users__dbt_backup" cascade
[0m04:50:58.845452 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m04:50:58.845452 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m04:50:58.854252 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017545E07110>]}
[0m04:50:58.852241 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m04:50:58.854252 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m04:50:58.854252 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.19s]
[0m04:50:58.861047 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m04:50:58.857104 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m04:50:58.861047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175455D8290>]}
[0m04:50:58.857104 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m04:50:58.863067 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_content .............................. [[32mOK[0m in 0.21s]
[0m04:50:58.865769 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m04:50:58.865769 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.fct_product_events
[0m04:50:58.868042 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.dim_content
[0m04:50:58.865769 [info ] [Thread-1 (]: 4 of 7 START sql table model main.fct_product_events ........................... [RUN]
[0m04:50:58.870054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now model.meta_product_analytics.fct_product_events)
[0m04:50:58.871260 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m04:50:58.877294 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m04:50:58.877294 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m04:50:58.899908 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.fct_product_events"
[0m04:50:58.868042 [info ] [Thread-2 (]: 5 of 7 START sql table model main.dim_content .................................. [RUN]
[0m04:50:58.899908 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017545A43B90>]}
[0m04:50:58.899908 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now model.meta_product_analytics.dim_content)
[0m04:50:58.899908 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.dim_content
[0m04:50:58.899908 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.23s]
[0m04:50:58.899908 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m04:50:58.912117 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m04:50:58.912117 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:50:58.912117 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: BEGIN
[0m04:50:58.914949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:50:58.914949 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_users
[0m04:50:58.917950 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.dim_content
[0m04:50:58.914949 [info ] [Thread-4 (]: 6 of 7 START sql table model main.dim_users .................................... [RUN]
[0m04:50:58.922667 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.dim_content"
[0m04:50:58.924680 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.meta_product_analytics.dim_users'
[0m04:50:58.924680 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_users
[0m04:50:58.928718 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m04:50:58.930741 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_users
[0m04:50:58.934780 [debug] [Thread-4 (]: Writing runtime sql for node "model.meta_product_analytics.dim_users"
[0m04:50:58.936794 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:50:58.936794 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_content: BEGIN
[0m04:50:58.938208 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:50:58.938208 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:50:58.938208 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: BEGIN
[0m04:50:58.938208 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:50:58.940646 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m04:50:58.940646 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m04:50:58.940646 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m04:50:58.940646 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:50:58.940646 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:50:58.940646 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:50:58.940646 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */

  
    
    

    create  table
      "warehouse"."main"."dim_users__dbt_tmp"
  
    as (
      with u as (select * from "warehouse"."main"."stg_users")
select * from u
    );
  
  
[0m04:50:58.946526 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */

  
    
    

    create  table
      "warehouse"."main"."fct_product_events__dbt_tmp"
  
    as (
      with e as (select * from "warehouse"."main"."stg_events")
select * from e
    );
  
  
[0m04:50:58.947961 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */

  
    
    

    create  table
      "warehouse"."main"."dim_content__dbt_tmp"
  
    as (
      with c as (select * from "warehouse"."main"."stg_content")
select * from c
    );
  
  
[0m04:50:58.947961 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m04:50:58.947961 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:50:58.947961 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users" rename to "dim_users__dbt_backup"
[0m04:50:58.947961 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m04:50:58.947961 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m04:50:58.961877 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:50:58.961877 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:50:58.961877 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m04:50:58.961877 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content" rename to "dim_content__dbt_backup"
[0m04:50:58.961877 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events" rename to "fct_product_events__dbt_backup"
[0m04:50:58.961877 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:50:58.961877 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users__dbt_tmp" rename to "dim_users"
[0m04:50:58.961877 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m04:50:58.975493 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:50:58.977508 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content__dbt_tmp" rename to "dim_content"
[0m04:50:58.977508 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m04:50:58.980595 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:50:58.982606 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events__dbt_tmp" rename to "fct_product_events"
[0m04:50:58.982606 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m04:50:58.987478 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:50:58.987478 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:50:58.987478 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m04:50:58.987478 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m04:50:58.993199 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:50:58.993199 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:50:58.995024 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m04:50:58.996039 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m04:50:58.997645 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:50:58.997645 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:50:58.997645 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m04:50:59.000752 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m04:50:59.000752 [debug] [Thread-4 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m04:50:59.000752 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
drop table if exists "warehouse"."main"."dim_users__dbt_backup" cascade
[0m04:50:59.000752 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m04:50:59.000752 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m04:50:59.010966 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m04:50:59.012981 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
drop table if exists "warehouse"."main"."dim_content__dbt_backup" cascade
[0m04:50:59.012981 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m04:50:59.012981 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
drop table if exists "warehouse"."main"."fct_product_events__dbt_backup" cascade
[0m04:50:59.012981 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m04:50:59.012981 [debug] [Thread-4 (]: On model.meta_product_analytics.dim_users: Close
[0m04:50:59.012981 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017545F21E50>]}
[0m04:50:59.012981 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m04:50:59.012981 [info ] [Thread-4 (]: 6 of 7 OK created sql table model main.dim_users ............................... [[32mOK[0m in 0.09s]
[0m04:50:59.028803 [debug] [Thread-2 (]: On model.meta_product_analytics.dim_content: Close
[0m04:50:59.030200 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m04:50:59.030200 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_users
[0m04:50:59.030200 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017545DF0350>]}
[0m04:50:59.030200 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: Close
[0m04:50:59.030200 [info ] [Thread-2 (]: 5 of 7 OK created sql table model main.dim_content ............................. [[32mOK[0m in 0.13s]
[0m04:50:59.030200 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.dim_content
[0m04:50:59.053457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017545DF0440>]}
[0m04:50:59.053457 [info ] [Thread-1 (]: 4 of 7 OK created sql table model main.fct_product_events ...................... [[32mOK[0m in 0.18s]
[0m04:50:59.056483 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m04:50:59.056483 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m04:50:59.058505 [info ] [Thread-3 (]: 7 of 7 START sql table model main.agg_product_kpis ............................. [RUN]
[0m04:50:59.058505 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now model.meta_product_analytics.agg_product_kpis)
[0m04:50:59.058505 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m04:50:59.058505 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m04:50:59.058505 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m04:50:59.183056 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.agg_product_kpis"
[0m04:50:59.188198 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:50:59.188198 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: BEGIN
[0m04:50:59.191763 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:50:59.224942 [debug] [Thread-3 (]: SQL status: OK in 0.034 seconds
[0m04:50:59.224942 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:50:59.226968 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */

  
    
    

    create  table
      "warehouse"."main"."agg_product_kpis__dbt_tmp"
  
    as (
      with e as (
    select
        event_id,
        user_id,
        content_id,
        event_type,
        cast(event_ts as timestamp) as event_ts,
        cast(event_ts as date) as event_date
    from "warehouse"."main"."fct_product_events"
),
a as (
    select * from "warehouse"."main"."dim_users"
)
select
    event_date,
    count(distinct case when event_type = 'session_start' then user_id end) as dau,
    count(distinct user_id) filter (where event_type = 'follow') as daily_followers,
    count(*) filter (where event_type = 'impression') as impressions,
    count(*) filter (where event_type = 'like') as likes,
    (count(*) filter (where event_type = 'like'))::double 
        / nullif((count(*) filter (where event_type = 'impression')), 0) as like_rate
from e
group by event_date
order by event_date
    );
  
  
[0m04:50:59.234781 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m04:50:59.234781 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:50:59.234781 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis" rename to "agg_product_kpis__dbt_backup"
[0m04:50:59.234781 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m04:50:59.234781 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:50:59.234781 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis__dbt_tmp" rename to "agg_product_kpis"
[0m04:50:59.234781 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m04:50:59.248629 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m04:50:59.248629 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:50:59.248629 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m04:50:59.252666 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m04:50:59.257773 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m04:50:59.257773 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
drop table if exists "warehouse"."main"."agg_product_kpis__dbt_backup" cascade
[0m04:50:59.259793 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m04:50:59.264752 [debug] [Thread-3 (]: On model.meta_product_analytics.agg_product_kpis: Close
[0m04:50:59.273665 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bc97eef-b189-4baa-a464-60f6fd5e9dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017545DF3E90>]}
[0m04:50:59.275685 [info ] [Thread-3 (]: 7 of 7 OK created sql table model main.agg_product_kpis ........................ [[32mOK[0m in 0.22s]
[0m04:50:59.275685 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m04:50:59.279532 [debug] [MainThread]: Using duckdb connection "master"
[0m04:50:59.279532 [debug] [MainThread]: On master: BEGIN
[0m04:50:59.279532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:50:59.305666 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m04:50:59.305666 [debug] [MainThread]: On master: COMMIT
[0m04:50:59.305666 [debug] [MainThread]: Using duckdb connection "master"
[0m04:50:59.307679 [debug] [MainThread]: On master: COMMIT
[0m04:50:59.307679 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:50:59.307679 [debug] [MainThread]: On master: Close
[0m04:50:59.310916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:50:59.310916 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m04:50:59.310916 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:50:59.312931 [debug] [MainThread]: Connection 'model.meta_product_analytics.fct_product_events' was properly closed.
[0m04:50:59.312931 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_content' was properly closed.
[0m04:50:59.312931 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m04:50:59.312931 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_users' was properly closed.
[0m04:50:59.312931 [info ] [MainThread]: 
[0m04:50:59.314941 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m04:50:59.314941 [debug] [MainThread]: Command end result
[0m04:50:59.347020 [info ] [MainThread]: 
[0m04:50:59.347020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:50:59.356182 [info ] [MainThread]: 
[0m04:50:59.358494 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m04:50:59.358494 [debug] [MainThread]: Command `dbt build` succeeded at 04:50:59.358494 after 2.15 seconds
[0m04:50:59.358494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175434CD0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017543E33FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017543CCEF90>]}
[0m04:50:59.361755 [debug] [MainThread]: Flushing usage events
[0m04:57:48.988268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEBA80620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE8FA6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE8FA6720>]}


============================== 04:57:48.988268 | 0cbd11b0-6eca-4503-b8a3-f0ed8d5ce40a ==============================
[0m04:57:48.988268 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:57:48.996150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khema\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:57:49.269923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cbd11b0-6eca-4503-b8a3-f0ed8d5ce40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEC5CA8A0>]}
[0m04:57:49.344934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cbd11b0-6eca-4503-b8a3-f0ed8d5ce40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEB277FE0>]}
[0m04:57:49.344934 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:57:49.672236 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:57:49.745920 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:57:49.745920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0cbd11b0-6eca-4503-b8a3-f0ed8d5ce40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEBA80E60>]}
[0m04:57:50.738280 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m04:57:50.738280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0cbd11b0-6eca-4503-b8a3-f0ed8d5ce40a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEDB2AF90>]}
[0m04:57:50.994898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cbd11b0-6eca-4503-b8a3-f0ed8d5ce40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BED69D0A0>]}
[0m04:57:51.265439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cbd11b0-6eca-4503-b8a3-f0ed8d5ce40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEDB2AFF0>]}
[0m04:57:51.267469 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m04:57:51.267469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbd11b0-6eca-4503-b8a3-f0ed8d5ce40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEDB09730>]}
[0m04:57:51.271555 [info ] [MainThread]: 
[0m04:57:51.271555 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:57:51.281166 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:57:51.386455 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:57:51.388471 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:57:51.388471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:51.407925 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m04:57:51.407925 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:57:51.409939 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:57:51.437696 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m04:57:51.437696 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:57:51.437696 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:57:51.437696 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:57:51.454244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbd11b0-6eca-4503-b8a3-f0ed8d5ce40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEDB10440>]}
[0m04:57:51.454244 [debug] [MainThread]: Using duckdb connection "master"
[0m04:57:51.454244 [debug] [MainThread]: On master: BEGIN
[0m04:57:51.454244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:57:51.482533 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m04:57:51.482533 [debug] [MainThread]: On master: COMMIT
[0m04:57:51.482533 [debug] [MainThread]: Using duckdb connection "master"
[0m04:57:51.484557 [debug] [MainThread]: On master: COMMIT
[0m04:57:51.484557 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:57:51.484557 [debug] [MainThread]: On master: Close
[0m04:57:51.488939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:57:51.488939 [info ] [MainThread]: 
[0m04:57:51.500260 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:57:51.500260 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:57:51.503768 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:57:51.500260 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_content_content_id .............................. [RUN]
[0m04:57:51.500260 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:57:51.505787 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7'
[0m04:57:51.507804 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:57:51.503768 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [RUN]
[0m04:57:51.518191 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c'
[0m04:57:51.532235 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:57:51.523886 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:57:51.538287 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:57:51.505787 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_users_user_id ................................... [RUN]
[0m04:57:51.507804 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_events_event_id ................................. [RUN]
[0m04:57:51.538287 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m04:57:51.541589 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012'
[0m04:57:51.542606 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:57:51.542606 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:57:51.550222 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:57:51.555591 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:57:51.557613 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:57:51.572251 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:57:51.572251 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:57:51.581896 [debug] [Thread-4 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:57:51.581896 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:57:51.584965 [debug] [Thread-3 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:57:51.584965 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:57:51.588909 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m04:57:51.588909 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:57:51.588909 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:57:51.592265 [debug] [Thread-2 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:57:51.596281 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:57:51.596281 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: BEGIN
[0m04:57:51.596281 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:57:51.592265 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:57:51.596281 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m04:57:51.596281 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:57:51.592265 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:57:51.598292 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: BEGIN
[0m04:57:51.598292 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:57:51.600304 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m04:57:51.600304 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m04:57:51.600304 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:57:51.604066 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m04:57:51.604066 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:57:51.604066 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m04:57:51.604066 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "warehouse"."main"."stg_events"
where event_id is null



      
    ) dbt_internal_test
[0m04:57:51.604066 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:57:51.604066 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "warehouse"."main"."stg_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'view','like','impression','follow','session_start'
)



      
    ) dbt_internal_test
[0m04:57:51.604066 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "warehouse"."main"."stg_users"
where user_id is null



      
    ) dbt_internal_test
[0m04:57:51.604066 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:57:51.604066 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select content_id
from "warehouse"."main"."stg_content"
where content_id is null



      
    ) dbt_internal_test
[0m04:57:51.635521 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "warehouse"."main"."stg_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'view','like','impression','follow','session_start'
)



      
    ) dbt_internal_test
[0m04:57:51.635521 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:57:51.635521 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: ROLLBACK
[0m04:57:51.639547 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "warehouse"."main"."stg_events"
where event_id is null



      
    ) dbt_internal_test
[0m04:57:51.639547 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:57:51.641561 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m04:57:51.643318 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select content_id
from "warehouse"."main"."stg_content"
where content_id is null



      
    ) dbt_internal_test
[0m04:57:51.645330 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:57:51.645330 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: ROLLBACK
[0m04:57:51.645330 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "warehouse"."main"."stg_users"
where user_id is null



      
    ) dbt_internal_test
[0m04:57:51.645330 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m04:57:51.645330 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m04:57:51.680195 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c'
[0m04:57:51.680195 [debug] [Thread-4 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m04:57:51.680195 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: Close
[0m04:57:51.680195 [debug] [Thread-2 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7'
[0m04:57:51.680195 [debug] [Thread-3 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012'
[0m04:57:51.688603 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m04:57:51.688603 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: Close
[0m04:57:51.691184 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: Close
[0m04:57:51.691184 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_users"
                ^
[0m04:57:51.694819 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_events_event_type__view__like__impression__follow__session_start (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 17:     from "warehouse"."main"."stg_events"
                    ^
[0m04:57:51.700966 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 14: from "warehouse"."main"."stg_content"
                ^
[0m04:57:51.694819 [error] [Thread-4 (]: 4 of 7 ERROR not_null_stg_users_user_id ........................................ [[31mERROR[0m in 0.16s]
[0m04:57:51.704008 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:57:51.706027 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:57:51.694819 [error] [Thread-1 (]: 1 of 7 ERROR accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [[31mERROR[0m in 0.18s]
[0m04:57:51.709355 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:57:51.700966 [error] [Thread-2 (]: 2 of 7 ERROR not_null_stg_content_content_id ................................... [[31mERROR[0m in 0.20s]
[0m04:57:51.709355 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:57:51.711188 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:57:51.708203 [info ] [Thread-4 (]: 5 of 7 START test unique_stg_content_content_id ................................ [RUN]
[0m04:57:51.711188 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:57:51.711188 [info ] [Thread-1 (]: 6 of 7 START test unique_stg_events_event_id ................................... [RUN]
[0m04:57:51.711188 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_events"
                ^
[0m04:57:51.711188 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77, now test.meta_product_analytics.unique_stg_content_content_id.a034585f1a)
[0m04:57:51.711188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c, now test.meta_product_analytics.unique_stg_events_event_id.66ebb17438)
[0m04:57:51.711188 [info ] [Thread-2 (]: 7 of 7 START test unique_stg_users_user_id ..................................... [RUN]
[0m04:57:51.711188 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:57:51.711188 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:57:51.711188 [error] [Thread-3 (]: 3 of 7 ERROR not_null_stg_events_event_id ...................................... [[31mERROR[0m in 0.17s]
[0m04:57:51.711188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7, now test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m04:57:51.722930 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:57:51.722930 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:57:51.722930 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:57:51.722930 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:57:51.741283 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:57:51.741283 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:57:51.741283 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:57:51.748310 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:57:51.748310 [debug] [Thread-4 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:57:51.748310 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:57:51.754450 [debug] [Thread-2 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:57:51.754450 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:57:51.754450 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:57:51.754450 [debug] [Thread-4 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: BEGIN
[0m04:57:51.754450 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: BEGIN
[0m04:57:51.754450 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:57:51.754450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:51.754450 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:57:51.754450 [debug] [Thread-2 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m04:57:51.754450 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:57:51.770186 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m04:57:51.770186 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m04:57:51.770186 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:57:51.770186 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m04:57:51.770186 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:57:51.770186 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:57:51.770186 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:57:51.770186 [debug] [Thread-2 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:57:51.770186 [debug] [Thread-4 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    content_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_content"
where content_id is not null
group by content_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:57:51.805980 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:57:51.805980 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    content_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_content"
where content_id is not null
group by content_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:57:51.805980 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:57:51.805980 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:57:51.805980 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m04:57:51.805980 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m04:57:51.805980 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:57:51.805980 [debug] [Thread-4 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: ROLLBACK
[0m04:57:51.805980 [debug] [Thread-2 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m04:57:51.805980 [debug] [Thread-4 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_content_content_id.a034585f1a'
[0m04:57:51.805980 [debug] [Thread-4 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: Close
[0m04:57:51.817911 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_events_event_id.66ebb17438'
[0m04:57:51.821945 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: Close
[0m04:57:51.821945 [debug] [Thread-4 (]: Runtime Error in test unique_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 15: from "warehouse"."main"."stg_content"
                ^
[0m04:57:51.821945 [debug] [Thread-2 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b'
[0m04:57:51.821945 [debug] [Thread-2 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m04:57:51.821945 [error] [Thread-4 (]: 5 of 7 ERROR unique_stg_content_content_id ..................................... [[31mERROR[0m in 0.11s]
[0m04:57:51.821945 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:57:51.833560 [debug] [Thread-1 (]: Runtime Error in test unique_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_events"
                ^
[0m04:57:51.833560 [error] [Thread-1 (]: 6 of 7 ERROR unique_stg_events_event_id ........................................ [[31mERROR[0m in 0.12s]
[0m04:57:51.833560 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:57:51.833560 [debug] [Thread-2 (]: Runtime Error in test unique_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_users"
                ^
[0m04:57:51.833560 [error] [Thread-2 (]: 7 of 7 ERROR unique_stg_users_user_id .......................................... [[31mERROR[0m in 0.12s]
[0m04:57:51.833560 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:57:51.833560 [debug] [MainThread]: Using duckdb connection "master"
[0m04:57:51.833560 [debug] [MainThread]: On master: BEGIN
[0m04:57:51.833560 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:57:51.849391 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:57:51.849391 [debug] [MainThread]: On master: COMMIT
[0m04:57:51.849391 [debug] [MainThread]: Using duckdb connection "master"
[0m04:57:51.849391 [debug] [MainThread]: On master: COMMIT
[0m04:57:51.849391 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:57:51.849391 [debug] [MainThread]: On master: Close
[0m04:57:51.849391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:57:51.859166 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:57:51.859166 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m04:57:51.859166 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_events_event_id.66ebb17438' was properly closed.
[0m04:57:51.859166 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_content_content_id.a034585f1a' was properly closed.
[0m04:57:51.859166 [debug] [MainThread]: Connection 'test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012' was properly closed.
[0m04:57:51.859166 [info ] [MainThread]: 
[0m04:57:51.859166 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m04:57:51.859166 [debug] [MainThread]: Command end result
[0m04:57:51.896739 [info ] [MainThread]: 
[0m04:57:51.896739 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m04:57:51.904301 [info ] [MainThread]: 
[0m04:57:51.904301 [error] [MainThread]:   Runtime Error in test not_null_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_users"
                ^
[0m04:57:51.904301 [info ] [MainThread]: 
[0m04:57:51.904301 [error] [MainThread]:   Runtime Error in test accepted_values_stg_events_event_type__view__like__impression__follow__session_start (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 17:     from "warehouse"."main"."stg_events"
                    ^
[0m04:57:51.904301 [info ] [MainThread]: 
[0m04:57:51.904301 [error] [MainThread]:   Runtime Error in test not_null_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 14: from "warehouse"."main"."stg_content"
                ^
[0m04:57:51.904301 [info ] [MainThread]: 
[0m04:57:51.904301 [error] [MainThread]:   Runtime Error in test not_null_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_events"
                ^
[0m04:57:51.912878 [info ] [MainThread]: 
[0m04:57:51.912878 [error] [MainThread]:   Runtime Error in test unique_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 15: from "warehouse"."main"."stg_content"
                ^
[0m04:57:51.912878 [info ] [MainThread]: 
[0m04:57:51.912878 [error] [MainThread]:   Runtime Error in test unique_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_events"
                ^
[0m04:57:51.921862 [info ] [MainThread]: 
[0m04:57:51.923875 [error] [MainThread]:   Runtime Error in test unique_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_users"
                ^
[0m04:57:51.923875 [info ] [MainThread]: 
[0m04:57:51.923875 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=0 TOTAL=7
[0m04:57:51.930936 [debug] [MainThread]: Command `dbt test` failed at 04:57:51.930936 after 3.14 seconds
[0m04:57:51.934350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEB9394C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEBB0B2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEBEF3740>]}
[0m04:57:51.934350 [debug] [MainThread]: Flushing usage events
[0m04:58:06.818104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3A46A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3A886A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3A886E10>]}


============================== 04:58:06.823900 | 91be1d95-d0a1-4f16-bce8-27206d14beac ==============================
[0m04:58:06.823900 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:58:06.823900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:58:07.126018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91be1d95-d0a1-4f16-bce8-27206d14beac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3B3FECF0>]}
[0m04:58:07.203485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91be1d95-d0a1-4f16-bce8-27206d14beac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3B0AD850>]}
[0m04:58:07.203485 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:58:07.620950 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:58:07.837712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:58:07.839725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:58:07.883031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91be1d95-d0a1-4f16-bce8-27206d14beac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3C744CE0>]}
[0m04:58:08.065395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91be1d95-d0a1-4f16-bce8-27206d14beac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3CA2C800>]}
[0m04:58:08.065395 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m04:58:08.065395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91be1d95-d0a1-4f16-bce8-27206d14beac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3C904650>]}
[0m04:58:08.079244 [info ] [MainThread]: 
[0m04:58:08.081275 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:58:08.088512 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:58:08.218894 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:58:08.218894 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:58:08.218894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:58:08.224732 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m04:58:08.224732 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:58:08.224732 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:58:08.271841 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m04:58:08.271841 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:58:08.271841 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:58:08.271841 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:58:08.271841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91be1d95-d0a1-4f16-bce8-27206d14beac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3C560CE0>]}
[0m04:58:08.285674 [debug] [MainThread]: Using duckdb connection "master"
[0m04:58:08.285674 [debug] [MainThread]: On master: BEGIN
[0m04:58:08.285674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:58:08.285674 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m04:58:08.285674 [debug] [MainThread]: On master: COMMIT
[0m04:58:08.285674 [debug] [MainThread]: Using duckdb connection "master"
[0m04:58:08.285674 [debug] [MainThread]: On master: COMMIT
[0m04:58:08.285674 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:58:08.285674 [debug] [MainThread]: On master: Close
[0m04:58:08.301486 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:58:08.301486 [info ] [MainThread]: 
[0m04:58:08.301486 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:58:08.301486 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:58:08.301486 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:58:08.301486 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:58:08.301486 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [RUN]
[0m04:58:08.314811 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_content_content_id .............................. [RUN]
[0m04:58:08.314811 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_events_event_id ................................. [RUN]
[0m04:58:08.317217 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c'
[0m04:58:08.317217 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7'
[0m04:58:08.314811 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_users_user_id ................................... [RUN]
[0m04:58:08.317217 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012'
[0m04:58:08.317217 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:58:08.322351 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:58:08.322351 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m04:58:08.322351 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:58:08.352765 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:58:08.364511 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:58:08.364511 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:58:08.364511 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:58:08.385325 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:58:08.390776 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:58:08.416264 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:58:08.425104 [debug] [Thread-2 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:58:08.428931 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:58:08.428931 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:58:08.428931 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:58:08.438695 [debug] [Thread-3 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:58:08.442026 [debug] [Thread-4 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:58:08.444041 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:58:08.445537 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: BEGIN
[0m04:58:08.445537 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:58:08.445537 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:58:08.445537 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: BEGIN
[0m04:58:08.448896 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:58:08.448896 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:58:08.451083 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:58:08.451083 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m04:58:08.451083 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m04:58:08.453100 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:58:08.453100 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:58:08.459143 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m04:58:08.460223 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m04:58:08.460223 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m04:58:08.462249 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:58:08.462249 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m04:58:08.462249 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:58:08.462249 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:58:08.462249 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "warehouse"."main"."stg_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'view','like','impression','follow','session_start'
)



      
    ) dbt_internal_test
[0m04:58:08.462249 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:58:08.462249 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "warehouse"."main"."stg_users"
where user_id is null



      
    ) dbt_internal_test
[0m04:58:08.462249 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "warehouse"."main"."stg_events"
where event_id is null



      
    ) dbt_internal_test
[0m04:58:08.462249 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select content_id
from "warehouse"."main"."stg_content"
where content_id is null



      
    ) dbt_internal_test
[0m04:58:08.503862 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "warehouse"."main"."stg_users"
where user_id is null



      
    ) dbt_internal_test
[0m04:58:08.505876 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select content_id
from "warehouse"."main"."stg_content"
where content_id is null



      
    ) dbt_internal_test
[0m04:58:08.505876 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "warehouse"."main"."stg_events"
where event_id is null



      
    ) dbt_internal_test
[0m04:58:08.505876 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:08.507630 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "warehouse"."main"."stg_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'view','like','impression','follow','session_start'
)



      
    ) dbt_internal_test
[0m04:58:08.508551 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:08.508551 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:08.508551 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m04:58:08.508551 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:08.508551 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: ROLLBACK
[0m04:58:08.508551 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m04:58:08.508551 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: ROLLBACK
[0m04:58:08.529470 [debug] [Thread-3 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012'
[0m04:58:08.529470 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: Close
[0m04:58:08.531482 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c'
[0m04:58:08.531482 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: Close
[0m04:58:08.534656 [debug] [Thread-2 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7'
[0m04:58:08.534656 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: Close
[0m04:58:08.538550 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_events"
                ^
[0m04:58:08.543100 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_events_event_type__view__like__impression__follow__session_start (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 17:     from "warehouse"."main"."stg_events"
                    ^
[0m04:58:08.543100 [debug] [Thread-4 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m04:58:08.540562 [error] [Thread-3 (]: 3 of 7 ERROR not_null_stg_events_event_id ...................................... [[31mERROR[0m in 0.22s]
[0m04:58:08.543100 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m04:58:08.543100 [error] [Thread-1 (]: 1 of 7 ERROR accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [[31mERROR[0m in 0.23s]
[0m04:58:08.543100 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 14: from "warehouse"."main"."stg_content"
                ^
[0m04:58:08.543100 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:58:08.543100 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:58:08.543100 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:58:08.554273 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:58:08.543100 [error] [Thread-2 (]: 2 of 7 ERROR not_null_stg_content_content_id ................................... [[31mERROR[0m in 0.23s]
[0m04:58:08.556293 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:58:08.556293 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:58:08.556293 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_users"
                ^
[0m04:58:08.543100 [info ] [Thread-3 (]: 5 of 7 START test unique_stg_content_content_id ................................ [RUN]
[0m04:58:08.556293 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012, now test.meta_product_analytics.unique_stg_content_content_id.a034585f1a)
[0m04:58:08.556293 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:58:08.556293 [info ] [Thread-1 (]: 6 of 7 START test unique_stg_events_event_id ................................... [RUN]
[0m04:58:08.570200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c, now test.meta_product_analytics.unique_stg_events_event_id.66ebb17438)
[0m04:58:08.572214 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:58:08.556293 [info ] [Thread-2 (]: 7 of 7 START test unique_stg_users_user_id ..................................... [RUN]
[0m04:58:08.572214 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:58:08.572214 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:58:08.572214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7, now test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m04:58:08.556293 [error] [Thread-4 (]: 4 of 7 ERROR not_null_stg_users_user_id ........................................ [[31mERROR[0m in 0.23s]
[0m04:58:08.586765 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:58:08.588782 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:58:08.588782 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:58:08.588782 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:58:08.595861 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:58:08.597883 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:58:08.607657 [debug] [Thread-3 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:58:08.607657 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:58:08.607657 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:58:08.607657 [debug] [Thread-2 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:58:08.607657 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: BEGIN
[0m04:58:08.607657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:08.617372 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:58:08.617372 [debug] [Thread-3 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: BEGIN
[0m04:58:08.617372 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:58:08.617372 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:58:08.621625 [debug] [Thread-2 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m04:58:08.621625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:58:08.627672 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m04:58:08.627672 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m04:58:08.627672 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:58:08.627672 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:58:08.627672 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:08.627672 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m04:58:08.633021 [debug] [Thread-3 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    content_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_content"
where content_id is not null
group by content_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:08.633021 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:58:08.635032 [debug] [Thread-2 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:08.665003 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:08.665003 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:08.665003 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    content_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_content"
where content_id is not null
group by content_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:08.665003 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:08.665003 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:08.665003 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:08.665003 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m04:58:08.665003 [debug] [Thread-2 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m04:58:08.665003 [debug] [Thread-3 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: ROLLBACK
[0m04:58:08.665003 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_events_event_id.66ebb17438'
[0m04:58:08.665003 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: Close
[0m04:58:08.665003 [debug] [Thread-2 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b'
[0m04:58:08.680699 [debug] [Thread-2 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m04:58:08.680699 [debug] [Thread-3 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_content_content_id.a034585f1a'
[0m04:58:08.680699 [debug] [Thread-3 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: Close
[0m04:58:08.680699 [debug] [Thread-1 (]: Runtime Error in test unique_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_events"
                ^
[0m04:58:08.690919 [debug] [Thread-2 (]: Runtime Error in test unique_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_users"
                ^
[0m04:58:08.680699 [error] [Thread-1 (]: 6 of 7 ERROR unique_stg_events_event_id ........................................ [[31mERROR[0m in 0.11s]
[0m04:58:08.690919 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:58:08.690919 [error] [Thread-2 (]: 7 of 7 ERROR unique_stg_users_user_id .......................................... [[31mERROR[0m in 0.12s]
[0m04:58:08.690919 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:58:08.696703 [debug] [Thread-3 (]: Runtime Error in test unique_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 15: from "warehouse"."main"."stg_content"
                ^
[0m04:58:08.696703 [error] [Thread-3 (]: 5 of 7 ERROR unique_stg_content_content_id ..................................... [[31mERROR[0m in 0.14s]
[0m04:58:08.696703 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:58:08.696703 [debug] [MainThread]: Using duckdb connection "master"
[0m04:58:08.696703 [debug] [MainThread]: On master: BEGIN
[0m04:58:08.696703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:58:08.712794 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m04:58:08.712794 [debug] [MainThread]: On master: COMMIT
[0m04:58:08.712794 [debug] [MainThread]: Using duckdb connection "master"
[0m04:58:08.712794 [debug] [MainThread]: On master: COMMIT
[0m04:58:08.712794 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:58:08.712794 [debug] [MainThread]: On master: Close
[0m04:58:08.724616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:58:08.724616 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:58:08.724616 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_events_event_id.66ebb17438' was properly closed.
[0m04:58:08.724616 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m04:58:08.724616 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_content_content_id.a034585f1a' was properly closed.
[0m04:58:08.724616 [debug] [MainThread]: Connection 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m04:58:08.724616 [info ] [MainThread]: 
[0m04:58:08.728534 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m04:58:08.728534 [debug] [MainThread]: Command end result
[0m04:58:08.779485 [info ] [MainThread]: 
[0m04:58:08.779485 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m04:58:08.779485 [info ] [MainThread]: 
[0m04:58:08.779485 [error] [MainThread]:   Runtime Error in test not_null_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_events"
                ^
[0m04:58:08.791916 [info ] [MainThread]: 
[0m04:58:08.791916 [error] [MainThread]:   Runtime Error in test accepted_values_stg_events_event_type__view__like__impression__follow__session_start (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 17:     from "warehouse"."main"."stg_events"
                    ^
[0m04:58:08.791916 [info ] [MainThread]: 
[0m04:58:08.791916 [error] [MainThread]:   Runtime Error in test not_null_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 14: from "warehouse"."main"."stg_content"
                ^
[0m04:58:08.791916 [info ] [MainThread]: 
[0m04:58:08.791916 [error] [MainThread]:   Runtime Error in test not_null_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_users"
                ^
[0m04:58:08.791916 [info ] [MainThread]: 
[0m04:58:08.791916 [error] [MainThread]:   Runtime Error in test unique_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_events"
                ^
[0m04:58:08.791916 [info ] [MainThread]: 
[0m04:58:08.791916 [error] [MainThread]:   Runtime Error in test unique_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_users"
                ^
[0m04:58:08.791916 [info ] [MainThread]: 
[0m04:58:08.791916 [error] [MainThread]:   Runtime Error in test unique_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 15: from "warehouse"."main"."stg_content"
                ^
[0m04:58:08.791916 [info ] [MainThread]: 
[0m04:58:08.791916 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=0 TOTAL=7
[0m04:58:08.807699 [debug] [MainThread]: Command `dbt test` failed at 04:58:08.791916 after 2.19 seconds
[0m04:58:08.807699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3A9C1CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3A9C0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3B0FE480>]}
[0m04:58:08.809711 [debug] [MainThread]: Flushing usage events
[0m04:58:15.730520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8183F71D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F816073110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81876D100>]}


============================== 04:58:15.736739 | e1447573-abd8-45ea-9d01-5150a1afad4e ==============================
[0m04:58:15.736739 [info ] [MainThread]: Running with dbt=1.8.6
[0m04:58:24.472671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\khema\\.dbt', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:58:24.819804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1447573-abd8-45ea-9d01-5150a1afad4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81A74A8A0>]}
[0m04:58:24.921616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1447573-abd8-45ea-9d01-5150a1afad4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F818490C20>]}
[0m04:58:24.923629 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m04:58:25.311940 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m04:58:25.496423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:58:25.496423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:58:25.548968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1447573-abd8-45ea-9d01-5150a1afad4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81A9D4920>]}
[0m04:58:25.711287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1447573-abd8-45ea-9d01-5150a1afad4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81ACB8860>]}
[0m04:58:25.711287 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m04:58:25.719132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1447573-abd8-45ea-9d01-5150a1afad4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F818B53BF0>]}
[0m04:58:25.722939 [info ] [MainThread]: 
[0m04:58:25.722939 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:58:25.726044 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m04:58:25.850206 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:58:25.850206 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m04:58:25.852219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:58:25.875608 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m04:58:25.875608 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m04:58:25.875608 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m04:58:25.920853 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m04:58:25.922871 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m04:58:25.922871 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m04:58:25.922871 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m04:58:25.926787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1447573-abd8-45ea-9d01-5150a1afad4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81AB9B440>]}
[0m04:58:25.926787 [debug] [MainThread]: Using duckdb connection "master"
[0m04:58:25.926787 [debug] [MainThread]: On master: BEGIN
[0m04:58:25.926787 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:58:25.937631 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m04:58:25.937631 [debug] [MainThread]: On master: COMMIT
[0m04:58:25.937631 [debug] [MainThread]: Using duckdb connection "master"
[0m04:58:25.937631 [debug] [MainThread]: On master: COMMIT
[0m04:58:25.937631 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:58:25.942744 [debug] [MainThread]: On master: Close
[0m04:58:25.942744 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:58:25.942744 [info ] [MainThread]: 
[0m04:58:25.942744 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:58:25.942744 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:58:25.955134 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:58:25.942744 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [RUN]
[0m04:58:25.955134 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:58:25.955134 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_content_content_id .............................. [RUN]
[0m04:58:25.958850 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c'
[0m04:58:25.955134 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_events_event_id ................................. [RUN]
[0m04:58:25.958850 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7'
[0m04:58:25.958850 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_users_user_id ................................... [RUN]
[0m04:58:25.958850 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:58:25.958850 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012'
[0m04:58:25.958850 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:58:25.958850 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m04:58:25.987679 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:58:25.987679 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:58:25.990628 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:58:25.990628 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:58:26.007542 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:58:26.007542 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:58:26.007542 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:58:26.022846 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:58:26.040530 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:58:26.040530 [debug] [Thread-2 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:58:26.049670 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:58:26.056526 [debug] [Thread-4 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:58:26.057483 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:58:26.058462 [debug] [Thread-3 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:58:26.058462 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:58:26.058462 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:58:26.064388 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: BEGIN
[0m04:58:26.065121 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:58:26.066138 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m04:58:26.066138 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:58:26.066138 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:58:26.068159 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: BEGIN
[0m04:58:26.070174 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:58:26.068159 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:58:26.068159 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m04:58:26.073673 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:58:26.073673 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m04:58:26.073673 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m04:58:26.073673 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select content_id
from "warehouse"."main"."stg_content"
where content_id is null



      
    ) dbt_internal_test
[0m04:58:26.073673 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m04:58:26.073673 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m04:58:26.073673 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m04:58:26.073673 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m04:58:26.088184 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m04:58:26.073673 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m04:58:26.086163 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "warehouse"."main"."stg_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'view','like','impression','follow','session_start'
)



      
    ) dbt_internal_test
[0m04:58:26.088184 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "warehouse"."main"."stg_users"
where user_id is null



      
    ) dbt_internal_test
[0m04:58:26.088184 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "warehouse"."main"."stg_events"
where event_id is null



      
    ) dbt_internal_test
[0m04:58:26.119498 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "warehouse"."main"."stg_events"
where event_id is null



      
    ) dbt_internal_test
[0m04:58:26.121517 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:26.121517 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select content_id
from "warehouse"."main"."stg_content"
where content_id is null



      
    ) dbt_internal_test
[0m04:58:26.121517 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "warehouse"."main"."stg_users"
where user_id is null



      
    ) dbt_internal_test
[0m04:58:26.123537 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m04:58:26.123537 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:26.123537 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:26.123537 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: ROLLBACK
[0m04:58:26.123537 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "warehouse"."main"."stg_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'view','like','impression','follow','session_start'
)



      
    ) dbt_internal_test
[0m04:58:26.123537 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m04:58:26.123537 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:26.123537 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: ROLLBACK
[0m04:58:26.139943 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c'
[0m04:58:26.139943 [debug] [Thread-3 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012'
[0m04:58:26.149828 [debug] [Thread-4 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m04:58:26.149828 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: Close
[0m04:58:26.155142 [debug] [Thread-2 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7'
[0m04:58:26.155142 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: Close
[0m04:58:26.155142 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m04:58:26.155142 [debug] [Thread-2 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: Close
[0m04:58:26.155142 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_users"
                ^
[0m04:58:26.155142 [error] [Thread-4 (]: 4 of 7 ERROR not_null_stg_users_user_id ........................................ [[31mERROR[0m in 0.20s]
[0m04:58:26.166173 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m04:58:26.166173 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:58:26.166173 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_events_event_type__view__like__impression__follow__session_start (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 17:     from "warehouse"."main"."stg_events"
                    ^
[0m04:58:26.166173 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_events"
                ^
[0m04:58:26.166173 [info ] [Thread-4 (]: 5 of 7 START test unique_stg_content_content_id ................................ [RUN]
[0m04:58:26.172386 [error] [Thread-1 (]: 1 of 7 ERROR accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [[31mERROR[0m in 0.21s]
[0m04:58:26.172386 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77, now test.meta_product_analytics.unique_stg_content_content_id.a034585f1a)
[0m04:58:26.172386 [error] [Thread-3 (]: 3 of 7 ERROR not_null_stg_events_event_id ...................................... [[31mERROR[0m in 0.21s]
[0m04:58:26.172386 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 14: from "warehouse"."main"."stg_content"
                ^
[0m04:58:26.172386 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m04:58:26.172386 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:58:26.172386 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m04:58:26.180834 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:58:26.180834 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:58:26.172386 [error] [Thread-2 (]: 2 of 7 ERROR not_null_stg_content_content_id ................................... [[31mERROR[0m in 0.21s]
[0m04:58:26.180834 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:58:26.180834 [info ] [Thread-1 (]: 6 of 7 START test unique_stg_events_event_id ................................... [RUN]
[0m04:58:26.180834 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m04:58:26.196625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c, now test.meta_product_analytics.unique_stg_events_event_id.66ebb17438)
[0m04:58:26.180834 [info ] [Thread-3 (]: 7 of 7 START test unique_stg_users_user_id ..................................... [RUN]
[0m04:58:26.196625 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:58:26.196625 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:58:26.196625 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012, now test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m04:58:26.203249 [debug] [Thread-4 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:58:26.207288 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:58:26.212432 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:58:26.219520 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:58:26.221546 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:58:26.223581 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:58:26.223581 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:58:26.228073 [debug] [Thread-4 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: BEGIN
[0m04:58:26.228073 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:58:26.228073 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:58:26.228073 [debug] [Thread-3 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:58:26.228073 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:58:26.228073 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: BEGIN
[0m04:58:26.228073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:26.228073 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:58:26.228073 [debug] [Thread-3 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m04:58:26.238960 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:58:26.246013 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m04:58:26.246013 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m04:58:26.246013 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m04:58:26.246013 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m04:58:26.246013 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m04:58:26.246013 [debug] [Thread-3 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:26.246013 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m04:58:26.246013 [debug] [Thread-4 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    content_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_content"
where content_id is not null
group by content_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:26.246013 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:26.295631 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:26.297649 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    content_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_content"
where content_id is not null
group by content_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:26.297649 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:26.297649 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:26.297649 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:26.297649 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m04:58:26.297649 [debug] [Thread-3 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m04:58:26.297649 [debug] [Thread-4 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: ROLLBACK
[0m04:58:26.297649 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m04:58:26.307950 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_events_event_id.66ebb17438'
[0m04:58:26.325069 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: Close
[0m04:58:26.338964 [debug] [Thread-4 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_content_content_id.a034585f1a'
[0m04:58:26.362331 [debug] [Thread-4 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: Close
[0m04:58:26.369674 [debug] [Thread-3 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b'
[0m04:58:26.374602 [debug] [Thread-3 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m04:58:26.378621 [debug] [Thread-1 (]: Runtime Error in test unique_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_events"
                ^
[0m04:58:26.384641 [debug] [Thread-4 (]: Runtime Error in test unique_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 15: from "warehouse"."main"."stg_content"
                ^
[0m04:58:26.388160 [error] [Thread-1 (]: 6 of 7 ERROR unique_stg_events_event_id ........................................ [[31mERROR[0m in 0.19s]
[0m04:58:26.398248 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m04:58:26.390167 [error] [Thread-4 (]: 5 of 7 ERROR unique_stg_content_content_id ..................................... [[31mERROR[0m in 0.22s]
[0m04:58:26.401713 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m04:58:26.403693 [debug] [Thread-3 (]: Runtime Error in test unique_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_users"
                ^
[0m04:58:26.403693 [error] [Thread-3 (]: 7 of 7 ERROR unique_stg_users_user_id .......................................... [[31mERROR[0m in 0.21s]
[0m04:58:26.407871 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m04:58:26.409699 [debug] [MainThread]: Using duckdb connection "master"
[0m04:58:26.409699 [debug] [MainThread]: On master: BEGIN
[0m04:58:26.409699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:58:26.421921 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m04:58:26.421921 [debug] [MainThread]: On master: COMMIT
[0m04:58:26.423357 [debug] [MainThread]: Using duckdb connection "master"
[0m04:58:26.423357 [debug] [MainThread]: On master: COMMIT
[0m04:58:26.423357 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:58:26.423357 [debug] [MainThread]: On master: Close
[0m04:58:26.423357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:58:26.423357 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m04:58:26.423357 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_events_event_id.66ebb17438' was properly closed.
[0m04:58:26.423357 [debug] [MainThread]: Connection 'test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7' was properly closed.
[0m04:58:26.423357 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m04:58:26.423357 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_content_content_id.a034585f1a' was properly closed.
[0m04:58:26.423357 [info ] [MainThread]: 
[0m04:58:26.423357 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m04:58:26.423357 [debug] [MainThread]: Command end result
[0m04:58:26.473024 [info ] [MainThread]: 
[0m04:58:26.482747 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m04:58:26.484790 [info ] [MainThread]: 
[0m04:58:26.484790 [error] [MainThread]:   Runtime Error in test not_null_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_users"
                ^
[0m04:58:26.484790 [info ] [MainThread]: 
[0m04:58:26.484790 [error] [MainThread]:   Runtime Error in test accepted_values_stg_events_event_type__view__like__impression__follow__session_start (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 17:     from "warehouse"."main"."stg_events"
                    ^
[0m04:58:26.488513 [info ] [MainThread]: 
[0m04:58:26.488513 [error] [MainThread]:   Runtime Error in test not_null_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 14: from "warehouse"."main"."stg_events"
                ^
[0m04:58:26.488513 [info ] [MainThread]: 
[0m04:58:26.488513 [error] [MainThread]:   Runtime Error in test not_null_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 14: from "warehouse"."main"."stg_content"
                ^
[0m04:58:26.488513 [info ] [MainThread]: 
[0m04:58:26.488513 [error] [MainThread]:   Runtime Error in test unique_stg_events_event_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_events does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_events"
                ^
[0m04:58:26.488513 [info ] [MainThread]: 
[0m04:58:26.488513 [error] [MainThread]:   Runtime Error in test unique_stg_content_content_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_content does not exist!
  Did you mean "duckdb_constraints"?
  LINE 15: from "warehouse"."main"."stg_content"
                ^
[0m04:58:26.488513 [info ] [MainThread]: 
[0m04:58:26.488513 [error] [MainThread]:   Runtime Error in test unique_stg_users_user_id (models\staging\schema.yml)
  Catalog Error: Table with name stg_users does not exist!
  Did you mean "sqlite_master"?
  LINE 15: from "warehouse"."main"."stg_users"
                ^
[0m04:58:26.488513 [info ] [MainThread]: 
[0m04:58:26.499289 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=0 TOTAL=7
[0m04:58:26.499289 [debug] [MainThread]: Command `dbt test` failed at 04:58:26.499289 after 10.96 seconds
[0m04:58:26.499289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8183F71D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F818C23740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F818C234A0>]}
[0m04:58:26.499289 [debug] [MainThread]: Flushing usage events
[0m05:03:25.259391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC388A06E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC3647B2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC3887C290>]}


============================== 05:03:25.267624 | 3e6304c6-5eee-4a7a-bf83-f223a9d1d6cc ==============================
[0m05:03:25.267624 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:03:25.267624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:03:25.319592 [info ] [MainThread]: dbt version: 1.8.6
[0m05:03:25.319592 [info ] [MainThread]: python version: 3.12.10
[0m05:03:25.319592 [info ] [MainThread]: python path: C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Scripts\python.exe
[0m05:03:25.319592 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m05:03:25.521195 [info ] [MainThread]: Using profiles dir at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project
[0m05:03:25.523207 [info ] [MainThread]: Using profiles.yml file at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\profiles.yml
[0m05:03:25.524970 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\dbt_project.yml
[0m05:03:25.536147 [info ] [MainThread]: adapter type: duckdb
[0m05:03:25.537659 [info ] [MainThread]: adapter version: 1.8.2
[0m05:03:25.651985 [info ] [MainThread]: Configuration:
[0m05:03:25.651985 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:03:25.651985 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:03:25.666852 [info ] [MainThread]: Required dependencies:
[0m05:03:25.667737 [debug] [MainThread]: Executing "git --help"
[0m05:03:25.745341 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:03:25.746580 [debug] [MainThread]: STDERR: "b''"
[0m05:03:25.747595 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:03:25.748158 [info ] [MainThread]: Connection:
[0m05:03:25.752192 [info ] [MainThread]:   database: warehouse
[0m05:03:25.753586 [info ] [MainThread]:   schema: main
[0m05:03:25.755027 [info ] [MainThread]:   path: C:/Users/khema/Downloads/meta_product_analytics_de_project/meta_product_analytics_de_project/dbt_project/infra/warehouse.duckdb
[0m05:03:25.756064 [info ] [MainThread]:   config_options: None
[0m05:03:25.757018 [info ] [MainThread]:   extensions: None
[0m05:03:25.758144 [info ] [MainThread]:   settings: {}
[0m05:03:25.759283 [info ] [MainThread]:   external_root: .
[0m05:03:25.759283 [info ] [MainThread]:   use_credential_provider: None
[0m05:03:25.759283 [info ] [MainThread]:   attach: None
[0m05:03:25.761568 [info ] [MainThread]:   filesystems: None
[0m05:03:25.763309 [info ] [MainThread]:   remote: None
[0m05:03:25.768304 [info ] [MainThread]:   plugins: None
[0m05:03:25.768304 [info ] [MainThread]:   disable_transactions: False
[0m05:03:25.768304 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:03:26.144853 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:03:26.258314 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:03:26.258314 [debug] [MainThread]: On debug: select 1 as id
[0m05:03:26.260328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:03:26.278468 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m05:03:26.278468 [debug] [MainThread]: On debug: Close
[0m05:03:26.280487 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:03:26.285705 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:03:26.289735 [debug] [MainThread]: Command `dbt debug` succeeded at 05:03:26.289735 after 1.29 seconds
[0m05:03:26.289735 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:03:26.291748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC394143E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC39A36390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC38D0F5C0>]}
[0m05:03:26.291748 [debug] [MainThread]: Flushing usage events
[0m05:06:03.157114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AB6B4C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AE18D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AE81C770>]}


============================== 05:06:03.167605 | ac743e68-0a68-40f8-b9bb-abaf591b5039 ==============================
[0m05:06:03.167605 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:06:03.167605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m05:06:03.447088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac743e68-0a68-40f8-b9bb-abaf591b5039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AFE67830>]}
[0m05:06:03.512238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac743e68-0a68-40f8-b9bb-abaf591b5039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AED0EEA0>]}
[0m05:06:03.512238 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:06:03.854536 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m05:06:03.997725 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:06:04.006880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac743e68-0a68-40f8-b9bb-abaf591b5039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B01D4050>]}
[0m05:06:05.141414 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:06:05.143428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac743e68-0a68-40f8-b9bb-abaf591b5039', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B01951F0>]}
[0m05:06:05.520518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac743e68-0a68-40f8-b9bb-abaf591b5039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B03B08F0>]}
[0m05:06:05.679659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac743e68-0a68-40f8-b9bb-abaf591b5039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B02C2AE0>]}
[0m05:06:05.681676 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m05:06:05.686789 [info ] [MainThread]: 
[0m05:06:05.686789 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:06:05.696607 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m05:06:05.817429 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m05:06:05.817429 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m05:06:05.817429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:06:05.831446 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m05:06:05.831446 [debug] [ThreadPool]: On list_warehouse: Close
[0m05:06:05.831446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m05:06:05.831446 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m05:06:05.845317 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:06:05.845317 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m05:06:05.845317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:06:05.861066 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m05:06:05.861066 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:06:05.861066 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m05:06:05.861066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:06:05.861066 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:06:05.861066 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m05:06:05.861066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:06:05.861066 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m05:06:05.861066 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:06:05.861066 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m05:06:05.861066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:06:05.861066 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m05:06:05.880181 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m05:06:05.884217 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:06:05.884217 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m05:06:05.884217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:06:05.906482 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m05:06:05.906482 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:06:05.908503 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m05:06:05.971665 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m05:06:05.973683 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m05:06:05.975709 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m05:06:05.975709 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m05:06:05.981029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac743e68-0a68-40f8-b9bb-abaf591b5039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B03128D0>]}
[0m05:06:05.981029 [debug] [MainThread]: Using duckdb connection "master"
[0m05:06:05.981029 [debug] [MainThread]: On master: BEGIN
[0m05:06:05.981029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:06:05.998724 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m05:06:05.998724 [debug] [MainThread]: On master: COMMIT
[0m05:06:05.998724 [debug] [MainThread]: Using duckdb connection "master"
[0m05:06:05.998724 [debug] [MainThread]: On master: COMMIT
[0m05:06:06.000744 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:06:06.000744 [debug] [MainThread]: On master: Close
[0m05:06:06.003561 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:06:06.005593 [info ] [MainThread]: 
[0m05:06:06.019684 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m05:06:06.019684 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m05:06:06.030984 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m05:06:06.019684 [info ] [Thread-1 (]: 1 of 14 START sql view model main.stg_content .................................. [RUN]
[0m05:06:06.035432 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m05:06:06.035432 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m05:06:06.030984 [info ] [Thread-2 (]: 2 of 14 START sql view model main.stg_events ................................... [RUN]
[0m05:06:06.045782 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m05:06:06.045782 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m05:06:06.030984 [info ] [Thread-3 (]: 3 of 14 START sql view model main.stg_users .................................... [RUN]
[0m05:06:06.045782 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m05:06:06.045782 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m05:06:06.051634 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m05:06:06.051634 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m05:06:06.051634 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m05:06:06.084078 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m05:06:06.108561 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m05:06:06.108561 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m05:06:06.110133 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m05:06:06.113754 [debug] [Thread-3 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m05:06:06.117778 [debug] [Thread-2 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m05:06:06.117778 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:06:06.117778 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m05:06:06.117778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:06:06.121547 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:06:06.121547 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m05:06:06.123558 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:06:06.123558 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:06:06.123558 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m05:06:06.123558 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m05:06:06.131613 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m05:06:06.131613 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:06:06.131613 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw
  );

[0m05:06:06.134387 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m05:06:06.134387 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m05:06:06.134387 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:06:06.134387 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:06:06.134387 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw
  );

[0m05:06:06.134387 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw
  );

[0m05:06:06.134387 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:06:06.145292 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:06:06.145292 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content" rename to "stg_content__dbt_backup"
[0m05:06:06.145292 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m05:06:06.145292 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m05:06:06.154593 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:06:06.154593 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:06:06.154593 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m05:06:06.154593 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m05:06:06.161268 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m05:06:06.165346 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:06:06.167360 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content__dbt_tmp" rename to "stg_content"
[0m05:06:06.167360 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m05:06:06.167360 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:06:06.167360 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m05:06:06.167360 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m05:06:06.167360 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m05:06:06.177087 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:06:06.205773 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m05:06:06.205773 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m05:06:06.205773 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m05:06:06.205773 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:06:06.210078 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m05:06:06.210078 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m05:06:06.210078 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:06:06.210078 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m05:06:06.210078 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m05:06:06.216373 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m05:06:06.217385 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:06:06.217385 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m05:06:06.222107 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m05:06:06.224701 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:06:06.224701 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
drop view if exists "warehouse"."main"."stg_content__dbt_backup" cascade
[0m05:06:06.224701 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m05:06:06.224701 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m05:06:06.224701 [debug] [Thread-2 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:06:06.240639 [debug] [Thread-3 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:06:06.240639 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
drop view if exists "warehouse"."main"."stg_events__dbt_backup" cascade
[0m05:06:06.240639 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
drop view if exists "warehouse"."main"."stg_users__dbt_backup" cascade
[0m05:06:06.240639 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m05:06:06.248615 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m05:06:06.253010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac743e68-0a68-40f8-b9bb-abaf591b5039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AE1F1F70>]}
[0m05:06:06.253010 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m05:06:06.256417 [debug] [Thread-2 (]: On model.meta_product_analytics.stg_events: Close
[0m05:06:06.253010 [info ] [Thread-1 (]: 1 of 14 OK created sql view model main.stg_content ............................. [[32mOK[0m in 0.22s]
[0m05:06:06.256417 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m05:06:06.256417 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m05:06:06.256417 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac743e68-0a68-40f8-b9bb-abaf591b5039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B0882360>]}
[0m05:06:06.262592 [debug] [Thread-3 (]: On model.meta_product_analytics.stg_users: Close
[0m05:06:06.265543 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:06:06.262592 [info ] [Thread-2 (]: 2 of 14 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.21s]
[0m05:06:06.265543 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:06:06.265543 [info ] [Thread-4 (]: 4 of 14 START test not_null_stg_content_content_id ............................. [RUN]
[0m05:06:06.265543 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m05:06:06.265543 [info ] [Thread-1 (]: 5 of 14 START test unique_stg_content_content_id ............................... [RUN]
[0m05:06:06.272090 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7'
[0m05:06:06.274109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now test.meta_product_analytics.unique_stg_content_content_id.a034585f1a)
[0m05:06:06.274109 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:06:06.274109 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:06:06.274109 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac743e68-0a68-40f8-b9bb-abaf591b5039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B0881B20>]}
[0m05:06:06.274109 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:06:06.278643 [info ] [Thread-2 (]: 6 of 14 START test accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [RUN]
[0m05:06:06.288206 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:06:06.304169 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:06:06.288206 [info ] [Thread-3 (]: 3 of 14 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.23s]
[0m05:06:06.304169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c)
[0m05:06:06.304169 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m05:06:06.304169 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:06:06.310182 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:06:06.310182 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:06:06.318387 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:06:06.318387 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:06:06.320173 [info ] [Thread-3 (]: 7 of 14 START test not_null_stg_events_event_id ................................ [RUN]
[0m05:06:06.342126 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:06:06.347729 [debug] [Thread-4 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:06:06.347729 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012)
[0m05:06:06.347729 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:06:06.347729 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:06:06.354120 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:06:06.354120 [debug] [Thread-2 (]: Writing runtime sql for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:06:06.354120 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:06:06.354120 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:06:06.364070 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: BEGIN
[0m05:06:06.364070 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: BEGIN
[0m05:06:06.364070 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:06:06.364070 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:06:06.367773 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:06:06.367773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:06.367773 [debug] [Thread-2 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: BEGIN
[0m05:06:06.372191 [debug] [Thread-3 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:06:06.374203 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:06:06.375676 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:06:06.376568 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m05:06:06.376568 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:06:06.402366 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m05:06:06.402366 [debug] [Thread-2 (]: SQL status: OK in 0.031 seconds
[0m05:06:06.402366 [debug] [Thread-3 (]: SQL status: OK in 0.028 seconds
[0m05:06:06.402366 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:06:06.402366 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m05:06:06.402366 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:06:06.402366 [debug] [Thread-3 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:06:06.402366 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select content_id
from "warehouse"."main"."stg_content"
where content_id is null



      
    ) dbt_internal_test
[0m05:06:06.402366 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:06:06.410218 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    content_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_content"
where content_id is not null
group by content_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:06:06.410218 [debug] [Thread-2 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "warehouse"."main"."stg_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'view','like','impression','follow','session_start'
)



      
    ) dbt_internal_test
[0m05:06:06.410218 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "warehouse"."main"."stg_events"
where event_id is null



      
    ) dbt_internal_test
[0m05:06:06.420347 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m05:06:06.426573 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: ROLLBACK
[0m05:06:06.428586 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m05:06:06.428586 [debug] [Thread-4 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7'
[0m05:06:06.431007 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m05:06:06.431007 [debug] [Thread-4 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: Close
[0m05:06:06.434462 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: ROLLBACK
[0m05:06:06.434462 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m05:06:06.434462 [debug] [Thread-2 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: ROLLBACK
[0m05:06:06.434462 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_content_content_id.a034585f1a'
[0m05:06:06.434462 [info ] [Thread-4 (]: 4 of 14 PASS not_null_stg_content_content_id ................................... [[32mPASS[0m in 0.17s]
[0m05:06:06.443722 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m05:06:06.443722 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: Close
[0m05:06:06.443722 [debug] [Thread-2 (]: Failed to rollback 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c'
[0m05:06:06.447034 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:06:06.450077 [debug] [Thread-3 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012'
[0m05:06:06.447034 [info ] [Thread-1 (]: 5 of 14 PASS unique_stg_content_content_id ..................................... [[32mPASS[0m in 0.17s]
[0m05:06:06.450077 [debug] [Thread-2 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: Close
[0m05:06:06.450077 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:06:06.450077 [debug] [Thread-3 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: Close
[0m05:06:06.450077 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:06:06.450077 [info ] [Thread-2 (]: 6 of 14 PASS accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [[32mPASS[0m in 0.15s]
[0m05:06:06.450077 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:06:06.450077 [info ] [Thread-4 (]: 8 of 14 START test unique_stg_events_event_id .................................. [RUN]
[0m05:06:06.450077 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:06:06.463135 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7, now test.meta_product_analytics.unique_stg_events_event_id.66ebb17438)
[0m05:06:06.465153 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:06:06.462113 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_users_user_id .................................. [RUN]
[0m05:06:06.465153 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:06:06.467417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_content_content_id.a034585f1a, now test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m05:06:06.473964 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:06:06.475980 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:06:06.485692 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:06:06.485692 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:06:06.493037 [debug] [Thread-4 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:06:06.467417 [info ] [Thread-2 (]: 10 of 14 START test unique_stg_users_user_id ................................... [RUN]
[0m05:06:06.495049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c, now test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m05:06:06.495049 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:06:06.501095 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:06:06.501095 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:06:06.505451 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:06:06.506254 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:06:06.507085 [debug] [Thread-4 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:06:06.510232 [debug] [Thread-2 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:06:06.510232 [debug] [Thread-4 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: BEGIN
[0m05:06:06.510232 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:06:06.514360 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:06:06.514360 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m05:06:06.514360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:06.514360 [debug] [Thread-2 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:06:06.514360 [debug] [Thread-2 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m05:06:06.514360 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:09:17.850853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D49AC1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D49AC1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D49AC1550>]}


============================== 05:09:17.864069 | 5a1349bf-6f1c-4987-b2ae-877d617b2462 ==============================
[0m05:09:17.864069 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:09:17.864069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --exclude test:*', 'send_anonymous_usage_stats': 'True'}
[0m05:09:18.152638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a1349bf-6f1c-4987-b2ae-877d617b2462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D49B599A0>]}
[0m05:09:18.216375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a1349bf-6f1c-4987-b2ae-877d617b2462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D48629FD0>]}
[0m05:09:18.216375 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:09:18.551840 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m05:09:18.802076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:18.802076 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:18.856647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a1349bf-6f1c-4987-b2ae-877d617b2462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D4AD427B0>]}
[0m05:09:19.019022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a1349bf-6f1c-4987-b2ae-877d617b2462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D4AD49070>]}
[0m05:09:19.021043 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m05:09:19.022716 [error] [MainThread]: Encountered an error:
Runtime Error
  'test' is not a valid method name
[0m05:09:19.022716 [debug] [MainThread]: Command `dbt build` failed at 05:09:19.022716 after 1.35 seconds
[0m05:09:19.022716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D49AA3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D49AC1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D4B078D10>]}
[0m05:09:19.022716 [debug] [MainThread]: Flushing usage events
[0m05:09:30.696669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C5176A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C7C86E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C7C87AA0>]}


============================== 05:09:30.698423 | 9d9f093e-fe1b-4144-b43c-d39a49f83f08 ==============================
[0m05:09:30.698423 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:09:30.706234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --exclude test:*', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:09:31.007627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d9f093e-fe1b-4144-b43c-d39a49f83f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C80687D0>]}
[0m05:09:31.081086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d9f093e-fe1b-4144-b43c-d39a49f83f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C90F4950>]}
[0m05:09:31.081086 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:09:31.424373 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m05:09:31.603073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:31.603073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:31.672759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d9f093e-fe1b-4144-b43c-d39a49f83f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C7CABEF0>]}
[0m05:09:31.850324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d9f093e-fe1b-4144-b43c-d39a49f83f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C9130E00>]}
[0m05:09:31.852337 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m05:09:31.852337 [error] [MainThread]: Encountered an error:
Runtime Error
  'test' is not a valid method name
[0m05:09:31.857945 [debug] [MainThread]: Command `dbt build` failed at 05:09:31.857945 after 1.34 seconds
[0m05:09:31.857945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C7B7C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C7B27140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C7A7C830>]}
[0m05:09:31.857945 [debug] [MainThread]: Flushing usage events
[0m05:09:38.840983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0BCF1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0BCF12B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0BCF1220>]}


============================== 05:09:38.840983 | 007a8ba4-b50e-4ce5-994e-72c59fe85949 ==============================
[0m05:09:38.840983 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:09:38.917304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --exclude test:*', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:09:39.261774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '007a8ba4-b50e-4ce5-994e-72c59fe85949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0CE58260>]}
[0m05:09:39.352563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '007a8ba4-b50e-4ce5-994e-72c59fe85949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0BD88800>]}
[0m05:09:39.354574 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:09:39.765936 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m05:09:39.936526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:39.936526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:39.982149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '007a8ba4-b50e-4ce5-994e-72c59fe85949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0BD8A3F0>]}
[0m05:09:40.134228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '007a8ba4-b50e-4ce5-994e-72c59fe85949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0D26AFF0>]}
[0m05:09:40.134228 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m05:09:40.140126 [error] [MainThread]: Encountered an error:
Runtime Error
  'test' is not a valid method name
[0m05:09:40.144662 [debug] [MainThread]: Command `dbt build` failed at 05:09:40.144662 after 1.46 seconds
[0m05:09:40.146674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0BCF07A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA09509D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0CE34740>]}
[0m05:09:40.146674 [debug] [MainThread]: Flushing usage events
[0m05:09:48.301440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DECB2CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DF4AF2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DF4AE9F0>]}


============================== 05:09:48.310559 | 52da33ae-7be9-4fe6-b61b-c745af140863 ==============================
[0m05:09:48.310559 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:09:48.310559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --exclude test:*', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:09:48.683806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52da33ae-7be9-4fe6-b61b-c745af140863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DE5837A0>]}
[0m05:09:48.818008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52da33ae-7be9-4fe6-b61b-c745af140863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216E088A5A0>]}
[0m05:09:48.818008 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:09:49.317539 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m05:09:49.565244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:49.565244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:49.632647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52da33ae-7be9-4fe6-b61b-c745af140863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216E096FC20>]}
[0m05:09:49.845297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52da33ae-7be9-4fe6-b61b-c745af140863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216E0CE7800>]}
[0m05:09:49.845297 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m05:09:49.845297 [error] [MainThread]: Encountered an error:
Runtime Error
  'test' is not a valid method name
[0m05:09:49.845297 [debug] [MainThread]: Command `dbt build` failed at 05:09:49.845297 after 1.77 seconds
[0m05:09:49.845297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DF14EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DF7F57F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216E0CE5580>]}
[0m05:09:49.845297 [debug] [MainThread]: Flushing usage events
[0m05:12:09.306850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022648287CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022647ABECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022647ABEAB0>]}


============================== 05:12:09.319560 | 09cc84d2-8298-4799-b871-f7b3aa516be0 ==============================
[0m05:12:09.319560 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:12:09.323590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --threads 1', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:12:09.609216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022648646DE0>]}
[0m05:12:09.664515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264867CB90>]}
[0m05:12:09.664515 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:12:10.011751 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m05:12:10.167938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:12:10.167938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:12:10.201182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226498A72F0>]}
[0m05:12:10.344005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022649A27FE0>]}
[0m05:12:10.346020 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m05:12:10.346020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022649A708F0>]}
[0m05:12:10.349036 [info ] [MainThread]: 
[0m05:12:10.349036 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:12:10.359927 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m05:12:10.470991 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m05:12:10.470991 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m05:12:10.473005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:12:10.486595 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m05:12:10.486595 [debug] [ThreadPool]: On list_warehouse: Close
[0m05:12:10.491476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m05:12:10.491476 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m05:12:10.499608 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:12:10.499608 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m05:12:10.499608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:12:10.508672 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m05:12:10.513310 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:12:10.513310 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m05:12:10.513310 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:12:10.513310 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:12:10.513310 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m05:12:10.515321 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:12:10.515321 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m05:12:10.515321 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:12:10.515321 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m05:12:10.517333 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:12:10.517333 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m05:12:10.520363 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m05:12:10.520363 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:12:10.520363 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m05:12:10.520363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:12:10.541027 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m05:12:10.541027 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:12:10.541027 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m05:12:10.565899 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m05:12:10.565899 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m05:12:10.581665 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m05:12:10.583679 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m05:12:10.583679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022645E186B0>]}
[0m05:12:10.583679 [debug] [MainThread]: Using duckdb connection "master"
[0m05:12:10.583679 [debug] [MainThread]: On master: BEGIN
[0m05:12:10.583679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:12:10.597618 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m05:12:10.597618 [debug] [MainThread]: On master: COMMIT
[0m05:12:10.599633 [debug] [MainThread]: Using duckdb connection "master"
[0m05:12:10.599633 [debug] [MainThread]: On master: COMMIT
[0m05:12:10.599633 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:12:10.599633 [debug] [MainThread]: On master: Close
[0m05:12:10.601648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:12:10.604049 [info ] [MainThread]: 
[0m05:12:10.609787 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m05:12:10.609787 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m05:12:10.609787 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m05:12:10.613571 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m05:12:10.613571 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m05:12:10.625244 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m05:12:10.665029 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m05:12:10.667041 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:10.667041 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m05:12:10.669056 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:12:10.678748 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m05:12:10.678748 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:10.680762 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw
  );

[0m05:12:10.684786 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m05:12:10.691894 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:10.691894 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content" rename to "stg_content__dbt_backup"
[0m05:12:10.693909 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:10.695923 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:10.697935 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content__dbt_tmp" rename to "stg_content"
[0m05:12:10.697935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:10.717791 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m05:12:10.717791 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:10.717791 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m05:12:10.727521 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m05:12:10.733733 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:10.733733 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
drop view if exists "warehouse"."main"."stg_content__dbt_backup" cascade
[0m05:12:10.735746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:10.738613 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m05:12:10.748430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226498C6750>]}
[0m05:12:10.748430 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_content .............................. [[32mOK[0m in 0.14s]
[0m05:12:10.750958 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m05:12:10.750958 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_events
[0m05:12:10.752975 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m05:12:10.753820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now model.meta_product_analytics.stg_events)
[0m05:12:10.753820 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_events
[0m05:12:10.757865 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m05:12:10.757865 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_events
[0m05:12:10.762487 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m05:12:10.762487 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:10.762487 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m05:12:10.762487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:10.795735 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m05:12:10.797749 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:10.797749 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw
  );

[0m05:12:10.801773 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:10.802788 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:10.802788 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m05:12:10.802788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:10.812528 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:10.812528 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m05:12:10.812528 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:10.812528 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m05:12:10.812528 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:10.812528 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m05:12:10.818781 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:10.822822 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:10.822822 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
drop view if exists "warehouse"."main"."stg_events__dbt_backup" cascade
[0m05:12:10.826110 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:10.826110 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: Close
[0m05:12:10.833079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264A0612E0>]}
[0m05:12:10.834825 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.08s]
[0m05:12:10.836113 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_events
[0m05:12:10.836113 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_users
[0m05:12:10.838135 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m05:12:10.838135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now model.meta_product_analytics.stg_users)
[0m05:12:10.840154 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_users
[0m05:12:10.841678 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m05:12:10.843699 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_users
[0m05:12:10.845719 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m05:12:10.845719 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:10.845719 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m05:12:10.845719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:10.873330 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m05:12:10.873330 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:10.873330 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw
  );

[0m05:12:10.875346 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m05:12:10.882563 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:10.882563 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m05:12:10.882563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:10.882563 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:10.882563 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m05:12:10.882563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:10.882563 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m05:12:10.891834 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:10.891834 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m05:12:10.893848 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:10.904468 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:10.904468 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
drop view if exists "warehouse"."main"."stg_users__dbt_backup" cascade
[0m05:12:10.906483 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:12:10.909848 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: Close
[0m05:12:10.916325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264A020350>]}
[0m05:12:10.918346 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.08s]
[0m05:12:10.919328 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_users
[0m05:12:10.919328 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.dim_content
[0m05:12:10.921345 [info ] [Thread-1 (]: 4 of 7 START sql table model main.dim_content .................................. [RUN]
[0m05:12:10.921853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now model.meta_product_analytics.dim_content)
[0m05:12:10.921853 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.dim_content
[0m05:12:10.925875 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m05:12:10.927887 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.dim_content
[0m05:12:10.945788 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.dim_content"
[0m05:12:10.945788 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:10.945788 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: BEGIN
[0m05:12:10.945788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:10.977727 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m05:12:10.977727 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:10.977727 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */

  
    
    

    create  table
      "warehouse"."main"."dim_content__dbt_tmp"
  
    as (
      with c as (select * from "warehouse"."main"."stg_content")
select * from c
    );
  
  
[0m05:12:10.977727 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m05:12:10.986904 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:10.986904 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content" rename to "dim_content__dbt_backup"
[0m05:12:10.988916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:10.990933 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:10.993472 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content__dbt_tmp" rename to "dim_content"
[0m05:12:10.993472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:10.993472 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m05:12:10.993472 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:10.993472 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m05:12:11.003962 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:11.006273 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:11.006273 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
drop table if exists "warehouse"."main"."dim_content__dbt_backup" cascade
[0m05:12:11.010035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:11.014175 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: Close
[0m05:12:11.020655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264A0BC320>]}
[0m05:12:11.022683 [info ] [Thread-1 (]: 4 of 7 OK created sql table model main.dim_content ............................. [[32mOK[0m in 0.10s]
[0m05:12:11.025143 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.dim_content
[0m05:12:11.025143 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.fct_product_events
[0m05:12:11.027157 [info ] [Thread-1 (]: 5 of 7 START sql table model main.fct_product_events ........................... [RUN]
[0m05:12:11.027157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.dim_content, now model.meta_product_analytics.fct_product_events)
[0m05:12:11.027157 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m05:12:11.031330 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m05:12:11.033345 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m05:12:11.035364 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.fct_product_events"
[0m05:12:11.037378 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:11.037378 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: BEGIN
[0m05:12:11.037378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:11.066813 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m05:12:11.068828 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:11.068828 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */

  
    
    

    create  table
      "warehouse"."main"."fct_product_events__dbt_tmp"
  
    as (
      with e as (select * from "warehouse"."main"."stg_events")
select * from e
    );
  
  
[0m05:12:11.073482 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m05:12:11.075507 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:11.075507 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events" rename to "fct_product_events__dbt_backup"
[0m05:12:11.075507 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:11.075507 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:11.075507 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events__dbt_tmp" rename to "fct_product_events"
[0m05:12:11.075507 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:11.075507 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m05:12:11.075507 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:11.075507 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m05:12:11.088629 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:11.092673 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:11.092673 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
drop table if exists "warehouse"."main"."fct_product_events__dbt_backup" cascade
[0m05:12:11.094688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:11.097670 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: Close
[0m05:12:11.105218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264A0BC440>]}
[0m05:12:11.107239 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main.fct_product_events ...................... [[32mOK[0m in 0.08s]
[0m05:12:11.107239 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m05:12:11.109260 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.dim_users
[0m05:12:11.109260 [info ] [Thread-1 (]: 6 of 7 START sql table model main.dim_users .................................... [RUN]
[0m05:12:11.111276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.fct_product_events, now model.meta_product_analytics.dim_users)
[0m05:12:11.111276 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.dim_users
[0m05:12:11.115304 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m05:12:11.117321 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.dim_users
[0m05:12:11.120355 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.dim_users"
[0m05:12:11.122372 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:11.124392 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: BEGIN
[0m05:12:11.124392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:11.151070 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m05:12:11.152585 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:11.152585 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */

  
    
    

    create  table
      "warehouse"."main"."dim_users__dbt_tmp"
  
    as (
      with u as (select * from "warehouse"."main"."stg_users")
select * from u
    );
  
  
[0m05:12:11.152585 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m05:12:11.160518 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:11.160518 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users" rename to "dim_users__dbt_backup"
[0m05:12:11.162529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:11.162529 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:11.162529 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users__dbt_tmp" rename to "dim_users"
[0m05:12:11.162529 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:11.168577 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m05:12:11.168577 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:11.168577 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m05:12:11.168577 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:11.175553 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:11.177567 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
drop table if exists "warehouse"."main"."dim_users__dbt_backup" cascade
[0m05:12:11.177567 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:11.182122 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: Close
[0m05:12:11.192788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022649ED84A0>]}
[0m05:12:11.194802 [info ] [Thread-1 (]: 6 of 7 OK created sql table model main.dim_users ............................... [[32mOK[0m in 0.08s]
[0m05:12:11.194802 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.dim_users
[0m05:12:11.196824 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m05:12:11.198186 [info ] [Thread-1 (]: 7 of 7 START sql table model main.agg_product_kpis ............................. [RUN]
[0m05:12:11.199941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.dim_users, now model.meta_product_analytics.agg_product_kpis)
[0m05:12:11.199941 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m05:12:11.203880 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m05:12:11.203880 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m05:12:11.209939 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.agg_product_kpis"
[0m05:12:11.213070 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:11.213070 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: BEGIN
[0m05:12:11.213070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:11.235993 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m05:12:11.235993 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:11.235993 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */

  
    
    

    create  table
      "warehouse"."main"."agg_product_kpis__dbt_tmp"
  
    as (
      with e as (
    select
        event_id,
        user_id,
        content_id,
        event_type,
        cast(event_ts as timestamp) as event_ts,
        cast(event_ts as date) as event_date
    from "warehouse"."main"."fct_product_events"
),
a as (
    select * from "warehouse"."main"."dim_users"
)
select
    event_date,
    count(distinct case when event_type = 'session_start' then user_id end) as dau,
    count(distinct user_id) filter (where event_type = 'follow') as daily_followers,
    count(*) filter (where event_type = 'impression') as impressions,
    count(*) filter (where event_type = 'like') as likes,
    (count(*) filter (where event_type = 'like'))::double 
        / nullif((count(*) filter (where event_type = 'impression')), 0) as like_rate
from e
group by event_date
order by event_date
    );
  
  
[0m05:12:11.243989 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m05:12:11.247629 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:11.249642 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis" rename to "agg_product_kpis__dbt_backup"
[0m05:12:11.249642 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:11.253667 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:11.253667 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis__dbt_tmp" rename to "agg_product_kpis"
[0m05:12:11.253667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:11.257692 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m05:12:11.257692 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:11.257692 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m05:12:11.259705 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:11.263649 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:11.265663 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
drop table if exists "warehouse"."main"."agg_product_kpis__dbt_backup" cascade
[0m05:12:11.265663 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:11.269172 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: Close
[0m05:12:11.275296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09cc84d2-8298-4799-b871-f7b3aa516be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264A053110>]}
[0m05:12:11.275296 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.agg_product_kpis ........................ [[32mOK[0m in 0.08s]
[0m05:12:11.277316 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m05:12:11.280186 [debug] [MainThread]: Using duckdb connection "master"
[0m05:12:11.280186 [debug] [MainThread]: On master: BEGIN
[0m05:12:11.280186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:12:11.303309 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m05:12:11.303309 [debug] [MainThread]: On master: COMMIT
[0m05:12:11.303309 [debug] [MainThread]: Using duckdb connection "master"
[0m05:12:11.303309 [debug] [MainThread]: On master: COMMIT
[0m05:12:11.305323 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:12:11.305323 [debug] [MainThread]: On master: Close
[0m05:12:11.307341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:12:11.307341 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m05:12:11.307341 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m05:12:11.307341 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m05:12:11.307341 [info ] [MainThread]: 
[0m05:12:11.311495 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m05:12:11.314799 [debug] [MainThread]: Command end result
[0m05:12:11.351334 [info ] [MainThread]: 
[0m05:12:11.351334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:12:11.351334 [info ] [MainThread]: 
[0m05:12:11.351334 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m05:12:11.351334 [debug] [MainThread]: Command `dbt run` succeeded at 05:12:11.351334 after 2.21 seconds
[0m05:12:11.351334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022645880920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226485BA900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226485BBAA0>]}
[0m05:12:11.358487 [debug] [MainThread]: Flushing usage events
[0m05:12:21.344312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661C67D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661BFCBE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661BFCBA10>]}


============================== 05:12:21.344312 | b6bcf079-b1f0-474e-a833-8730820ecf2f ==============================
[0m05:12:21.344312 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:12:21.344312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --threads 1', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:12:21.689190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661C38FEF0>]}
[0m05:12:21.773574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661B44B800>]}
[0m05:12:21.773574 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:12:22.146869 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m05:12:22.321956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:12:22.323974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:12:22.385471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661D8CAF90>]}
[0m05:12:22.545140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661DAC6270>]}
[0m05:12:22.545140 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m05:12:22.545140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661DBF6A50>]}
[0m05:12:22.554459 [info ] [MainThread]: 
[0m05:12:22.554459 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:12:22.564419 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m05:12:22.679620 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m05:12:22.679620 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m05:12:22.681633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:12:22.695394 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m05:12:22.695394 [debug] [ThreadPool]: On list_warehouse: Close
[0m05:12:22.700391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m05:12:22.700391 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m05:12:22.707670 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:12:22.711009 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m05:12:22.711009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:12:22.727274 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m05:12:22.727274 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:12:22.729289 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m05:12:22.729289 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:12:22.729289 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:12:22.729289 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m05:12:22.731309 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:12:22.731309 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m05:12:22.731309 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m05:12:22.733323 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m05:12:22.733323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:12:22.733323 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m05:12:22.735077 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m05:12:22.747195 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:12:22.747195 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m05:12:22.747195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:12:22.759246 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m05:12:22.759246 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:12:22.759246 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m05:12:22.797722 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m05:12:22.801711 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m05:12:22.801711 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m05:12:22.803725 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m05:12:22.807764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661DF513D0>]}
[0m05:12:22.807764 [debug] [MainThread]: Using duckdb connection "master"
[0m05:12:22.807764 [debug] [MainThread]: On master: BEGIN
[0m05:12:22.807764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:12:22.813857 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m05:12:22.813857 [debug] [MainThread]: On master: COMMIT
[0m05:12:22.813857 [debug] [MainThread]: Using duckdb connection "master"
[0m05:12:22.813857 [debug] [MainThread]: On master: COMMIT
[0m05:12:22.813857 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:12:22.813857 [debug] [MainThread]: On master: Close
[0m05:12:22.813857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:12:22.825093 [info ] [MainThread]: 
[0m05:12:22.829715 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m05:12:22.829715 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_content ................................... [RUN]
[0m05:12:22.829715 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m05:12:22.829715 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m05:12:22.843896 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m05:12:22.847703 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m05:12:22.891840 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_content"
[0m05:12:22.895191 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:22.962508 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: BEGIN
[0m05:12:22.968291 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:12:22.993776 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m05:12:22.993776 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:22.993776 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */

  
  create view "warehouse"."main"."stg_content__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/content.csv', header=true)
)
select
  cast(content_id as integer)      as content_id,
  cast(creator_user_id as integer) as creator_user_id,
  category                         as topic,
  cast(created_at as date)         as created_at
from raw
  );

[0m05:12:22.998104 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m05:12:23.010190 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:23.010190 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content" rename to "stg_content__dbt_backup"
[0m05:12:23.010190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.019177 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:23.019177 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
alter view "warehouse"."main"."stg_content__dbt_tmp" rename to "stg_content"
[0m05:12:23.021192 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.045895 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m05:12:23.045895 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:23.045895 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: COMMIT
[0m05:12:23.061620 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m05:12:23.070225 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_content"
[0m05:12:23.070225 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_content"} */
drop view if exists "warehouse"."main"."stg_content__dbt_backup" cascade
[0m05:12:23.070225 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:12:23.070225 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_content: Close
[0m05:12:23.090828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661DF63620>]}
[0m05:12:23.092849 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_content .............................. [[32mOK[0m in 0.26s]
[0m05:12:23.095539 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m05:12:23.095539 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_events
[0m05:12:23.097566 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m05:12:23.097566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now model.meta_product_analytics.stg_events)
[0m05:12:23.097566 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_events
[0m05:12:23.103215 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m05:12:23.103215 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_events
[0m05:12:23.110104 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_events"
[0m05:12:23.110104 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:23.113650 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: BEGIN
[0m05:12:23.113650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:23.147664 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m05:12:23.147664 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:23.152651 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */

  
  create view "warehouse"."main"."stg_events__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/events_app.csv', header=true)
)
select
  cast(event_id as integer)   as event_id,
  cast(user_id as integer)    as user_id,
  cast(content_id as integer) as content_id,
  event_type,
  cast(event_ts as timestamp) as event_ts,
  cast(null as varchar)       as app_version
from raw
  );

[0m05:12:23.163086 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m05:12:23.166574 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:23.166574 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m05:12:23.166574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.178685 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:23.180701 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
alter view "warehouse"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m05:12:23.180701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.182718 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m05:12:23.184732 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:23.184732 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: COMMIT
[0m05:12:23.192340 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m05:12:23.192340 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_events"
[0m05:12:23.192340 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_events"} */
drop view if exists "warehouse"."main"."stg_events__dbt_backup" cascade
[0m05:12:23.192340 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:12:23.201845 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_events: Close
[0m05:12:23.213823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661E06F6B0>]}
[0m05:12:23.216288 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.12s]
[0m05:12:23.216288 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_events
[0m05:12:23.220204 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_users
[0m05:12:23.220204 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m05:12:23.223625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now model.meta_product_analytics.stg_users)
[0m05:12:23.227558 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_users
[0m05:12:23.230232 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m05:12:23.230232 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_users
[0m05:12:23.235665 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.stg_users"
[0m05:12:23.238685 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:23.238685 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: BEGIN
[0m05:12:23.241790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:23.266967 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m05:12:23.270598 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:23.270598 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */

  
  create view "warehouse"."main"."stg_users__dbt_tmp" as (
    with raw as (
  select * from read_csv_auto('data/raw/users.csv', header=true)
)
select
  cast(user_id as integer)        as user_id,
  cast(signup_date as date)       as signup_date,
  cast(signup_date as timestamp)  as signup_ts,
  country
from raw
  );

[0m05:12:23.275862 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m05:12:23.278906 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:23.278906 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m05:12:23.278906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:12:23.287210 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:23.287210 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
alter view "warehouse"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m05:12:23.287210 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.295309 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m05:12:23.296287 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:23.296287 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: COMMIT
[0m05:12:23.301243 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:23.305649 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.stg_users"
[0m05:12:23.306159 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.stg_users"} */
drop view if exists "warehouse"."main"."stg_users__dbt_backup" cascade
[0m05:12:23.309865 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:23.309865 [debug] [Thread-1 (]: On model.meta_product_analytics.stg_users: Close
[0m05:12:23.319800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661E036750>]}
[0m05:12:23.321815 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.10s]
[0m05:12:23.326104 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_users
[0m05:12:23.326104 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.dim_content
[0m05:12:23.326104 [info ] [Thread-1 (]: 4 of 7 START sql table model main.dim_content .................................. [RUN]
[0m05:12:23.329480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now model.meta_product_analytics.dim_content)
[0m05:12:23.329480 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.dim_content
[0m05:12:23.332433 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m05:12:23.333945 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.dim_content
[0m05:12:23.369912 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.dim_content"
[0m05:12:23.369912 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:23.369912 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: BEGIN
[0m05:12:23.369912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:23.400729 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m05:12:23.400729 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:23.400729 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */

  
    
    

    create  table
      "warehouse"."main"."dim_content__dbt_tmp"
  
    as (
      with c as (select * from "warehouse"."main"."stg_content")
select * from c
    );
  
  
[0m05:12:23.411743 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m05:12:23.411743 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:23.411743 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content" rename to "dim_content__dbt_backup"
[0m05:12:23.418321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.418321 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:23.418321 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
alter table "warehouse"."main"."dim_content__dbt_tmp" rename to "dim_content"
[0m05:12:23.424761 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.432272 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m05:12:23.432272 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:23.434034 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: COMMIT
[0m05:12:23.442954 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m05:12:23.446910 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_content"
[0m05:12:23.448922 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_content"} */
drop table if exists "warehouse"."main"."dim_content__dbt_backup" cascade
[0m05:12:23.450624 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:12:23.455756 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_content: Close
[0m05:12:23.469982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661E103CB0>]}
[0m05:12:23.469982 [info ] [Thread-1 (]: 4 of 7 OK created sql table model main.dim_content ............................. [[32mOK[0m in 0.14s]
[0m05:12:23.469982 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.dim_content
[0m05:12:23.475491 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.fct_product_events
[0m05:12:23.475491 [info ] [Thread-1 (]: 5 of 7 START sql table model main.fct_product_events ........................... [RUN]
[0m05:12:23.475491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.dim_content, now model.meta_product_analytics.fct_product_events)
[0m05:12:23.478977 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m05:12:23.481679 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m05:12:23.481679 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m05:12:23.492112 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.fct_product_events"
[0m05:12:23.492112 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:23.492112 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: BEGIN
[0m05:12:23.492112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:23.524086 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m05:12:23.524086 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:23.524086 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */

  
    
    

    create  table
      "warehouse"."main"."fct_product_events__dbt_tmp"
  
    as (
      with e as (select * from "warehouse"."main"."stg_events")
select * from e
    );
  
  
[0m05:12:23.532771 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m05:12:23.536636 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:23.536636 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events" rename to "fct_product_events__dbt_backup"
[0m05:12:23.541874 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.543846 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:23.543846 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
alter table "warehouse"."main"."fct_product_events__dbt_tmp" rename to "fct_product_events"
[0m05:12:23.548781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.552155 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m05:12:23.552155 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:23.552155 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: COMMIT
[0m05:12:23.558188 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:23.561364 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.fct_product_events"
[0m05:12:23.561364 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.fct_product_events"} */
drop table if exists "warehouse"."main"."fct_product_events__dbt_backup" cascade
[0m05:12:23.565454 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:12:23.567466 [debug] [Thread-1 (]: On model.meta_product_analytics.fct_product_events: Close
[0m05:12:23.585298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661E0B7710>]}
[0m05:12:23.585298 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main.fct_product_events ...................... [[32mOK[0m in 0.11s]
[0m05:12:23.589820 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m05:12:23.592373 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.dim_users
[0m05:12:23.593433 [info ] [Thread-1 (]: 6 of 7 START sql table model main.dim_users .................................... [RUN]
[0m05:12:23.595550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.fct_product_events, now model.meta_product_analytics.dim_users)
[0m05:12:23.596241 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.dim_users
[0m05:12:23.598259 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m05:12:23.602854 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.dim_users
[0m05:12:23.610081 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.dim_users"
[0m05:12:23.610081 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:23.610081 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: BEGIN
[0m05:12:23.610081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:23.644737 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m05:12:23.650735 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:23.650735 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */

  
    
    

    create  table
      "warehouse"."main"."dim_users__dbt_tmp"
  
    as (
      with u as (select * from "warehouse"."main"."stg_users")
select * from u
    );
  
  
[0m05:12:23.657775 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m05:12:23.657775 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:23.657775 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users" rename to "dim_users__dbt_backup"
[0m05:12:23.657775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.669459 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:23.669459 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
alter table "warehouse"."main"."dim_users__dbt_tmp" rename to "dim_users"
[0m05:12:23.671477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.673494 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m05:12:23.673494 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:23.673494 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: COMMIT
[0m05:12:23.683093 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m05:12:23.683093 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.dim_users"
[0m05:12:23.683093 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.dim_users"} */
drop table if exists "warehouse"."main"."dim_users__dbt_backup" cascade
[0m05:12:23.683093 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:23.692762 [debug] [Thread-1 (]: On model.meta_product_analytics.dim_users: Close
[0m05:12:23.708065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661DC13D10>]}
[0m05:12:23.710079 [info ] [Thread-1 (]: 6 of 7 OK created sql table model main.dim_users ............................... [[32mOK[0m in 0.11s]
[0m05:12:23.712105 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.dim_users
[0m05:12:23.712105 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m05:12:23.714715 [info ] [Thread-1 (]: 7 of 7 START sql table model main.agg_product_kpis ............................. [RUN]
[0m05:12:23.714715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.dim_users, now model.meta_product_analytics.agg_product_kpis)
[0m05:12:23.714715 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m05:12:23.714715 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m05:12:23.714715 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m05:12:23.732451 [debug] [Thread-1 (]: Writing runtime sql for node "model.meta_product_analytics.agg_product_kpis"
[0m05:12:23.734468 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:23.734468 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: BEGIN
[0m05:12:23.736485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:23.762471 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m05:12:23.762471 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:23.767492 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */

  
    
    

    create  table
      "warehouse"."main"."agg_product_kpis__dbt_tmp"
  
    as (
      with e as (
    select
        event_id,
        user_id,
        content_id,
        event_type,
        cast(event_ts as timestamp) as event_ts,
        cast(event_ts as date) as event_date
    from "warehouse"."main"."fct_product_events"
),
a as (
    select * from "warehouse"."main"."dim_users"
)
select
    event_date,
    count(distinct case when event_type = 'session_start' then user_id end) as dau,
    count(distinct user_id) filter (where event_type = 'follow') as daily_followers,
    count(*) filter (where event_type = 'impression') as impressions,
    count(*) filter (where event_type = 'like') as likes,
    (count(*) filter (where event_type = 'like'))::double 
        / nullif((count(*) filter (where event_type = 'impression')), 0) as like_rate
from e
group by event_date
order by event_date
    );
  
  
[0m05:12:23.778441 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m05:12:23.778441 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:23.778441 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis" rename to "agg_product_kpis__dbt_backup"
[0m05:12:23.778441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.778441 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:23.778441 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
alter table "warehouse"."main"."agg_product_kpis__dbt_tmp" rename to "agg_product_kpis"
[0m05:12:23.778441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:12:23.794134 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m05:12:23.796145 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:23.796145 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: COMMIT
[0m05:12:23.798158 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:12:23.804157 [debug] [Thread-1 (]: Using duckdb connection "model.meta_product_analytics.agg_product_kpis"
[0m05:12:23.804157 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "model.meta_product_analytics.agg_product_kpis"} */
drop table if exists "warehouse"."main"."agg_product_kpis__dbt_backup" cascade
[0m05:12:23.804157 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:12:23.804157 [debug] [Thread-1 (]: On model.meta_product_analytics.agg_product_kpis: Close
[0m05:12:23.819022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bcf079-b1f0-474e-a833-8730820ecf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661E02F9E0>]}
[0m05:12:23.821045 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.agg_product_kpis ........................ [[32mOK[0m in 0.10s]
[0m05:12:23.823075 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m05:12:23.827478 [debug] [MainThread]: Using duckdb connection "master"
[0m05:12:23.827478 [debug] [MainThread]: On master: BEGIN
[0m05:12:23.827478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:12:23.881914 [debug] [MainThread]: SQL status: OK in 0.053 seconds
[0m05:12:23.881914 [debug] [MainThread]: On master: COMMIT
[0m05:12:23.881914 [debug] [MainThread]: Using duckdb connection "master"
[0m05:12:23.883927 [debug] [MainThread]: On master: COMMIT
[0m05:12:23.884475 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:12:23.884475 [debug] [MainThread]: On master: Close
[0m05:12:23.886659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:12:23.886659 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m05:12:23.886659 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m05:12:23.888680 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m05:12:23.888680 [info ] [MainThread]: 
[0m05:12:23.892445 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m05:12:23.895263 [debug] [MainThread]: Command end result
[0m05:12:23.942594 [info ] [MainThread]: 
[0m05:12:23.943110 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:12:23.943110 [info ] [MainThread]: 
[0m05:12:23.943110 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m05:12:23.948287 [debug] [MainThread]: Command `dbt run` succeeded at 05:12:23.948287 after 2.80 seconds
[0m05:12:23.948287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661C3E1CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661BFAC1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661BFAD580>]}
[0m05:12:23.948287 [debug] [MainThread]: Flushing usage events
[0m05:16:38.256969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB84553980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB86EB9F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB86EBB950>]}


============================== 05:16:38.264272 | 570b43db-5f9c-4fea-af98-04d711de8171 ==============================
[0m05:16:38.264272 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:16:38.264272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --threads 1', 'send_anonymous_usage_stats': 'True'}
[0m05:16:38.553853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '570b43db-5f9c-4fea-af98-04d711de8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8733ED80>]}
[0m05:16:38.621473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '570b43db-5f9c-4fea-af98-04d711de8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB879F5DF0>]}
[0m05:16:38.621473 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:16:38.947544 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m05:16:39.111418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:16:39.111418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:16:39.154876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '570b43db-5f9c-4fea-af98-04d711de8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB87A68FB0>]}
[0m05:16:39.301252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '570b43db-5f9c-4fea-af98-04d711de8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB890A7F20>]}
[0m05:16:39.301252 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m05:16:39.301252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '570b43db-5f9c-4fea-af98-04d711de8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB88DEC140>]}
[0m05:16:39.308624 [info ] [MainThread]: 
[0m05:16:39.310988 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:16:39.310988 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m05:16:39.427119 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:16:39.427119 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m05:16:39.427119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:16:39.441491 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m05:16:39.441491 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:16:39.441491 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m05:16:39.479436 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m05:16:39.479436 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m05:16:39.479436 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m05:16:39.479436 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m05:16:39.487536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '570b43db-5f9c-4fea-af98-04d711de8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB89097A40>]}
[0m05:16:39.487536 [debug] [MainThread]: Using duckdb connection "master"
[0m05:16:39.487536 [debug] [MainThread]: On master: BEGIN
[0m05:16:39.487536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:16:39.501069 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m05:16:39.501069 [debug] [MainThread]: On master: COMMIT
[0m05:16:39.501069 [debug] [MainThread]: Using duckdb connection "master"
[0m05:16:39.501069 [debug] [MainThread]: On master: COMMIT
[0m05:16:39.501069 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:16:39.501069 [debug] [MainThread]: On master: Close
[0m05:16:39.505572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:16:39.505572 [info ] [MainThread]: 
[0m05:16:39.505572 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:16:39.505572 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [RUN]
[0m05:16:39.505572 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c'
[0m05:16:39.505572 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:16:39.537545 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:16:39.537545 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:16:39.560247 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:16:39.560247 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:16:39.562262 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: BEGIN
[0m05:16:39.562262 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:16:39.569501 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m05:16:39.569501 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:16:39.569501 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "warehouse"."main"."stg_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'view','like','impression','follow','session_start'
)



      
    ) dbt_internal_test
[0m05:16:39.578286 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m05:16:39.580041 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: ROLLBACK
[0m05:16:39.580041 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c'
[0m05:16:39.580041 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: Close
[0m05:16:39.587557 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [[32mPASS[0m in 0.08s]
[0m05:16:39.587557 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:16:39.592133 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:16:39.592133 [info ] [Thread-1 (]: 2 of 7 START test not_null_stg_content_content_id .............................. [RUN]
[0m05:16:39.592133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c, now test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7)
[0m05:16:39.592133 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:16:39.602801 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:16:39.604824 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:16:39.608868 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:16:39.610888 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:16:39.610888 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: BEGIN
[0m05:16:39.610888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:16:39.622977 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m05:16:39.622977 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:16:39.622977 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select content_id
from "warehouse"."main"."stg_content"
where content_id is null



      
    ) dbt_internal_test
[0m05:16:39.627543 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m05:16:39.630069 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: ROLLBACK
[0m05:16:39.632080 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7'
[0m05:16:39.632080 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: Close
[0m05:16:39.632080 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stg_content_content_id .................................... [[32mPASS[0m in 0.04s]
[0m05:16:39.636979 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:16:39.636979 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:16:39.636979 [info ] [Thread-1 (]: 3 of 7 START test not_null_stg_events_event_id ................................. [RUN]
[0m05:16:39.636979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7, now test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012)
[0m05:16:39.636979 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:16:39.642410 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:16:39.642410 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:16:39.642410 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:16:39.642410 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:16:39.642410 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m05:16:39.642410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:16:39.658119 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m05:16:39.658119 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:16:39.658119 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "warehouse"."main"."stg_events"
where event_id is null



      
    ) dbt_internal_test
[0m05:16:39.658119 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m05:16:39.669721 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m05:16:39.671738 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012'
[0m05:16:39.671738 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: Close
[0m05:16:39.674155 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m05:16:39.674155 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:16:39.674155 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:16:39.678356 [info ] [Thread-1 (]: 4 of 7 START test not_null_stg_users_user_id ................................... [RUN]
[0m05:16:39.678356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012, now test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m05:16:39.678356 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:16:39.682786 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:16:39.682786 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:16:39.690097 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:16:39.690097 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:16:39.690097 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m05:16:39.690097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:16:39.703298 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m05:16:39.706128 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:16:39.706128 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "warehouse"."main"."stg_users"
where user_id is null



      
    ) dbt_internal_test
[0m05:16:39.709337 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m05:16:39.709337 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m05:16:39.709337 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m05:16:39.709337 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m05:16:39.720401 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m05:16:39.730686 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:16:39.730686 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:16:39.730686 [info ] [Thread-1 (]: 5 of 7 START test unique_stg_content_content_id ................................ [RUN]
[0m05:16:39.734033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77, now test.meta_product_analytics.unique_stg_content_content_id.a034585f1a)
[0m05:16:39.736106 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:16:39.739865 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:16:39.739865 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:16:39.739865 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:16:39.753518 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:16:39.754646 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: BEGIN
[0m05:16:39.754646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:16:39.754646 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m05:16:39.754646 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:16:39.770057 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    content_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_content"
where content_id is not null
group by content_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:16:39.770057 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m05:16:39.770057 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: ROLLBACK
[0m05:16:39.770057 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_content_content_id.a034585f1a'
[0m05:16:39.770057 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: Close
[0m05:16:39.785858 [info ] [Thread-1 (]: 5 of 7 PASS unique_stg_content_content_id ...................................... [[32mPASS[0m in 0.05s]
[0m05:16:39.785858 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:16:39.785858 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:16:39.785858 [info ] [Thread-1 (]: 6 of 7 START test unique_stg_events_event_id ................................... [RUN]
[0m05:16:39.785858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_content_content_id.a034585f1a, now test.meta_product_analytics.unique_stg_events_event_id.66ebb17438)
[0m05:16:39.785858 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:16:39.795945 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:16:39.795945 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:16:39.804551 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:16:39.806570 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:16:39.806570 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: BEGIN
[0m05:16:39.806570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:16:39.820577 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m05:16:39.820577 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:16:39.820577 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:16:39.820577 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m05:16:39.835939 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m05:16:39.835939 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_events_event_id.66ebb17438'
[0m05:16:39.835939 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: Close
[0m05:16:39.835939 [info ] [Thread-1 (]: 6 of 7 PASS unique_stg_events_event_id ......................................... [[32mPASS[0m in 0.05s]
[0m05:16:39.835939 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:16:39.846289 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:16:39.846289 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_users_user_id ..................................... [RUN]
[0m05:16:39.846289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_events_event_id.66ebb17438, now test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m05:16:39.849795 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:16:39.851814 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:16:39.859414 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:16:39.861437 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:16:39.863457 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:16:39.863457 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m05:16:39.865475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:16:39.874370 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m05:16:39.874370 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:16:39.881556 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:16:39.881556 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m05:16:39.891058 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m05:16:39.893077 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b'
[0m05:16:39.893077 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m05:16:39.897605 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.05s]
[0m05:16:39.897605 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:16:39.897605 [debug] [MainThread]: Using duckdb connection "master"
[0m05:16:39.897605 [debug] [MainThread]: On master: BEGIN
[0m05:16:39.897605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:16:39.913268 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m05:16:39.913268 [debug] [MainThread]: On master: COMMIT
[0m05:16:39.913268 [debug] [MainThread]: Using duckdb connection "master"
[0m05:16:39.913268 [debug] [MainThread]: On master: COMMIT
[0m05:16:39.913268 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:16:39.913268 [debug] [MainThread]: On master: Close
[0m05:16:39.913268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:16:39.924167 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m05:16:39.924167 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m05:16:39.924167 [info ] [MainThread]: 
[0m05:16:39.924167 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m05:16:39.928962 [debug] [MainThread]: Command end result
[0m05:16:39.976344 [info ] [MainThread]: 
[0m05:16:39.976344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:16:39.976344 [info ] [MainThread]: 
[0m05:16:39.976344 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m05:16:39.976344 [debug] [MainThread]: Command `dbt test` succeeded at 05:16:39.976344 after 1.90 seconds
[0m05:16:39.976344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB879D25A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB88C801A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB88AD9940>]}
[0m05:16:39.976344 [debug] [MainThread]: Flushing usage events
[0m05:17:06.738034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6920DA540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C69497D100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C694C7EF30>]}


============================== 05:17:06.755418 | 139ed3cc-1ff7-410e-9571-04382f50b896 ==============================
[0m05:17:06.755418 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:17:07.980712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --threads 1', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:17:08.346116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '139ed3cc-1ff7-410e-9571-04382f50b896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C695039640>]}
[0m05:17:08.443752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '139ed3cc-1ff7-410e-9571-04382f50b896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C695019820>]}
[0m05:17:08.446673 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:17:08.846044 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m05:17:09.020409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:17:09.020409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:17:09.072433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '139ed3cc-1ff7-410e-9571-04382f50b896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C696250740>]}
[0m05:17:09.237576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '139ed3cc-1ff7-410e-9571-04382f50b896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C696677290>]}
[0m05:17:09.237576 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m05:17:09.237576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '139ed3cc-1ff7-410e-9571-04382f50b896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C69501AF00>]}
[0m05:17:09.242195 [info ] [MainThread]: 
[0m05:17:09.242195 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:17:09.257473 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m05:17:09.361455 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:17:09.361455 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m05:17:09.361455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:17:09.377379 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m05:17:09.377379 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:17:09.377379 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m05:17:09.426840 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m05:17:09.426840 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m05:17:09.426840 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m05:17:09.426840 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m05:17:09.437710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '139ed3cc-1ff7-410e-9571-04382f50b896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6962601A0>]}
[0m05:17:09.438720 [debug] [MainThread]: Using duckdb connection "master"
[0m05:17:09.438720 [debug] [MainThread]: On master: BEGIN
[0m05:17:09.438720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:17:09.448803 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m05:17:09.448803 [debug] [MainThread]: On master: COMMIT
[0m05:17:09.450816 [debug] [MainThread]: Using duckdb connection "master"
[0m05:17:09.450816 [debug] [MainThread]: On master: COMMIT
[0m05:17:09.450816 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:17:09.450816 [debug] [MainThread]: On master: Close
[0m05:17:09.454590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:17:09.454590 [info ] [MainThread]: 
[0m05:17:09.459512 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:17:09.459512 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [RUN]
[0m05:17:09.459512 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c'
[0m05:17:09.459512 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:17:09.486255 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:17:09.486255 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:17:09.504228 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:17:09.504228 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:17:09.504228 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: BEGIN
[0m05:17:09.504228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:17:09.527490 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m05:17:09.527490 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:17:09.527490 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "warehouse"."main"."stg_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'view','like','impression','follow','session_start'
)



      
    ) dbt_internal_test
[0m05:17:09.540039 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m05:17:09.548186 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: ROLLBACK
[0m05:17:09.549708 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c'
[0m05:17:09.549708 [debug] [Thread-1 (]: On test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c: Close
[0m05:17:09.553739 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_events_event_type__view__like__impression__follow__session_start  [[32mPASS[0m in 0.09s]
[0m05:17:09.556788 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:17:09.558858 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:17:09.558858 [info ] [Thread-1 (]: 2 of 7 START test not_null_stg_content_content_id .............................. [RUN]
[0m05:17:09.558858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c, now test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7)
[0m05:17:09.558858 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:17:09.572126 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:17:09.574141 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:17:09.576924 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:17:09.578934 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:17:09.578934 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: BEGIN
[0m05:17:09.578934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:09.591099 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m05:17:09.591099 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:17:09.591099 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select content_id
from "warehouse"."main"."stg_content"
where content_id is null



      
    ) dbt_internal_test
[0m05:17:09.598685 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m05:17:09.603740 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: ROLLBACK
[0m05:17:09.603740 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7'
[0m05:17:09.603740 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7: Close
[0m05:17:09.608899 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stg_content_content_id .................................... [[32mPASS[0m in 0.05s]
[0m05:17:09.608899 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:17:09.611998 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:17:09.611998 [info ] [Thread-1 (]: 3 of 7 START test not_null_stg_events_event_id ................................. [RUN]
[0m05:17:09.611998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7, now test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012)
[0m05:17:09.614013 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:17:09.622133 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:17:09.622133 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:17:09.622133 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:17:09.627879 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:17:09.629899 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m05:17:09.629899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:09.641738 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m05:17:09.641738 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:17:09.643748 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "warehouse"."main"."stg_events"
where event_id is null



      
    ) dbt_internal_test
[0m05:17:09.647773 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m05:17:09.649789 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m05:17:09.649789 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012'
[0m05:17:09.653822 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012: Close
[0m05:17:09.655844 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m05:17:09.661632 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:17:09.665656 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:17:09.666571 [info ] [Thread-1 (]: 4 of 7 START test not_null_stg_users_user_id ................................... [RUN]
[0m05:17:09.668033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012, now test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m05:17:09.670789 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:17:09.675257 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:17:09.677273 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:17:09.681300 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:17:09.683314 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:17:09.683314 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m05:17:09.683314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:09.696202 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m05:17:09.697790 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:17:09.697790 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "warehouse"."main"."stg_users"
where user_id is null



      
    ) dbt_internal_test
[0m05:17:09.703836 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m05:17:09.706865 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m05:17:09.706865 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m05:17:09.708882 [debug] [Thread-1 (]: On test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m05:17:09.712117 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m05:17:09.712117 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:17:09.715062 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:17:09.715062 [info ] [Thread-1 (]: 5 of 7 START test unique_stg_content_content_id ................................ [RUN]
[0m05:17:09.715062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77, now test.meta_product_analytics.unique_stg_content_content_id.a034585f1a)
[0m05:17:09.715062 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:17:09.722427 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:17:09.722427 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:17:09.722427 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:17:09.722427 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:17:09.722427 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: BEGIN
[0m05:17:09.722427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:09.745380 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m05:17:09.745380 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:17:09.747402 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    content_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_content"
where content_id is not null
group by content_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:17:09.756474 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m05:17:09.759066 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: ROLLBACK
[0m05:17:09.759066 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_content_content_id.a034585f1a'
[0m05:17:09.759066 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_content_content_id.a034585f1a: Close
[0m05:17:09.763942 [info ] [Thread-1 (]: 5 of 7 PASS unique_stg_content_content_id ...................................... [[32mPASS[0m in 0.05s]
[0m05:17:09.763942 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:17:09.766734 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:17:09.766734 [info ] [Thread-1 (]: 6 of 7 START test unique_stg_events_event_id ................................... [RUN]
[0m05:17:09.766734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_content_content_id.a034585f1a, now test.meta_product_analytics.unique_stg_events_event_id.66ebb17438)
[0m05:17:09.770279 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:17:09.772299 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:17:09.772299 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:17:09.780048 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:17:09.780048 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:17:09.780048 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: BEGIN
[0m05:17:09.780048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:09.791885 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m05:17:09.791885 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:17:09.791885 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:17:09.803900 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m05:17:09.803900 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m05:17:09.803900 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_events_event_id.66ebb17438'
[0m05:17:09.803900 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_events_event_id.66ebb17438: Close
[0m05:17:09.803900 [info ] [Thread-1 (]: 6 of 7 PASS unique_stg_events_event_id ......................................... [[32mPASS[0m in 0.04s]
[0m05:17:09.803900 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:17:09.803900 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:17:09.803900 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_users_user_id ..................................... [RUN]
[0m05:17:09.803900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_events_event_id.66ebb17438, now test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m05:17:09.803900 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:17:09.824097 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:17:09.824097 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:17:09.824097 [debug] [Thread-1 (]: Writing runtime sql for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:17:09.824097 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:17:09.824097 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m05:17:09.824097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:09.879341 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m05:17:09.936919 [debug] [Thread-1 (]: Using duckdb connection "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:17:09.936919 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "node_id": "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:17:09.959575 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m05:17:09.966573 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m05:17:09.974634 [debug] [Thread-1 (]: Failed to rollback 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b'
[0m05:17:09.975648 [debug] [Thread-1 (]: On test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m05:17:09.977648 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.17s]
[0m05:17:09.980296 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:17:09.983105 [debug] [MainThread]: Using duckdb connection "master"
[0m05:17:09.983105 [debug] [MainThread]: On master: BEGIN
[0m05:17:09.983105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:17:09.991283 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m05:17:09.991283 [debug] [MainThread]: On master: COMMIT
[0m05:17:09.991283 [debug] [MainThread]: Using duckdb connection "master"
[0m05:17:09.991283 [debug] [MainThread]: On master: COMMIT
[0m05:17:09.999553 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:17:09.999553 [debug] [MainThread]: On master: Close
[0m05:17:09.999553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:17:09.999553 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m05:17:09.999553 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m05:17:09.999553 [info ] [MainThread]: 
[0m05:17:09.999553 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m05:17:10.007592 [debug] [MainThread]: Command end result
[0m05:17:10.054297 [info ] [MainThread]: 
[0m05:17:10.054297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:17:10.057824 [info ] [MainThread]: 
[0m05:17:10.057824 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m05:17:10.057824 [debug] [MainThread]: Command `dbt test` succeeded at 05:17:10.057824 after 3.50 seconds
[0m05:17:10.057824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C69448DD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C694F83D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C694F836B0>]}
[0m05:17:10.061387 [debug] [MainThread]: Flushing usage events
[0m05:20:50.371041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F93289E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F9329190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F8B990A0>]}


============================== 05:20:50.377257 | 00ddb0d3-ecfe-4a6f-ac56-d636e589f405 ==============================
[0m05:20:50.377257 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:20:50.379276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:20:50.659579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00ddb0d3-ecfe-4a6f-ac56-d636e589f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F9669580>]}
[0m05:20:50.742156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00ddb0d3-ecfe-4a6f-ac56-d636e589f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F965A2A0>]}
[0m05:20:50.742156 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:20:51.083266 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m05:20:51.230068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:20:51.230068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:20:51.280037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00ddb0d3-ecfe-4a6f-ac56-d636e589f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162FA822960>]}
[0m05:20:51.325871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00ddb0d3-ecfe-4a6f-ac56-d636e589f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162FA822B10>]}
[0m05:20:51.327887 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m05:20:51.327887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00ddb0d3-ecfe-4a6f-ac56-d636e589f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162FA9D97F0>]}
[0m05:20:51.330072 [info ] [MainThread]: 
[0m05:20:51.333584 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:20:51.337161 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m05:20:51.454883 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:20:51.454883 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m05:20:51.454883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:20:51.470108 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m05:20:51.470108 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:20:51.470108 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m05:20:51.507767 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m05:20:51.509785 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m05:20:51.512276 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m05:20:51.512276 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m05:20:51.516493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00ddb0d3-ecfe-4a6f-ac56-d636e589f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162FA9820C0>]}
[0m05:20:51.516493 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:20:51.516493 [info ] [MainThread]: 
[0m05:20:51.527398 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m05:20:51.528169 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m05:20:51.529045 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m05:20:51.529045 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m05:20:51.529045 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m05:20:51.533126 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m05:20:51.529045 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m05:20:51.529045 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m05:20:51.541174 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m05:20:51.541174 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m05:20:51.543185 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m05:20:51.547314 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m05:20:51.547314 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m05:20:51.550116 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m05:20:51.550116 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_users
[0m05:20:51.550116 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m05:20:51.550116 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:20:51.553140 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m05:20:51.553140 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.meta_product_analytics.dim_users'
[0m05:20:51.555076 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m05:20:51.555076 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m05:20:51.555076 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m05:20:51.555076 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_users
[0m05:20:51.555076 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:20:51.555076 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:20:51.560432 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m05:20:51.560432 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.dim_content
[0m05:20:51.560432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m05:20:51.577298 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:20:51.577298 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now model.meta_product_analytics.dim_content)
[0m05:20:51.577298 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:20:51.577298 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_users
[0m05:20:51.582783 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:20:51.582783 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.dim_content
[0m05:20:51.590191 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:20:51.592210 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_users
[0m05:20:51.592210 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:20:51.592210 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m05:20:51.592210 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:20:51.592210 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:20:51.592210 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.dim_users, now test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7)
[0m05:20:51.592210 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:20:51.592210 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77, now test.meta_product_analytics.unique_stg_content_content_id.a034585f1a)
[0m05:20:51.592210 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:20:51.592210 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:20:51.592210 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.dim_content
[0m05:20:51.592210 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:20:51.606216 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.fct_product_events
[0m05:20:51.608953 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:20:51.608953 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.dim_content
[0m05:20:51.615809 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:20:51.615809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b, now model.meta_product_analytics.fct_product_events)
[0m05:20:51.615809 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:20:51.615809 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:20:51.615809 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m05:20:51.615809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.dim_content, now test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c)
[0m05:20:51.620984 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:20:51.622000 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:20:51.624012 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m05:20:51.624012 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:20:51.624012 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:20:51.624012 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:20:51.640189 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:20:51.640189 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7, now test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012)
[0m05:20:51.640189 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:20:51.640189 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m05:20:51.640189 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:20:51.640189 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_content_content_id.a034585f1a, now test.meta_product_analytics.unique_stg_events_event_id.66ebb17438)
[0m05:20:51.640189 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m05:20:51.640189 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:20:51.651330 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:20:51.651330 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:20:51.653927 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:20:51.658700 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:20:51.658700 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m05:20:51.660717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.fct_product_events, now model.meta_product_analytics.agg_product_kpis)
[0m05:20:51.660717 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m05:20:51.660717 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m05:20:51.660717 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:20:51.666907 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:20:51.666907 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:20:51.666907 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m05:20:51.668921 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:20:51.670443 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m05:20:51.670443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:20:51.670443 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m05:20:51.670443 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m05:20:51.670443 [debug] [MainThread]: Connection 'test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c' was properly closed.
[0m05:20:51.670443 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_events_event_id.66ebb17438' was properly closed.
[0m05:20:51.673808 [debug] [MainThread]: Connection 'test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012' was properly closed.
[0m05:20:51.675818 [debug] [MainThread]: Command end result
[0m05:20:52.256564 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m05:20:52.256564 [info ] [MainThread]: Building catalog
[0m05:20:52.273953 [debug] [ThreadPool]: Acquiring new duckdb connection 'warehouse.information_schema'
[0m05:20:52.287859 [debug] [ThreadPool]: Using duckdb connection "warehouse.information_schema"
[0m05:20:52.289878 [debug] [ThreadPool]: On warehouse.information_schema: BEGIN
[0m05:20:52.289878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:20:52.297953 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m05:20:52.297953 [debug] [ThreadPool]: Using duckdb connection "warehouse.information_schema"
[0m05:20:52.297953 [debug] [ThreadPool]: On warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "warehouse.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'warehouse'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'warehouse'
    )
    select
        'warehouse' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m05:20:52.342874 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m05:20:52.366737 [debug] [ThreadPool]: On warehouse.information_schema: ROLLBACK
[0m05:20:52.366737 [debug] [ThreadPool]: Failed to rollback 'warehouse.information_schema'
[0m05:20:52.366737 [debug] [ThreadPool]: On warehouse.information_schema: Close
[0m05:20:52.426093 [info ] [MainThread]: Catalog written to C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\target\catalog.json
[0m05:20:52.428505 [debug] [MainThread]: Command `dbt docs generate` succeeded at 05:20:52.426093 after 2.22 seconds
[0m05:20:52.428505 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m05:20:52.428505 [debug] [MainThread]: Connection 'warehouse.information_schema' was properly closed.
[0m05:20:52.428505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162FA6ED8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F95A35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F95E7C80>]}
[0m05:20:52.430015 [debug] [MainThread]: Flushing usage events
[0m05:21:42.782449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C067A73D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C06713C1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C067D6F7A0>]}


============================== 05:21:42.793939 | f9e5ac14-f342-4914-84ed-ba02f071c577 ==============================
[0m05:21:42.793939 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:21:42.793939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:21:43.076192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9e5ac14-f342-4914-84ed-ba02f071c577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0681030B0>]}
[0m05:21:43.151943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9e5ac14-f342-4914-84ed-ba02f071c577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C068149820>]}
[0m05:26:26.716543 [error] [MainThread]: Encountered an error:

[0m05:26:26.798333 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m05:26:26.800344 [debug] [MainThread]: Command `dbt docs serve` failed at 05:26:26.798333 after 284.19 seconds
[0m05:26:26.800344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C067A73D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C068102360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C067D6CD10>]}
[0m05:26:26.800344 [debug] [MainThread]: Flushing usage events
[0m05:33:27.857433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A6306090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A633E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A633D0A0>]}


============================== 05:33:27.857433 | 963aa755-85c8-441f-8c17-2b59fd11d1b2 ==============================
[0m05:33:27.857433 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:33:27.857433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:33:28.138814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '963aa755-85c8-441f-8c17-2b59fd11d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A668DA60>]}
[0m05:33:28.202365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '963aa755-85c8-441f-8c17-2b59fd11d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A5F9C800>]}
[0m05:33:28.206393 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m05:33:28.516624 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m05:33:28.668017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:33:28.670026 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:33:28.709329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '963aa755-85c8-441f-8c17-2b59fd11d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A7834BC0>]}
[0m05:33:28.758985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '963aa755-85c8-441f-8c17-2b59fd11d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A7BC6840>]}
[0m05:33:28.758985 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m05:33:28.758985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '963aa755-85c8-441f-8c17-2b59fd11d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A7A7BEF0>]}
[0m05:33:28.762499 [info ] [MainThread]: 
[0m05:33:28.762499 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:33:28.775040 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m05:33:28.882560 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:33:28.882560 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m05:33:28.882560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:33:28.882560 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m05:33:28.882560 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m05:33:28.882560 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m05:33:28.932371 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m05:33:28.934385 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m05:33:28.936397 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m05:33:28.936397 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m05:33:28.938421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '963aa755-85c8-441f-8c17-2b59fd11d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A7AC20C0>]}
[0m05:33:28.938421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:33:28.938421 [info ] [MainThread]: 
[0m05:33:28.946059 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m05:33:28.946059 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m05:33:28.954488 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m05:33:28.954488 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m05:33:28.946059 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m05:33:28.961262 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m05:33:28.946059 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m05:33:28.961262 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m05:33:28.961262 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m05:33:28.961262 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m05:33:28.961262 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m05:33:28.961262 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m05:33:28.971492 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m05:33:28.971492 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m05:33:28.974378 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.fct_product_events
[0m05:33:28.976396 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.meta_product_analytics.fct_product_events'
[0m05:33:28.976396 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m05:33:28.974378 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:33:28.974378 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m05:33:28.974378 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m05:33:28.978415 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m05:33:28.978415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c)
[0m05:33:28.978415 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m05:33:28.978415 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m05:33:28.978415 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:33:28.978415 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:33:28.978415 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:33:28.978415 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m05:33:29.004394 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m05:33:29.004394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012)
[0m05:33:29.004394 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now test.meta_product_analytics.unique_stg_events_event_id.66ebb17438)
[0m05:33:29.004394 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m05:33:29.004394 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:33:29.008206 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:33:29.009222 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_content
[0m05:33:29.009734 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:33:29.010640 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m05:33:29.023903 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.fct_product_events, now model.meta_product_analytics.dim_content)
[0m05:33:29.026568 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m05:33:29.028578 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m05:33:29.028578 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_content
[0m05:33:29.030543 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:33:29.033029 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m05:33:29.033029 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c, now test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7)
[0m05:33:29.035046 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:33:29.035046 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:33:29.035046 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m05:33:29.035046 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_content
[0m05:33:29.035046 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:33:29.040537 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m05:33:29.040537 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:33:29.040537 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_content
[0m05:33:29.040537 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m05:33:29.040537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012, now test.meta_product_analytics.unique_stg_content_content_id.a034585f1a)
[0m05:33:29.040537 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_users
[0m05:33:29.040537 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:33:29.040537 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:33:29.040537 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:33:29.040537 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.dim_content, now model.meta_product_analytics.dim_users)
[0m05:33:29.040537 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_events_event_id.66ebb17438, now test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m05:33:29.040537 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m05:33:29.056579 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m05:33:29.056579 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_users
[0m05:33:29.056579 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:33:29.056579 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:33:29.056579 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m05:33:29.056579 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m05:33:29.056579 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7, now test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m05:33:29.056579 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:33:29.056579 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:33:29.071699 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:33:29.073148 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m05:33:29.073148 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m05:33:29.073148 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_users
[0m05:33:29.073148 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m05:33:29.073148 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_users
[0m05:33:29.073148 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m05:33:29.073148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_content_content_id.a034585f1a, now model.meta_product_analytics.agg_product_kpis)
[0m05:33:29.073148 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m05:33:29.083103 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m05:33:29.083103 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:33:29.087648 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m05:33:29.087648 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m05:33:29.087648 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m05:33:29.087648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:33:29.087648 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m05:33:29.087648 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m05:33:29.087648 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m05:33:29.087648 [debug] [MainThread]: Connection 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m05:33:29.093332 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_users' was properly closed.
[0m05:33:29.095344 [debug] [MainThread]: Command end result
[0m05:33:29.188641 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m05:33:29.190654 [info ] [MainThread]: Building catalog
[0m05:33:29.202619 [debug] [ThreadPool]: Acquiring new duckdb connection 'warehouse.information_schema'
[0m05:33:29.211471 [debug] [ThreadPool]: Using duckdb connection "warehouse.information_schema"
[0m05:33:29.213482 [debug] [ThreadPool]: On warehouse.information_schema: BEGIN
[0m05:33:29.213482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:33:29.225702 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m05:33:29.225702 [debug] [ThreadPool]: Using duckdb connection "warehouse.information_schema"
[0m05:33:29.227715 [debug] [ThreadPool]: On warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "warehouse.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'warehouse'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'warehouse'
    )
    select
        'warehouse' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m05:33:29.270185 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m05:33:29.277175 [debug] [ThreadPool]: On warehouse.information_schema: ROLLBACK
[0m05:33:29.297151 [debug] [ThreadPool]: Failed to rollback 'warehouse.information_schema'
[0m05:33:29.297151 [debug] [ThreadPool]: On warehouse.information_schema: Close
[0m05:33:29.350805 [info ] [MainThread]: Catalog written to C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\target\catalog.json
[0m05:33:29.354419 [debug] [MainThread]: Command `dbt docs generate` succeeded at 05:33:29.354419 after 1.67 seconds
[0m05:33:29.354419 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m05:33:29.354419 [debug] [MainThread]: Connection 'warehouse.information_schema' was properly closed.
[0m05:33:29.356435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A6306090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A6635280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A57488C0>]}
[0m05:33:29.356435 [debug] [MainThread]: Flushing usage events
[0m05:33:35.957137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A941B300E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9421FCB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A941BFB380>]}


============================== 05:33:35.970280 | 6946917a-611c-45be-a68e-eb02c3be6b63 ==============================
[0m05:33:35.970280 [info ] [MainThread]: Running with dbt=1.8.6
[0m05:33:35.970280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:33:36.248679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6946917a-611c-45be-a68e-eb02c3be6b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A942702DE0>]}
[0m05:33:36.309991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6946917a-611c-45be-a68e-eb02c3be6b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A93FDE8320>]}
[0m05:41:49.448815 [error] [MainThread]: Encountered an error:

[0m05:41:49.456330 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m05:41:49.463099 [debug] [MainThread]: Command `dbt docs serve` failed at 05:41:49.463099 after 493.66 seconds
[0m05:41:49.463099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A941A62F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94385B830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9439D7A10>]}
[0m05:41:49.464836 [debug] [MainThread]: Flushing usage events
[0m06:00:45.957593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA084ABB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA083EEBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA083EF800>]}


============================== 06:00:45.957593 | f3d23dfd-cc31-46b1-8b1b-bf2d5dd900fc ==============================
[0m06:00:45.957593 [info ] [MainThread]: Running with dbt=1.8.6
[0m06:00:45.957593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:00:46.274669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3d23dfd-cc31-46b1-8b1b-bf2d5dd900fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA0882CC80>]}
[0m06:00:46.337604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3d23dfd-cc31-46b1-8b1b-bf2d5dd900fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA08535790>]}
[0m06:00:46.337604 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m06:00:46.652901 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m06:00:46.810516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:46.810516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:46.858017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3d23dfd-cc31-46b1-8b1b-bf2d5dd900fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA05FF94C0>]}
[0m06:00:46.905855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3d23dfd-cc31-46b1-8b1b-bf2d5dd900fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA09D7DCA0>]}
[0m06:00:46.905855 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m06:00:46.921618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d23dfd-cc31-46b1-8b1b-bf2d5dd900fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA09BFDF40>]}
[0m06:00:46.921618 [info ] [MainThread]: 
[0m06:00:46.921618 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:00:46.937344 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m06:00:47.058830 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m06:00:47.058830 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m06:00:47.058830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:47.075902 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m06:00:47.075902 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m06:00:47.075902 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m06:00:47.112586 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m06:00:47.128500 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m06:00:47.128500 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m06:00:47.128500 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m06:00:47.128500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d23dfd-cc31-46b1-8b1b-bf2d5dd900fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA09D46BD0>]}
[0m06:00:47.128500 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:00:47.128500 [info ] [MainThread]: 
[0m06:00:47.144374 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m06:00:47.144374 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m06:00:47.144374 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m06:00:47.144374 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m06:00:47.144374 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m06:00:47.144374 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m06:00:47.144374 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m06:00:47.144374 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m06:00:47.160300 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m06:00:47.160300 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m06:00:47.160300 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m06:00:47.160300 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m06:00:47.176010 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m06:00:47.176010 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m06:00:47.176010 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m06:00:47.176010 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_content
[0m06:00:47.176010 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m06:00:47.176010 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:00:47.176010 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now test.meta_product_analytics.unique_stg_content_content_id.a034585f1a)
[0m06:00:47.176010 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:00:47.176010 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m06:00:47.176010 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.meta_product_analytics.dim_content'
[0m06:00:47.176010 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:00:47.176010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7)
[0m06:00:47.176010 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m06:00:47.176010 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_content
[0m06:00:47.191852 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:00:47.191852 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m06:00:47.191852 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.fct_product_events
[0m06:00:47.205270 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m06:00:47.207852 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m06:00:47.207852 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now model.meta_product_analytics.fct_product_events)
[0m06:00:47.207852 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m06:00:47.207852 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m06:00:47.207852 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:00:47.223806 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:00:47.223806 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:00:47.223806 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_content_content_id.a034585f1a, now test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c)
[0m06:00:47.223806 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:00:47.223806 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m06:00:47.223806 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m06:00:47.223806 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:00:47.223806 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_content
[0m06:00:47.239512 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m06:00:47.239512 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:00:47.239512 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_content
[0m06:00:47.239512 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_users
[0m06:00:47.239512 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.dim_content, now model.meta_product_analytics.dim_users)
[0m06:00:47.239512 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_users
[0m06:00:47.239512 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:00:47.239512 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:00:47.239512 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:00:47.239512 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m06:00:47.239512 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.fct_product_events, now test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012)
[0m06:00:47.239512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7, now test.meta_product_analytics.unique_stg_events_event_id.66ebb17438)
[0m06:00:47.239512 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:00:47.239512 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:00:47.239512 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:00:47.239512 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_users
[0m06:00:47.239512 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:00:47.255601 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m06:00:47.255601 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m06:00:47.255601 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_users
[0m06:00:47.255601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c, now test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m06:00:47.255601 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:00:47.255601 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:00:47.255601 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:00:47.255601 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:00:47.255601 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.dim_users, now test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m06:00:47.271292 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m06:00:47.271292 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:00:47.271292 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:00:47.271292 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:00:47.271292 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m06:00:47.271292 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m06:00:47.271292 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012, now model.meta_product_analytics.agg_product_kpis)
[0m06:00:47.271292 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:00:47.271292 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:00:47.271292 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m06:00:47.271292 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:00:47.287389 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:00:47.287389 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m06:00:47.287389 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m06:00:47.287389 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m06:00:47.287389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:00:47.287389 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m06:00:47.287389 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_events_event_id.66ebb17438' was properly closed.
[0m06:00:47.287389 [debug] [MainThread]: Connection 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m06:00:47.287389 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m06:00:47.287389 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m06:00:47.287389 [debug] [MainThread]: Command end result
[0m06:00:47.382593 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m06:00:47.382593 [info ] [MainThread]: Building catalog
[0m06:00:47.398304 [debug] [ThreadPool]: Acquiring new duckdb connection 'warehouse.information_schema'
[0m06:00:47.405711 [debug] [ThreadPool]: Using duckdb connection "warehouse.information_schema"
[0m06:00:47.405711 [debug] [ThreadPool]: On warehouse.information_schema: BEGIN
[0m06:00:47.405711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:47.414289 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m06:00:47.414289 [debug] [ThreadPool]: Using duckdb connection "warehouse.information_schema"
[0m06:00:47.414289 [debug] [ThreadPool]: On warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "warehouse.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'warehouse'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'warehouse'
    )
    select
        'warehouse' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m06:00:47.461543 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m06:00:47.477303 [debug] [ThreadPool]: On warehouse.information_schema: ROLLBACK
[0m06:00:47.477303 [debug] [ThreadPool]: Failed to rollback 'warehouse.information_schema'
[0m06:00:47.477303 [debug] [ThreadPool]: On warehouse.information_schema: Close
[0m06:00:47.540208 [info ] [MainThread]: Catalog written to C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\target\catalog.json
[0m06:00:47.540208 [debug] [MainThread]: Command `dbt docs generate` succeeded at 06:00:47.540208 after 1.75 seconds
[0m06:00:47.540208 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m06:00:47.540208 [debug] [MainThread]: Connection 'warehouse.information_schema' was properly closed.
[0m06:00:47.540208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA017B5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA0848A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA08488FB0>]}
[0m06:00:47.540208 [debug] [MainThread]: Flushing usage events
[0m06:01:04.519069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D730F96F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7333A5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7333A4170>]}


============================== 06:01:04.519069 | 8d59f447-0370-4fb6-a216-d661fd1cffbc ==============================
[0m06:01:04.519069 [info ] [MainThread]: Running with dbt=1.8.6
[0m06:01:04.519069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:01:04.784496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d59f447-0370-4fb6-a216-d661fd1cffbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D733F09EE0>]}
[0m06:01:04.849285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d59f447-0370-4fb6-a216-d661fd1cffbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D734FA4CB0>]}
[0m06:02:49.107143 [error] [MainThread]: Encountered an error:

[0m06:02:49.196666 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\.venv312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 766, in __init__
    self.handle()
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khema\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m06:02:49.201140 [debug] [MainThread]: Command `dbt docs serve` failed at 06:02:49.201140 after 104.84 seconds
[0m06:02:49.201140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D733B6C800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D733F15760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D732F2A990>]}
[0m06:02:49.201140 [debug] [MainThread]: Flushing usage events
[0m06:02:56.985512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C4ECBD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263BE295040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C463CE00>]}


============================== 06:02:56.997750 | 17a9a92e-6d12-4799-a03d-180ab92cf3e7 ==============================
[0m06:02:56.997750 [info ] [MainThread]: Running with dbt=1.8.6
[0m06:02:56.997750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:57.388346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17a9a92e-6d12-4799-a03d-180ab92cf3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C4073B60>]}
[0m06:02:57.505004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17a9a92e-6d12-4799-a03d-180ab92cf3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C632F2F0>]}
[0m06:02:57.509485 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m06:02:57.966072 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m06:02:58.164706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:02:58.164706 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:02:58.227373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17a9a92e-6d12-4799-a03d-180ab92cf3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C65CC0E0>]}
[0m06:02:58.296038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17a9a92e-6d12-4799-a03d-180ab92cf3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C665D3A0>]}
[0m06:02:58.296038 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m06:02:58.296038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17a9a92e-6d12-4799-a03d-180ab92cf3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C474C440>]}
[0m06:02:58.303833 [info ] [MainThread]: 
[0m06:02:58.306461 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:58.317623 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m06:02:58.436036 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m06:02:58.436036 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m06:02:58.436036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:58.467833 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m06:02:58.467833 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m06:02:58.467833 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m06:02:58.517853 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m06:02:58.521904 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m06:02:58.523936 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m06:02:58.525963 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m06:02:58.532485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17a9a92e-6d12-4799-a03d-180ab92cf3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C62D1610>]}
[0m06:02:58.532485 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:02:58.535571 [info ] [MainThread]: 
[0m06:02:58.544506 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m06:02:58.544506 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m06:02:58.548266 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m06:02:58.548266 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m06:02:58.548266 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m06:02:58.548266 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m06:02:58.548266 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m06:02:58.548266 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m06:02:58.560548 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m06:02:58.566111 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m06:02:58.566111 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m06:02:58.570603 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m06:02:58.570603 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m06:02:58.574172 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m06:02:58.576193 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m06:02:58.578208 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m06:02:58.576193 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m06:02:58.581461 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m06:02:58.581461 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_content
[0m06:02:58.583850 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.meta_product_analytics.dim_content'
[0m06:02:58.583850 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_content
[0m06:02:58.583850 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m06:02:58.583850 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.fct_product_events
[0m06:02:58.583850 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:02:58.583850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now model.meta_product_analytics.fct_product_events)
[0m06:02:58.583850 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:02:58.583850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c)
[0m06:02:58.583850 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m06:02:58.583850 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7)
[0m06:02:58.583850 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:02:58.583850 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_content
[0m06:02:58.598962 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m06:02:58.598962 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:02:58.611678 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m06:02:58.611678 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_content
[0m06:02:58.627631 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m06:02:58.638023 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m06:02:58.639272 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:02:58.639272 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m06:02:58.639272 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:02:58.642685 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.dim_content, now test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012)
[0m06:02:58.642685 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:02:58.644448 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:02:58.646145 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:02:58.646145 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:02:58.646145 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.fct_product_events, now test.meta_product_analytics.unique_stg_content_content_id.a034585f1a)
[0m06:02:58.648904 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:02:58.650673 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:02:58.652525 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m06:02:58.652525 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:02:58.652525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c, now test.meta_product_analytics.unique_stg_events_event_id.66ebb17438)
[0m06:02:58.652525 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.dim_users
[0m06:02:58.675826 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m06:02:58.676698 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:02:58.676698 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:02:58.676698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7, now model.meta_product_analytics.dim_users)
[0m06:02:58.676698 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:02:58.683413 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m06:02:58.683413 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.dim_users
[0m06:02:58.683413 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:02:58.683413 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:02:58.695444 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:02:58.697463 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m06:02:58.697463 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:02:58.699478 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:02:58.692225 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012, now test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m06:02:58.700340 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:02:58.700340 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:02:58.701352 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_content_content_id.a034585f1a, now test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m06:02:58.706776 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m06:02:58.707787 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:02:58.707787 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.dim_users
[0m06:02:58.713997 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m06:02:58.713997 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.dim_users
[0m06:02:58.716064 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:02:58.716064 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:02:58.716064 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m06:02:58.716064 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:02:58.716064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_events_event_id.66ebb17438, now model.meta_product_analytics.agg_product_kpis)
[0m06:02:58.716064 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:02:58.721631 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m06:02:58.726700 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m06:02:58.726700 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m06:02:58.729461 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m06:02:58.731981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:58.731981 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m06:02:58.731981 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m06:02:58.731981 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m06:02:58.731981 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_users' was properly closed.
[0m06:02:58.731981 [debug] [MainThread]: Connection 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m06:02:58.731981 [debug] [MainThread]: Command end result
[0m06:02:58.856361 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m06:02:58.856361 [info ] [MainThread]: Building catalog
[0m06:02:58.872687 [debug] [ThreadPool]: Acquiring new duckdb connection 'warehouse.information_schema'
[0m06:02:58.885310 [debug] [ThreadPool]: Using duckdb connection "warehouse.information_schema"
[0m06:02:58.885310 [debug] [ThreadPool]: On warehouse.information_schema: BEGIN
[0m06:02:58.885310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:58.899019 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m06:02:58.899019 [debug] [ThreadPool]: Using duckdb connection "warehouse.information_schema"
[0m06:02:58.899019 [debug] [ThreadPool]: On warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "warehouse.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'warehouse'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'warehouse'
    )
    select
        'warehouse' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m06:02:58.953545 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m06:02:58.981005 [debug] [ThreadPool]: On warehouse.information_schema: ROLLBACK
[0m06:02:58.983016 [debug] [ThreadPool]: Failed to rollback 'warehouse.information_schema'
[0m06:02:58.983016 [debug] [ThreadPool]: On warehouse.information_schema: Close
[0m06:02:59.052208 [info ] [MainThread]: Catalog written to C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\target\catalog.json
[0m06:02:59.054606 [debug] [MainThread]: Command `dbt docs generate` succeeded at 06:02:59.054606 after 2.33 seconds
[0m06:02:59.054606 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m06:02:59.054606 [debug] [MainThread]: Connection 'warehouse.information_schema' was properly closed.
[0m06:02:59.054606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263BE295040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C3F37AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C51F1400>]}
[0m06:02:59.054606 [debug] [MainThread]: Flushing usage events
[0m06:06:33.900789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F44A90A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F4C61490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F3D6B200>]}


============================== 06:06:33.911201 | 3d451d68-fde9-42c2-85a8-d6fdb3db4cfb ==============================
[0m06:06:33.911201 [info ] [MainThread]: Running with dbt=1.8.6
[0m06:06:33.911201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\khema\\Downloads\\meta_product_analytics_de_project\\meta_product_analytics_de_project\\dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:06:34.179295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d451d68-fde9-42c2-85a8-d6fdb3db4cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F405B8C0>]}
[0m06:06:34.234698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d451d68-fde9-42c2-85a8-d6fdb3db4cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F3CCD4C0>]}
[0m06:06:34.252760 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m06:06:34.568590 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m06:06:34.733487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:06:34.733487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:06:34.784696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d451d68-fde9-42c2-85a8-d6fdb3db4cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F6157DD0>]}
[0m06:06:34.821907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d451d68-fde9-42c2-85a8-d6fdb3db4cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F6560F50>]}
[0m06:06:34.821907 [info ] [MainThread]: Found 7 models, 7 data tests, 421 macros
[0m06:06:34.821907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d451d68-fde9-42c2-85a8-d6fdb3db4cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F61E89B0>]}
[0m06:06:34.831660 [info ] [MainThread]: 
[0m06:06:34.831660 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:06:34.841898 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m06:06:34.933030 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m06:06:34.933030 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m06:06:34.933030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:06:34.959297 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m06:06:34.959297 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m06:06:34.959297 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m06:06:34.996522 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m06:06:34.997186 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m06:06:34.997186 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m06:06:34.997186 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m06:06:34.997186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d451d68-fde9-42c2-85a8-d6fdb3db4cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F6223080>]}
[0m06:06:34.997186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:06:34.997186 [info ] [MainThread]: 
[0m06:06:35.012587 [debug] [Thread-1 (]: Began running node model.meta_product_analytics.stg_content
[0m06:06:35.012587 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.stg_events
[0m06:06:35.012587 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_content'
[0m06:06:35.012587 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.stg_users
[0m06:06:35.012587 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_events'
[0m06:06:35.012587 [debug] [Thread-1 (]: Began compiling node model.meta_product_analytics.stg_content
[0m06:06:35.012587 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.meta_product_analytics.stg_users'
[0m06:06:35.012587 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.stg_events
[0m06:06:35.023893 [debug] [Thread-1 (]: Writing injected SQL for node "model.meta_product_analytics.stg_content"
[0m06:06:35.028610 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.stg_users
[0m06:06:35.030622 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.stg_events"
[0m06:06:35.030622 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.stg_users"
[0m06:06:35.034071 [debug] [Thread-1 (]: Began executing node model.meta_product_analytics.stg_content
[0m06:06:35.034071 [debug] [Thread-1 (]: Finished running node model.meta_product_analytics.stg_content
[0m06:06:35.036625 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.stg_events
[0m06:06:35.037399 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.stg_users
[0m06:06:35.039414 [debug] [Thread-4 (]: Began running node model.meta_product_analytics.dim_content
[0m06:06:35.040465 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.stg_events
[0m06:06:35.040465 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:06:35.042480 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.stg_users
[0m06:06:35.042480 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.meta_product_analytics.dim_content'
[0m06:06:35.043511 [debug] [Thread-2 (]: Began running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:06:35.045316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_content, now test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7)
[0m06:06:35.045316 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.fct_product_events
[0m06:06:35.045316 [debug] [Thread-4 (]: Began compiling node model.meta_product_analytics.dim_content
[0m06:06:35.045316 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_events, now test.meta_product_analytics.unique_stg_content_content_id.a034585f1a)
[0m06:06:35.045316 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:06:35.045316 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.stg_users, now model.meta_product_analytics.fct_product_events)
[0m06:06:35.045316 [debug] [Thread-4 (]: Writing injected SQL for node "model.meta_product_analytics.dim_content"
[0m06:06:35.045316 [debug] [Thread-2 (]: Began compiling node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:06:35.060370 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7"
[0m06:06:35.060370 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.fct_product_events
[0m06:06:35.076880 [debug] [Thread-2 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_content_content_id.a034585f1a"
[0m06:06:35.076880 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.fct_product_events"
[0m06:06:35.076880 [debug] [Thread-4 (]: Began executing node model.meta_product_analytics.dim_content
[0m06:06:35.076880 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:06:35.083930 [debug] [Thread-4 (]: Finished running node model.meta_product_analytics.dim_content
[0m06:06:35.083930 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7
[0m06:06:35.083930 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:06:35.083930 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.fct_product_events
[0m06:06:35.083930 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:06:35.083930 [debug] [Thread-2 (]: Began executing node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:06:35.083930 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.dim_content, now test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c)
[0m06:06:35.083930 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.fct_product_events
[0m06:06:35.083930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_content_content_id.8fd51f55b7, now test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012)
[0m06:06:35.083930 [debug] [Thread-2 (]: Finished running node test.meta_product_analytics.unique_stg_content_content_id.a034585f1a
[0m06:06:35.083930 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:06:35.091810 [debug] [Thread-3 (]: Began running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:06:35.091810 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:06:35.091810 [debug] [Thread-2 (]: Began running node model.meta_product_analytics.dim_users
[0m06:06:35.091810 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c"
[0m06:06:35.091810 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.meta_product_analytics.fct_product_events, now test.meta_product_analytics.unique_stg_events_event_id.66ebb17438)
[0m06:06:35.109826 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012"
[0m06:06:35.111839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_content_content_id.a034585f1a, now model.meta_product_analytics.dim_users)
[0m06:06:35.111839 [debug] [Thread-3 (]: Began compiling node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:06:35.111839 [debug] [Thread-2 (]: Began compiling node model.meta_product_analytics.dim_users
[0m06:06:35.115443 [debug] [Thread-3 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_events_event_id.66ebb17438"
[0m06:06:35.115443 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:06:35.122997 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:06:35.124070 [debug] [Thread-2 (]: Writing injected SQL for node "model.meta_product_analytics.dim_users"
[0m06:06:35.124070 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c
[0m06:06:35.126084 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012
[0m06:06:35.126084 [debug] [Thread-3 (]: Began executing node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:06:35.126084 [debug] [Thread-4 (]: Began running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:06:35.126084 [debug] [Thread-1 (]: Began running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:06:35.126084 [debug] [Thread-3 (]: Finished running node test.meta_product_analytics.unique_stg_events_event_id.66ebb17438
[0m06:06:35.126084 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.accepted_values_stg_events_event_type__view__like__impression__follow__session_start.16fff0a18c, now test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m06:06:35.126084 [debug] [Thread-2 (]: Began executing node model.meta_product_analytics.dim_users
[0m06:06:35.126084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.not_null_stg_events_event_id.715b3f7012, now test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m06:06:35.126084 [debug] [Thread-4 (]: Began compiling node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:06:35.126084 [debug] [Thread-2 (]: Finished running node model.meta_product_analytics.dim_users
[0m06:06:35.126084 [debug] [Thread-1 (]: Began compiling node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:06:35.126084 [debug] [Thread-4 (]: Writing injected SQL for node "test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m06:06:35.138990 [debug] [Thread-1 (]: Writing injected SQL for node "test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m06:06:35.138990 [debug] [Thread-3 (]: Began running node model.meta_product_analytics.agg_product_kpis
[0m06:06:35.138990 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.meta_product_analytics.unique_stg_events_event_id.66ebb17438, now model.meta_product_analytics.agg_product_kpis)
[0m06:06:35.138990 [debug] [Thread-3 (]: Began compiling node model.meta_product_analytics.agg_product_kpis
[0m06:06:35.148077 [debug] [Thread-3 (]: Writing injected SQL for node "model.meta_product_analytics.agg_product_kpis"
[0m06:06:35.148077 [debug] [Thread-1 (]: Began executing node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:06:35.150097 [debug] [Thread-1 (]: Finished running node test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b
[0m06:06:35.150609 [debug] [Thread-4 (]: Began executing node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:06:35.151756 [debug] [Thread-4 (]: Finished running node test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77
[0m06:06:35.151756 [debug] [Thread-3 (]: Began executing node model.meta_product_analytics.agg_product_kpis
[0m06:06:35.151756 [debug] [Thread-3 (]: Finished running node model.meta_product_analytics.agg_product_kpis
[0m06:06:35.154811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:06:35.154811 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m06:06:35.154811 [debug] [MainThread]: Connection 'test.meta_product_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m06:06:35.154811 [debug] [MainThread]: Connection 'model.meta_product_analytics.dim_users' was properly closed.
[0m06:06:35.154811 [debug] [MainThread]: Connection 'model.meta_product_analytics.agg_product_kpis' was properly closed.
[0m06:06:35.154811 [debug] [MainThread]: Connection 'test.meta_product_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m06:06:35.158840 [debug] [MainThread]: Command end result
[0m06:06:35.250309 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m06:06:35.257678 [info ] [MainThread]: Building catalog
[0m06:06:35.269753 [debug] [ThreadPool]: Acquiring new duckdb connection 'warehouse.information_schema'
[0m06:06:35.281285 [debug] [ThreadPool]: Using duckdb connection "warehouse.information_schema"
[0m06:06:35.281285 [debug] [ThreadPool]: On warehouse.information_schema: BEGIN
[0m06:06:35.281285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:06:35.289953 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m06:06:35.289953 [debug] [ThreadPool]: Using duckdb connection "warehouse.information_schema"
[0m06:06:35.295115 [debug] [ThreadPool]: On warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "meta_product_analytics", "target_name": "dev", "connection_name": "warehouse.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'warehouse'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'warehouse'
    )
    select
        'warehouse' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m06:06:35.350885 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m06:06:35.360539 [debug] [ThreadPool]: On warehouse.information_schema: ROLLBACK
[0m06:06:35.360539 [debug] [ThreadPool]: Failed to rollback 'warehouse.information_schema'
[0m06:06:35.360539 [debug] [ThreadPool]: On warehouse.information_schema: Close
[0m06:06:35.425123 [info ] [MainThread]: Catalog written to C:\Users\khema\Downloads\meta_product_analytics_de_project\meta_product_analytics_de_project\dbt_project\target\catalog.json
[0m06:06:35.429450 [debug] [MainThread]: Command `dbt docs generate` succeeded at 06:06:35.429450 after 1.74 seconds
[0m06:06:35.429450 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m06:06:35.429450 [debug] [MainThread]: Connection 'warehouse.information_schema' was properly closed.
[0m06:06:35.429450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F4B0C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F4B0DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154F4A30D70>]}
[0m06:06:35.429450 [debug] [MainThread]: Flushing usage events
